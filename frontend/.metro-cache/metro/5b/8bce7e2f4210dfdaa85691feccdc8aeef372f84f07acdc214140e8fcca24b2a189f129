{"dependencies":[{"name":"../debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"rfhktnzi6PvZxT1xtyHWbBktN/w=","exportNames":["*"],"imports":1}},{"name":"../instrument/globalError.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":49},"end":{"line":2,"column":84,"index":133}}],"key":"Of7obnMAGuTIziq8a+eb2odU8/I=","exportNames":["*"],"imports":1}},{"name":"../instrument/globalUnhandledRejection.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":134},"end":{"line":3,"column":110,"index":244}}],"key":"S74zg5U0CWy4EgfPKDXHZykNZE4=","exportNames":["*"],"imports":1}},{"name":"../utils/debug-logger.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":245},"end":{"line":4,"column":49,"index":294}}],"key":"bptn1GZFOkS4BOMU8jhPqqHmvAc=","exportNames":["*"],"imports":1}},{"name":"../utils/spanUtils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":295},"end":{"line":5,"column":67,"index":362}}],"key":"UzLeGx1bDOwqjtebNy27AzwV/PI=","exportNames":["*"],"imports":1}},{"name":"./spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":363},"end":{"line":6,"column":52,"index":415}}],"key":"Y3Jz0fXFV1VA2c+eEGi4NJg5MfQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"registerSpanErrorInstrumentation\", {\n    enumerable: true,\n    get: function () {\n      return registerSpanErrorInstrumentation;\n    }\n  });\n  var _debugBuildJs = require(_dependencyMap[0], \"../debug-build.js\");\n  var _instrumentGlobalErrorJs = require(_dependencyMap[1], \"../instrument/globalError.js\");\n  var _instrumentGlobalUnhandledRejectionJs = require(_dependencyMap[2], \"../instrument/globalUnhandledRejection.js\");\n  var _utilsDebugLoggerJs = require(_dependencyMap[3], \"../utils/debug-logger.js\");\n  var _utilsSpanUtilsJs = require(_dependencyMap[4], \"../utils/spanUtils.js\");\n  var _spanstatusJs = require(_dependencyMap[5], \"./spanstatus.js\");\n  let errorsInstrumented = false;\n\n  /**\n   * Ensure that global errors automatically set the active span status.\n   */\n  function registerSpanErrorInstrumentation() {\n    if (errorsInstrumented) {\n      return;\n    }\n\n    /**\n     * If an error or unhandled promise occurs, we mark the active root span as failed\n     */\n    function errorCallback() {\n      const activeSpan = (0, _utilsSpanUtilsJs.getActiveSpan)();\n      const rootSpan = activeSpan && (0, _utilsSpanUtilsJs.getRootSpan)(activeSpan);\n      if (rootSpan) {\n        const message = 'internal_error';\n        _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.log(`[Tracing] Root span: ${message} -> Global error occurred`);\n        rootSpan.setStatus({\n          code: _spanstatusJs.SPAN_STATUS_ERROR,\n          message\n        });\n      }\n    }\n\n    // The function name will be lost when bundling but we need to be able to identify this listener later to maintain the\n    // node.js default exit behaviour\n    errorCallback.tag = 'sentry_tracingErrorCallback';\n    errorsInstrumented = true;\n    (0, _instrumentGlobalErrorJs.addGlobalErrorInstrumentationHandler)(errorCallback);\n    (0, _instrumentGlobalUnhandledRejectionJs.addGlobalUnhandledRejectionInstrumentationHandler)(errorCallback);\n  }\n});","lineCount":52,"map":[[7,2,40,0,"Object"],[7,8,40,0],[7,9,40,0,"defineProperty"],[7,23,40,0],[7,24,40,0,"exports"],[7,31,40,0],[8,4,40,0,"enumerable"],[8,14,40,0],[9,4,40,0,"get"],[9,7,40,0],[9,18,40,0,"get"],[9,19,40,0],[10,6,40,0],[10,13,40,9,"registerSpanErrorInstrumentation"],[10,45,40,41],[11,4,40,41],[12,2,40,41],[13,2,1,0],[13,6,1,0,"_debugBuildJs"],[13,19,1,0],[13,22,1,0,"require"],[13,29,1,0],[13,30,1,0,"_dependencyMap"],[13,44,1,0],[14,2,2,0],[14,6,2,0,"_instrumentGlobalErrorJs"],[14,30,2,0],[14,33,2,0,"require"],[14,40,2,0],[14,41,2,0,"_dependencyMap"],[14,55,2,0],[15,2,3,0],[15,6,3,0,"_instrumentGlobalUnhandledRejectionJs"],[15,43,3,0],[15,46,3,0,"require"],[15,53,3,0],[15,54,3,0,"_dependencyMap"],[15,68,3,0],[16,2,4,0],[16,6,4,0,"_utilsDebugLoggerJs"],[16,25,4,0],[16,28,4,0,"require"],[16,35,4,0],[16,36,4,0,"_dependencyMap"],[16,50,4,0],[17,2,5,0],[17,6,5,0,"_utilsSpanUtilsJs"],[17,23,5,0],[17,26,5,0,"require"],[17,33,5,0],[17,34,5,0,"_dependencyMap"],[17,48,5,0],[18,2,6,0],[18,6,6,0,"_spanstatusJs"],[18,19,6,0],[18,22,6,0,"require"],[18,29,6,0],[18,30,6,0,"_dependencyMap"],[18,44,6,0],[19,2,8,0],[19,6,8,4,"errorsInstrumented"],[19,24,8,22],[19,27,8,25],[19,32,8,30],[21,2,10,0],[22,0,11,0],[23,0,12,0],[24,2,13,0],[24,11,13,9,"registerSpanErrorInstrumentation"],[24,43,13,41,"registerSpanErrorInstrumentation"],[24,44,13,41],[24,46,13,44],[25,4,14,2],[25,8,14,6,"errorsInstrumented"],[25,26,14,24],[25,28,14,26],[26,6,15,4],[27,4,16,2],[29,4,18,2],[30,0,19,0],[31,0,20,0],[32,4,21,2],[32,13,21,11,"errorCallback"],[32,26,21,24,"errorCallback"],[32,27,21,24],[32,29,21,27],[33,6,22,4],[33,12,22,10,"activeSpan"],[33,22,22,20],[33,25,22,23],[33,29,22,23,"getActiveSpan"],[33,46,22,36],[33,47,22,36,"getActiveSpan"],[33,60,22,36],[33,62,22,37],[33,63,22,38],[34,6,23,4],[34,12,23,10,"rootSpan"],[34,20,23,18],[34,23,23,21,"activeSpan"],[34,33,23,31],[34,37,23,35],[34,41,23,35,"getRootSpan"],[34,58,23,46],[34,59,23,46,"getRootSpan"],[34,70,23,46],[34,72,23,47,"activeSpan"],[34,82,23,57],[34,83,23,58],[35,6,24,4],[35,10,24,8,"rootSpan"],[35,18,24,16],[35,20,24,18],[36,8,25,6],[36,14,25,12,"message"],[36,21,25,19],[36,24,25,22],[36,40,25,38],[37,8,26,6,"DEBUG_BUILD"],[37,21,26,17],[37,22,26,17,"DEBUG_BUILD"],[37,33,26,17],[37,37,26,21,"debug"],[37,56,26,26],[37,57,26,26,"debug"],[37,62,26,26],[37,63,26,27,"log"],[37,66,26,30],[37,67,26,31],[37,91,26,55,"message"],[37,98,26,62],[37,125,26,89],[37,126,26,90],[38,8,27,6,"rootSpan"],[38,16,27,14],[38,17,27,15,"setStatus"],[38,26,27,24],[38,27,27,25],[39,10,27,27,"code"],[39,14,27,31],[39,16,27,33,"SPAN_STATUS_ERROR"],[39,29,27,50],[39,30,27,50,"SPAN_STATUS_ERROR"],[39,47,27,50],[40,10,27,52,"message"],[41,8,27,60],[41,9,27,61],[41,10,27,62],[42,6,28,4],[43,4,29,2],[45,4,31,2],[46,4,32,2],[47,4,33,2,"errorCallback"],[47,17,33,15],[47,18,33,16,"tag"],[47,21,33,19],[47,24,33,22],[47,53,33,51],[48,4,35,2,"errorsInstrumented"],[48,22,35,20],[48,25,35,23],[48,29,35,27],[49,4,36,2],[49,8,36,2,"addGlobalErrorInstrumentationHandler"],[49,32,36,38],[49,33,36,38,"addGlobalErrorInstrumentationHandler"],[49,69,36,38],[49,71,36,39,"errorCallback"],[49,84,36,52],[49,85,36,53],[50,4,37,2],[50,8,37,2,"addGlobalUnhandledRejectionInstrumentationHandler"],[50,45,37,51],[50,46,37,51,"addGlobalUnhandledRejectionInstrumentationHandler"],[50,95,37,51],[50,97,37,52,"errorCallback"],[50,110,37,65],[50,111,37,66],[51,2,38,0],[52,0,38,1],[52,3]],"functionMap":{"names":["<global>","registerSpanErrorInstrumentation","errorCallback"],"mappings":"AAA;ACY;ECQ;GDQ;CDS"},"hasCjsExports":false},"type":"js/module"}]}