{"dependencies":[{"name":"../debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"rfhktnzi6PvZxT1xtyHWbBktN/w=","exportNames":["*"],"imports":1}},{"name":"../utils/debug-logger.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":49},"end":{"line":2,"column":49,"index":98}}],"key":"bptn1GZFOkS4BOMU8jhPqqHmvAc=","exportNames":["*"],"imports":1}},{"name":"../utils/hasSpansEnabled.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":62,"index":161}}],"key":"5PJ5OboJ1xAWFNG6iC6w5ishwR8=","exportNames":["*"],"imports":1}},{"name":"../utils/parseSampleRate.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":162},"end":{"line":4,"column":62,"index":224}}],"key":"fuSKwon9rTlXsG7MamYKWdW+40U=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"sampleSpan\", {\n    enumerable: true,\n    get: function () {\n      return sampleSpan;\n    }\n  });\n  var _debugBuildJs = require(_dependencyMap[0], \"../debug-build.js\");\n  var _utilsDebugLoggerJs = require(_dependencyMap[1], \"../utils/debug-logger.js\");\n  var _utilsHasSpansEnabledJs = require(_dependencyMap[2], \"../utils/hasSpansEnabled.js\");\n  var _utilsParseSampleRateJs = require(_dependencyMap[3], \"../utils/parseSampleRate.js\");\n  /**\n   * Makes a sampling decision for the given options.\n   *\n   * Called every time a root span is created. Only root spans which emerge with a `sampled` value of `true` will be\n   * sent to Sentry.\n   */\n  function sampleSpan(options, samplingContext, sampleRand) {\n    // nothing to do if span recording is not enabled\n    if (!(0, _utilsHasSpansEnabledJs.hasSpansEnabled)(options)) {\n      return [false];\n    }\n    let localSampleRateWasApplied = undefined;\n\n    // we would have bailed already if neither `tracesSampler` nor `tracesSampleRate` were defined, so one of these should\n    // work; prefer the hook if so\n    let sampleRate;\n    if (typeof options.tracesSampler === 'function') {\n      sampleRate = options.tracesSampler({\n        ...samplingContext,\n        inheritOrSampleWith: fallbackSampleRate => {\n          // If we have an incoming parent sample rate, we'll just use that one.\n          // The sampling decision will be inherited because of the sample_rand that was generated when the trace reached the incoming boundaries of the SDK.\n          if (typeof samplingContext.parentSampleRate === 'number') {\n            return samplingContext.parentSampleRate;\n          }\n\n          // Fallback if parent sample rate is not on the incoming trace (e.g. if there is no baggage)\n          // This is to provide backwards compatibility if there are incoming traces from older SDKs that don't send a parent sample rate or a sample rand. In these cases we just want to force either a sampling decision on the downstream traces via the sample rate.\n          if (typeof samplingContext.parentSampled === 'boolean') {\n            return Number(samplingContext.parentSampled);\n          }\n          return fallbackSampleRate;\n        }\n      });\n      localSampleRateWasApplied = true;\n    } else if (samplingContext.parentSampled !== undefined) {\n      sampleRate = samplingContext.parentSampled;\n    } else if (typeof options.tracesSampleRate !== 'undefined') {\n      sampleRate = options.tracesSampleRate;\n      localSampleRateWasApplied = true;\n    }\n\n    // Since this is coming from the user (or from a function provided by the user), who knows what we might get.\n    // (The only valid values are booleans or numbers between 0 and 1.)\n    const parsedSampleRate = (0, _utilsParseSampleRateJs.parseSampleRate)(sampleRate);\n    if (parsedSampleRate === undefined) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(sampleRate)} of type ${JSON.stringify(typeof sampleRate)}.`);\n      return [false];\n    }\n\n    // if the function returned 0 (or false), or if `tracesSampleRate` is 0, it's a sign the transaction should be dropped\n    if (!parsedSampleRate) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.log(`[Tracing] Discarding transaction because ${typeof options.tracesSampler === 'function' ? 'tracesSampler returned 0 or false' : 'a negative sampling decision was inherited or tracesSampleRate is set to 0'}`);\n      return [false, parsedSampleRate, localSampleRateWasApplied];\n    }\n\n    // We always compare the sample rand for the current execution context against the chosen sample rate.\n    // Read more: https://develop.sentry.dev/sdk/telemetry/traces/#propagated-random-value\n    const shouldSample = sampleRand < parsedSampleRate;\n\n    // if we're not going to keep it, we're done\n    if (!shouldSample) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(sampleRate)})`);\n    }\n    return [shouldSample, parsedSampleRate, localSampleRateWasApplied];\n  }\n});","lineCount":83,"map":[[7,2,98,0,"Object"],[7,8,98,0],[7,9,98,0,"defineProperty"],[7,23,98,0],[7,24,98,0,"exports"],[7,31,98,0],[8,4,98,0,"enumerable"],[8,14,98,0],[9,4,98,0,"get"],[9,7,98,0],[9,18,98,0,"get"],[9,19,98,0],[10,6,98,0],[10,13,98,9,"sampleSpan"],[10,23,98,19],[11,4,98,19],[12,2,98,19],[13,2,1,0],[13,6,1,0,"_debugBuildJs"],[13,19,1,0],[13,22,1,0,"require"],[13,29,1,0],[13,30,1,0,"_dependencyMap"],[13,44,1,0],[14,2,2,0],[14,6,2,0,"_utilsDebugLoggerJs"],[14,25,2,0],[14,28,2,0,"require"],[14,35,2,0],[14,36,2,0,"_dependencyMap"],[14,50,2,0],[15,2,3,0],[15,6,3,0,"_utilsHasSpansEnabledJs"],[15,29,3,0],[15,32,3,0,"require"],[15,39,3,0],[15,40,3,0,"_dependencyMap"],[15,54,3,0],[16,2,4,0],[16,6,4,0,"_utilsParseSampleRateJs"],[16,29,4,0],[16,32,4,0,"require"],[16,39,4,0],[16,40,4,0,"_dependencyMap"],[16,54,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,2,12,0],[23,11,12,9,"sampleSpan"],[23,21,12,19,"sampleSpan"],[23,22,13,2,"options"],[23,29,13,9],[23,31,14,2,"samplingContext"],[23,46,14,17],[23,48,15,2,"sampleRand"],[23,58,15,12],[23,60,16,2],[24,4,17,2],[25,4,18,2],[25,8,18,6],[25,9,18,7],[25,13,18,7,"hasSpansEnabled"],[25,36,18,22],[25,37,18,22,"hasSpansEnabled"],[25,52,18,22],[25,54,18,23,"options"],[25,61,18,30],[25,62,18,31],[25,64,18,33],[26,6,19,4],[26,13,19,11],[26,14,19,12],[26,19,19,17],[26,20,19,18],[27,4,20,2],[28,4,22,2],[28,8,22,6,"localSampleRateWasApplied"],[28,33,22,31],[28,36,22,34,"undefined"],[28,45,22,43],[30,4,24,2],[31,4,25,2],[32,4,26,2],[32,8,26,6,"sampleRate"],[32,18,26,16],[33,4,27,2],[33,8,27,6],[33,15,27,13,"options"],[33,22,27,20],[33,23,27,21,"tracesSampler"],[33,36,27,34],[33,41,27,39],[33,51,27,49],[33,53,27,51],[34,6,28,4,"sampleRate"],[34,16,28,14],[34,19,28,17,"options"],[34,26,28,24],[34,27,28,25,"tracesSampler"],[34,40,28,38],[34,41,28,39],[35,8,29,6],[35,11,29,9,"samplingContext"],[35,26,29,24],[36,8,30,6,"inheritOrSampleWith"],[36,27,30,25],[36,29,30,27,"fallbackSampleRate"],[36,47,30,45],[36,51,30,49],[37,10,31,8],[38,10,32,8],[39,10,33,8],[39,14,33,12],[39,21,33,19,"samplingContext"],[39,36,33,34],[39,37,33,35,"parentSampleRate"],[39,53,33,51],[39,58,33,56],[39,66,33,64],[39,68,33,66],[40,12,34,10],[40,19,34,17,"samplingContext"],[40,34,34,32],[40,35,34,33,"parentSampleRate"],[40,51,34,49],[41,10,35,8],[43,10,37,8],[44,10,38,8],[45,10,39,8],[45,14,39,12],[45,21,39,19,"samplingContext"],[45,36,39,34],[45,37,39,35,"parentSampled"],[45,50,39,48],[45,55,39,53],[45,64,39,62],[45,66,39,64],[46,12,40,10],[46,19,40,17,"Number"],[46,25,40,23],[46,26,40,24,"samplingContext"],[46,41,40,39],[46,42,40,40,"parentSampled"],[46,55,40,53],[46,56,40,54],[47,10,41,8],[48,10,43,8],[48,17,43,15,"fallbackSampleRate"],[48,35,43,33],[49,8,44,6],[50,6,45,4],[50,7,45,5],[50,8,45,6],[51,6,46,4,"localSampleRateWasApplied"],[51,31,46,29],[51,34,46,32],[51,38,46,36],[52,4,47,2],[52,5,47,3],[52,11,47,9],[52,15,47,13,"samplingContext"],[52,30,47,28],[52,31,47,29,"parentSampled"],[52,44,47,42],[52,49,47,47,"undefined"],[52,58,47,56],[52,60,47,58],[53,6,48,4,"sampleRate"],[53,16,48,14],[53,19,48,17,"samplingContext"],[53,34,48,32],[53,35,48,33,"parentSampled"],[53,48,48,46],[54,4,49,2],[54,5,49,3],[54,11,49,9],[54,15,49,13],[54,22,49,20,"options"],[54,29,49,27],[54,30,49,28,"tracesSampleRate"],[54,46,49,44],[54,51,49,49],[54,62,49,60],[54,64,49,62],[55,6,50,4,"sampleRate"],[55,16,50,14],[55,19,50,17,"options"],[55,26,50,24],[55,27,50,25,"tracesSampleRate"],[55,43,50,41],[56,6,51,4,"localSampleRateWasApplied"],[56,31,51,29],[56,34,51,32],[56,38,51,36],[57,4,52,2],[59,4,54,2],[60,4,55,2],[61,4,56,2],[61,10,56,8,"parsedSampleRate"],[61,26,56,24],[61,29,56,27],[61,33,56,27,"parseSampleRate"],[61,56,56,42],[61,57,56,42,"parseSampleRate"],[61,72,56,42],[61,74,56,43,"sampleRate"],[61,84,56,53],[61,85,56,54],[62,4,58,2],[62,8,58,6,"parsedSampleRate"],[62,24,58,22],[62,29,58,27,"undefined"],[62,38,58,36],[62,40,58,38],[63,6,59,4,"DEBUG_BUILD"],[63,19,59,15],[63,20,59,15,"DEBUG_BUILD"],[63,31,59,15],[63,35,60,6,"debug"],[63,54,60,11],[63,55,60,11,"debug"],[63,60,60,11],[63,61,60,12,"warn"],[63,65,60,16],[63,66,61,8],[63,195,61,137,"JSON"],[63,199,61,141],[63,200,61,142,"stringify"],[63,209,61,151],[63,210,62,10,"sampleRate"],[63,220,63,8],[63,221,63,9],[63,233,63,21,"JSON"],[63,237,63,25],[63,238,63,26,"stringify"],[63,247,63,35],[63,248,63,36],[63,255,63,43,"sampleRate"],[63,265,63,53],[63,266,63,54],[63,269,64,6],[63,270,64,7],[64,6,65,4],[64,13,65,11],[64,14,65,12],[64,19,65,17],[64,20,65,18],[65,4,66,2],[67,4,68,2],[68,4,69,2],[68,8,69,6],[68,9,69,7,"parsedSampleRate"],[68,25,69,23],[68,27,69,25],[69,6,70,4,"DEBUG_BUILD"],[69,19,70,15],[69,20,70,15,"DEBUG_BUILD"],[69,31,70,15],[69,35,71,6,"debug"],[69,54,71,11],[69,55,71,11,"debug"],[69,60,71,11],[69,61,71,12,"log"],[69,64,71,15],[69,65,72,8],[69,109,73,10],[69,116,73,17,"options"],[69,123,73,24],[69,124,73,25,"tracesSampler"],[69,137,73,38],[69,142,73,43],[69,152,73,53],[69,155,74,14],[69,190,74,49],[69,193,75,14],[69,269,75,90],[69,271,77,6],[69,272,77,7],[70,6,78,4],[70,13,78,11],[70,14,78,12],[70,19,78,17],[70,21,78,19,"parsedSampleRate"],[70,37,78,35],[70,39,78,37,"localSampleRateWasApplied"],[70,64,78,62],[70,65,78,63],[71,4,79,2],[73,4,81,2],[74,4,82,2],[75,4,83,2],[75,10,83,8,"shouldSample"],[75,22,83,20],[75,25,83,23,"sampleRand"],[75,35,83,33],[75,38,83,36,"parsedSampleRate"],[75,54,83,52],[77,4,85,2],[78,4,86,2],[78,8,86,6],[78,9,86,7,"shouldSample"],[78,21,86,19],[78,23,86,21],[79,6,87,4,"DEBUG_BUILD"],[79,19,87,15],[79,20,87,15,"DEBUG_BUILD"],[79,31,87,15],[79,35,88,6,"debug"],[79,54,88,11],[79,55,88,11,"debug"],[79,60,88,11],[79,61,88,12,"log"],[79,64,88,15],[79,65,89,8],[79,165,89,108,"Number"],[79,171,89,114],[79,172,90,10,"sampleRate"],[79,182,91,8],[79,183,91,9],[79,186,92,6],[79,187,92,7],[80,4,93,2],[81,4,95,2],[81,11,95,9],[81,12,95,10,"shouldSample"],[81,24,95,22],[81,26,95,24,"parsedSampleRate"],[81,42,95,40],[81,44,95,42,"localSampleRateWasApplied"],[81,69,95,67],[81,70,95,68],[82,2,96,0],[83,0,96,1],[83,3]],"functionMap":{"names":["<global>","sampleSpan","options.tracesSampler$argument_0.inheritOrSampleWith"],"mappings":"AAA;ACW;2BCkB;ODc;CDoD"},"hasCjsExports":false},"type":"js/module"}]}