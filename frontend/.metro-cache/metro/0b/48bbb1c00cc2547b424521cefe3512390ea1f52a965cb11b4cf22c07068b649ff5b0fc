{"dependencies":[{"name":"../../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"EZPmsHt7bn9JJ4Y0grXw/CrOow0=","exportNames":["*"],"imports":1}},{"name":"../../tracing/spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":64,"index":117}}],"key":"xTnLe4eZ8UwJZsOO8L+5TFoq+AE=","exportNames":["*"],"imports":1}},{"name":"../ai/gen-ai-attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":118},"end":{"line":3,"column":193,"index":311}}],"key":"nKHaXfEjIYF1icPUCGJgR0o1cZ8=","exportNames":["*"],"imports":1}},{"name":"./constants.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":312},"end":{"line":4,"column":54,"index":366}}],"key":"46QfplZMuoT7/1B4GqMDknw8q/g=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":367},"end":{"line":5,"column":132,"index":499}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"instrumentStream\", {\n    enumerable: true,\n    get: function () {\n      return instrumentStream;\n    }\n  });\n  var _exportsJs = require(_dependencyMap[0], \"../../exports.js\");\n  var _tracingSpanstatusJs = require(_dependencyMap[1], \"../../tracing/spanstatus.js\");\n  var _aiGenAiAttributesJs = require(_dependencyMap[2], \"../ai/gen-ai-attributes.js\");\n  var _constantsJs = require(_dependencyMap[3], \"./constants.js\");\n  var _utilsJs = require(_dependencyMap[4], \"./utils.js\");\n  /**\n   * State object used to accumulate information from a stream of OpenAI events/chunks.\n   */\n\n  /**\n   * Processes tool calls from a chat completion chunk delta.\n   * Follows the pattern: accumulate by index, then convert to array at the end.\n   *\n   * @param toolCalls - Array of tool calls from the delta.\n   * @param state - The current streaming state to update.\n   *\n   *  @see https://platform.openai.com/docs/guides/function-calling#streaming\n   */\n  function processChatCompletionToolCalls(toolCalls, state) {\n    for (const toolCall of toolCalls) {\n      const index = toolCall.index;\n      if (index === undefined || !toolCall.function) continue;\n\n      // Initialize tool call if this is the first chunk for this index\n      if (!(index in state.chatCompletionToolCalls)) {\n        state.chatCompletionToolCalls[index] = Object.assign({}, toolCall, {\n          function: {\n            name: toolCall.function.name,\n            arguments: toolCall.function.arguments || ''\n          }\n        });\n      } else {\n        // Accumulate function arguments from subsequent chunks\n        const existingToolCall = state.chatCompletionToolCalls[index];\n        if (toolCall.function.arguments && existingToolCall?.function) {\n          existingToolCall.function.arguments += toolCall.function.arguments;\n        }\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI ChatCompletionChunk event, updating the streaming state.\n   *\n   * @param chunk - The ChatCompletionChunk event to process.\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   */\n  function processChatCompletionChunk(chunk, state, recordOutputs) {\n    state.responseId = chunk.id ?? state.responseId;\n    state.responseModel = chunk.model ?? state.responseModel;\n    state.responseTimestamp = chunk.created ?? state.responseTimestamp;\n    if (chunk.usage) {\n      // For stream responses, the input tokens remain constant across all events in the stream.\n      // Output tokens, however, are only finalized in the last event.\n      // Since we can't guarantee that the last event will include usage data or even be a typed event,\n      // we update the output token values on every event that includes them.\n      // This ensures that output token usage is always set, even if the final event lacks it.\n      state.promptTokens = chunk.usage.prompt_tokens;\n      state.completionTokens = chunk.usage.completion_tokens;\n      state.totalTokens = chunk.usage.total_tokens;\n    }\n    for (const choice of chunk.choices ?? []) {\n      if (recordOutputs) {\n        if (choice.delta?.content) {\n          state.responseTexts.push(choice.delta.content);\n        }\n\n        // Handle tool calls from delta\n        if (choice.delta?.tool_calls) {\n          processChatCompletionToolCalls(choice.delta.tool_calls, state);\n        }\n      }\n      if (choice.finish_reason) {\n        state.finishReasons.push(choice.finish_reason);\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI Responses API streaming event, updating the streaming state and span.\n   *\n   * @param streamEvent - The event to process (may be an error or unknown object).\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   * @param span - The span to update with error status if needed.\n   */\n  function processResponsesApiEvent(streamEvent, state, recordOutputs, span) {\n    if (!(streamEvent && typeof streamEvent === 'object')) {\n      state.eventTypes.push('unknown:non-object');\n      return;\n    }\n    if (streamEvent instanceof Error) {\n      span.setStatus({\n        code: _tracingSpanstatusJs.SPAN_STATUS_ERROR,\n        message: 'internal_error'\n      });\n      (0, _exportsJs.captureException)(streamEvent, {\n        mechanism: {\n          handled: false,\n          type: 'auto.ai.openai.stream-response'\n        }\n      });\n      return;\n    }\n    if (!('type' in streamEvent)) return;\n    const event = streamEvent;\n    if (!_constantsJs.RESPONSE_EVENT_TYPES.includes(event.type)) {\n      state.eventTypes.push(event.type);\n      return;\n    }\n\n    // Handle output text delta\n    if (recordOutputs) {\n      // Handle tool call events for Responses API\n      if (event.type === 'response.output_item.done' && 'item' in event) {\n        state.responsesApiToolCalls.push(event.item);\n      }\n      if (event.type === 'response.output_text.delta' && 'delta' in event && event.delta) {\n        state.responseTexts.push(event.delta);\n        return;\n      }\n    }\n    if ('response' in event) {\n      const {\n        response\n      } = event;\n      state.responseId = response.id ?? state.responseId;\n      state.responseModel = response.model ?? state.responseModel;\n      state.responseTimestamp = response.created_at ?? state.responseTimestamp;\n      if (response.usage) {\n        // For stream responses, the input tokens remain constant across all events in the stream.\n        // Output tokens, however, are only finalized in the last event.\n        // Since we can't guarantee that the last event will include usage data or even be a typed event,\n        // we update the output token values on every event that includes them.\n        // This ensures that output token usage is always set, even if the final event lacks it.\n        state.promptTokens = response.usage.input_tokens;\n        state.completionTokens = response.usage.output_tokens;\n        state.totalTokens = response.usage.total_tokens;\n      }\n      if (response.status) {\n        state.finishReasons.push(response.status);\n      }\n      if (recordOutputs && response.output_text) {\n        state.responseTexts.push(response.output_text);\n      }\n    }\n  }\n\n  /**\n   * Instruments a stream of OpenAI events, updating the provided span with relevant attributes and\n   * optionally recording output text. This function yields each event from the input stream as it is processed.\n   *\n   * @template T - The type of events in the stream.\n   * @param stream - The async iterable stream of events to instrument.\n   * @param span - The span to add attributes to and to finish at the end of the stream.\n   * @param recordOutputs - Whether to record output text fragments in the span.\n   * @returns An async generator yielding each event from the input stream.\n   */\n  async function* instrumentStream(stream, span, recordOutputs) {\n    const state = {\n      eventTypes: [],\n      responseTexts: [],\n      finishReasons: [],\n      responseId: '',\n      responseModel: '',\n      responseTimestamp: 0,\n      promptTokens: undefined,\n      completionTokens: undefined,\n      totalTokens: undefined,\n      chatCompletionToolCalls: {},\n      responsesApiToolCalls: []\n    };\n    try {\n      for await (const event of stream) {\n        if ((0, _utilsJs.isChatCompletionChunk)(event)) {\n          processChatCompletionChunk(event, state, recordOutputs);\n        } else if ((0, _utilsJs.isResponsesApiStreamEvent)(event)) {\n          processResponsesApiEvent(event, state, recordOutputs, span);\n        }\n        yield event;\n      }\n    } finally {\n      (0, _utilsJs.setCommonResponseAttributes)(span, state.responseId, state.responseModel, state.responseTimestamp);\n      (0, _utilsJs.setTokenUsageAttributes)(span, state.promptTokens, state.completionTokens, state.totalTokens);\n      span.setAttributes({\n        [_aiGenAiAttributesJs.GEN_AI_RESPONSE_STREAMING_ATTRIBUTE]: true\n      });\n      if (state.finishReasons.length) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE]: JSON.stringify(state.finishReasons)\n        });\n      }\n      if (recordOutputs && state.responseTexts.length) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TEXT_ATTRIBUTE]: state.responseTexts.join('')\n        });\n      }\n\n      // Set tool calls attribute if any were accumulated\n      const chatCompletionToolCallsArray = Object.values(state.chatCompletionToolCalls);\n      const allToolCalls = [...chatCompletionToolCallsArray, ...state.responsesApiToolCalls];\n      if (allToolCalls.length > 0) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE]: JSON.stringify(allToolCalls)\n        });\n      }\n      span.end();\n    }\n  }\n});","lineCount":223,"map":[[7,2,233,0,"Object"],[7,8,233,0],[7,9,233,0,"defineProperty"],[7,23,233,0],[7,24,233,0,"exports"],[7,31,233,0],[8,4,233,0,"enumerable"],[8,14,233,0],[9,4,233,0,"get"],[9,7,233,0],[9,18,233,0,"get"],[9,19,233,0],[10,6,233,0],[10,13,233,9,"instrumentStream"],[10,29,233,25],[11,4,233,25],[12,2,233,25],[13,2,1,0],[13,6,1,0,"_exportsJs"],[13,16,1,0],[13,19,1,0,"require"],[13,26,1,0],[13,27,1,0,"_dependencyMap"],[13,41,1,0],[14,2,2,0],[14,6,2,0,"_tracingSpanstatusJs"],[14,26,2,0],[14,29,2,0,"require"],[14,36,2,0],[14,37,2,0,"_dependencyMap"],[14,51,2,0],[15,2,3,0],[15,6,3,0,"_aiGenAiAttributesJs"],[15,26,3,0],[15,29,3,0,"require"],[15,36,3,0],[15,37,3,0,"_dependencyMap"],[15,51,3,0],[16,2,4,0],[16,6,4,0,"_constantsJs"],[16,18,4,0],[16,21,4,0,"require"],[16,28,4,0],[16,29,4,0,"_dependencyMap"],[16,43,4,0],[17,2,5,0],[17,6,5,0,"_utilsJs"],[17,14,5,0],[17,17,5,0,"require"],[17,24,5,0],[17,25,5,0,"_dependencyMap"],[17,39,5,0],[18,2,7,0],[19,0,8,0],[20,0,9,0],[22,2,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,0,18,0],[30,0,19,0],[31,2,20,0],[31,11,20,9,"processChatCompletionToolCalls"],[31,41,20,39,"processChatCompletionToolCalls"],[31,42,20,40,"toolCalls"],[31,51,20,49],[31,53,20,51,"state"],[31,58,20,56],[31,60,20,58],[32,4,21,2],[32,9,21,7],[32,15,21,13,"toolCall"],[32,23,21,21],[32,27,21,25,"toolCalls"],[32,36,21,34],[32,38,21,36],[33,6,22,4],[33,12,22,10,"index"],[33,17,22,15],[33,20,22,18,"toolCall"],[33,28,22,26],[33,29,22,27,"index"],[33,34,22,32],[34,6,23,4],[34,10,23,8,"index"],[34,15,23,13],[34,20,23,18,"undefined"],[34,29,23,27],[34,33,23,31],[34,34,23,32,"toolCall"],[34,42,23,40],[34,43,23,41,"function"],[34,51,23,49],[34,53,23,51],[36,6,25,4],[37,6,26,4],[37,10,26,8],[37,12,26,10,"index"],[37,17,26,15],[37,21,26,19,"state"],[37,26,26,24],[37,27,26,25,"chatCompletionToolCalls"],[37,50,26,48],[37,51,26,49],[37,53,26,51],[38,8,27,6,"state"],[38,13,27,11],[38,14,27,12,"chatCompletionToolCalls"],[38,37,27,35],[38,38,27,36,"index"],[38,43,27,41],[38,44,27,42],[38,47,27,42,"Object"],[38,53,27,42],[38,54,27,42,"assign"],[38,60,27,42],[38,65,28,11,"toolCall"],[38,73,28,19],[39,10,29,8,"function"],[39,18,29,16],[39,20,29,18],[40,12,30,10,"name"],[40,16,30,14],[40,18,30,16,"toolCall"],[40,26,30,24],[40,27,30,25,"function"],[40,35,30,33],[40,36,30,34,"name"],[40,40,30,38],[41,12,31,10,"arguments"],[41,21,31,19],[41,23,31,21,"toolCall"],[41,31,31,29],[41,32,31,30,"function"],[41,40,31,38],[41,41,31,39,"arguments"],[41,50,31,48],[41,54,31,52],[42,10,32,8],[43,8,32,9],[43,10,33,7],[44,6,34,4],[44,7,34,5],[44,13,34,11],[45,8,35,6],[46,8,36,6],[46,14,36,12,"existingToolCall"],[46,30,36,28],[46,33,36,31,"state"],[46,38,36,36],[46,39,36,37,"chatCompletionToolCalls"],[46,62,36,60],[46,63,36,61,"index"],[46,68,36,66],[46,69,36,67],[47,8,37,6],[47,12,37,10,"toolCall"],[47,20,37,18],[47,21,37,19,"function"],[47,29,37,27],[47,30,37,28,"arguments"],[47,39,37,37],[47,43,37,41,"existingToolCall"],[47,59,37,57],[47,61,37,59,"function"],[47,69,37,67],[47,71,37,69],[48,10,38,8,"existingToolCall"],[48,26,38,24],[48,27,38,25,"function"],[48,35,38,33],[48,36,38,34,"arguments"],[48,45,38,43],[48,49,38,47,"toolCall"],[48,57,38,55],[48,58,38,56,"function"],[48,66,38,64],[48,67,38,65,"arguments"],[48,76,38,74],[49,8,39,6],[50,6,40,4],[51,4,41,2],[52,2,42,0],[54,2,44,0],[55,0,45,0],[56,0,46,0],[57,0,47,0],[58,0,48,0],[59,0,49,0],[60,0,50,0],[61,2,51,0],[61,11,51,9,"processChatCompletionChunk"],[61,37,51,35,"processChatCompletionChunk"],[61,38,51,36,"chunk"],[61,43,51,41],[61,45,51,43,"state"],[61,50,51,48],[61,52,51,50,"recordOutputs"],[61,65,51,63],[61,67,51,65],[62,4,52,2,"state"],[62,9,52,7],[62,10,52,8,"responseId"],[62,20,52,18],[62,23,52,21,"chunk"],[62,28,52,26],[62,29,52,27,"id"],[62,31,52,29],[62,35,52,33,"state"],[62,40,52,38],[62,41,52,39,"responseId"],[62,51,52,49],[63,4,53,2,"state"],[63,9,53,7],[63,10,53,8,"responseModel"],[63,23,53,21],[63,26,53,24,"chunk"],[63,31,53,29],[63,32,53,30,"model"],[63,37,53,35],[63,41,53,39,"state"],[63,46,53,44],[63,47,53,45,"responseModel"],[63,60,53,58],[64,4,54,2,"state"],[64,9,54,7],[64,10,54,8,"responseTimestamp"],[64,27,54,25],[64,30,54,28,"chunk"],[64,35,54,33],[64,36,54,34,"created"],[64,43,54,41],[64,47,54,45,"state"],[64,52,54,50],[64,53,54,51,"responseTimestamp"],[64,70,54,68],[65,4,56,2],[65,8,56,6,"chunk"],[65,13,56,11],[65,14,56,12,"usage"],[65,19,56,17],[65,21,56,19],[66,6,57,4],[67,6,58,4],[68,6,59,4],[69,6,60,4],[70,6,61,4],[71,6,62,4,"state"],[71,11,62,9],[71,12,62,10,"promptTokens"],[71,24,62,22],[71,27,62,25,"chunk"],[71,32,62,30],[71,33,62,31,"usage"],[71,38,62,36],[71,39,62,37,"prompt_tokens"],[71,52,62,50],[72,6,63,4,"state"],[72,11,63,9],[72,12,63,10,"completionTokens"],[72,28,63,26],[72,31,63,29,"chunk"],[72,36,63,34],[72,37,63,35,"usage"],[72,42,63,40],[72,43,63,41,"completion_tokens"],[72,60,63,58],[73,6,64,4,"state"],[73,11,64,9],[73,12,64,10,"totalTokens"],[73,23,64,21],[73,26,64,24,"chunk"],[73,31,64,29],[73,32,64,30,"usage"],[73,37,64,35],[73,38,64,36,"total_tokens"],[73,50,64,48],[74,4,65,2],[75,4,67,2],[75,9,67,7],[75,15,67,13,"choice"],[75,21,67,19],[75,25,67,23,"chunk"],[75,30,67,28],[75,31,67,29,"choices"],[75,38,67,36],[75,42,67,40],[75,44,67,42],[75,46,67,44],[76,6,68,4],[76,10,68,8,"recordOutputs"],[76,23,68,21],[76,25,68,23],[77,8,69,6],[77,12,69,10,"choice"],[77,18,69,16],[77,19,69,17,"delta"],[77,24,69,22],[77,26,69,24,"content"],[77,33,69,31],[77,35,69,33],[78,10,70,8,"state"],[78,15,70,13],[78,16,70,14,"responseTexts"],[78,29,70,27],[78,30,70,28,"push"],[78,34,70,32],[78,35,70,33,"choice"],[78,41,70,39],[78,42,70,40,"delta"],[78,47,70,45],[78,48,70,46,"content"],[78,55,70,53],[78,56,70,54],[79,8,71,6],[81,8,73,6],[82,8,74,6],[82,12,74,10,"choice"],[82,18,74,16],[82,19,74,17,"delta"],[82,24,74,22],[82,26,74,24,"tool_calls"],[82,36,74,34],[82,38,74,36],[83,10,75,8,"processChatCompletionToolCalls"],[83,40,75,38],[83,41,75,39,"choice"],[83,47,75,45],[83,48,75,46,"delta"],[83,53,75,51],[83,54,75,52,"tool_calls"],[83,64,75,62],[83,66,75,64,"state"],[83,71,75,69],[83,72,75,70],[84,8,76,6],[85,6,77,4],[86,6,78,4],[86,10,78,8,"choice"],[86,16,78,14],[86,17,78,15,"finish_reason"],[86,30,78,28],[86,32,78,30],[87,8,79,6,"state"],[87,13,79,11],[87,14,79,12,"finishReasons"],[87,27,79,25],[87,28,79,26,"push"],[87,32,79,30],[87,33,79,31,"choice"],[87,39,79,37],[87,40,79,38,"finish_reason"],[87,53,79,51],[87,54,79,52],[88,6,80,4],[89,4,81,2],[90,2,82,0],[92,2,84,0],[93,0,85,0],[94,0,86,0],[95,0,87,0],[96,0,88,0],[97,0,89,0],[98,0,90,0],[99,0,91,0],[100,2,92,0],[100,11,92,9,"processResponsesApiEvent"],[100,35,92,33,"processResponsesApiEvent"],[100,36,93,2,"streamEvent"],[100,47,93,13],[100,49,94,2,"state"],[100,54,94,7],[100,56,95,2,"recordOutputs"],[100,69,95,15],[100,71,96,2,"span"],[100,75,96,6],[100,77,97,2],[101,4,98,2],[101,8,98,6],[101,10,98,8,"streamEvent"],[101,21,98,19],[101,25,98,23],[101,32,98,30,"streamEvent"],[101,43,98,41],[101,48,98,46],[101,56,98,54],[101,57,98,55],[101,59,98,57],[102,6,99,4,"state"],[102,11,99,9],[102,12,99,10,"eventTypes"],[102,22,99,20],[102,23,99,21,"push"],[102,27,99,25],[102,28,99,26],[102,48,99,46],[102,49,99,47],[103,6,100,4],[104,4,101,2],[105,4,102,2],[105,8,102,6,"streamEvent"],[105,19,102,17],[105,31,102,29,"Error"],[105,36,102,34],[105,38,102,36],[106,6,103,4,"span"],[106,10,103,8],[106,11,103,9,"setStatus"],[106,20,103,18],[106,21,103,19],[107,8,103,21,"code"],[107,12,103,25],[107,14,103,27,"SPAN_STATUS_ERROR"],[107,34,103,44],[107,35,103,44,"SPAN_STATUS_ERROR"],[107,52,103,44],[108,8,103,46,"message"],[108,15,103,53],[108,17,103,55],[109,6,103,72],[109,7,103,73],[109,8,103,74],[110,6,104,4],[110,10,104,4,"captureException"],[110,20,104,20],[110,21,104,20,"captureException"],[110,37,104,20],[110,39,104,21,"streamEvent"],[110,50,104,32],[110,52,104,34],[111,8,105,6,"mechanism"],[111,17,105,15],[111,19,105,17],[112,10,106,8,"handled"],[112,17,106,15],[112,19,106,17],[112,24,106,22],[113,10,107,8,"type"],[113,14,107,12],[113,16,107,14],[114,8,108,6],[115,6,109,4],[115,7,109,5],[115,8,109,6],[116,6,110,4],[117,4,111,2],[118,4,113,2],[118,8,113,6],[118,10,113,8],[118,16,113,14],[118,20,113,18,"streamEvent"],[118,31,113,29],[118,32,113,30],[118,34,113,32],[119,4,114,2],[119,10,114,8,"event"],[119,15,114,13],[119,18,114,16,"streamEvent"],[119,29,114,27],[120,4,116,2],[120,8,116,6],[120,9,116,7,"RESPONSE_EVENT_TYPES"],[120,21,116,27],[120,22,116,27,"RESPONSE_EVENT_TYPES"],[120,42,116,27],[120,43,116,28,"includes"],[120,51,116,36],[120,52,116,37,"event"],[120,57,116,42],[120,58,116,43,"type"],[120,62,116,47],[120,63,116,48],[120,65,116,50],[121,6,117,4,"state"],[121,11,117,9],[121,12,117,10,"eventTypes"],[121,22,117,20],[121,23,117,21,"push"],[121,27,117,25],[121,28,117,26,"event"],[121,33,117,31],[121,34,117,32,"type"],[121,38,117,36],[121,39,117,37],[122,6,118,4],[123,4,119,2],[125,4,121,2],[126,4,122,2],[126,8,122,6,"recordOutputs"],[126,21,122,19],[126,23,122,21],[127,6,123,4],[128,6,124,4],[128,10,124,8,"event"],[128,15,124,13],[128,16,124,14,"type"],[128,20,124,18],[128,25,124,23],[128,52,124,50],[128,56,124,54],[128,62,124,60],[128,66,124,64,"event"],[128,71,124,69],[128,73,124,71],[129,8,125,6,"state"],[129,13,125,11],[129,14,125,12,"responsesApiToolCalls"],[129,35,125,33],[129,36,125,34,"push"],[129,40,125,38],[129,41,125,39,"event"],[129,46,125,44],[129,47,125,45,"item"],[129,51,125,49],[129,52,125,50],[130,6,126,4],[131,6,128,4],[131,10,128,8,"event"],[131,15,128,13],[131,16,128,14,"type"],[131,20,128,18],[131,25,128,23],[131,53,128,51],[131,57,128,55],[131,64,128,62],[131,68,128,66,"event"],[131,73,128,71],[131,77,128,75,"event"],[131,82,128,80],[131,83,128,81,"delta"],[131,88,128,86],[131,90,128,88],[132,8,129,6,"state"],[132,13,129,11],[132,14,129,12,"responseTexts"],[132,27,129,25],[132,28,129,26,"push"],[132,32,129,30],[132,33,129,31,"event"],[132,38,129,36],[132,39,129,37,"delta"],[132,44,129,42],[132,45,129,43],[133,8,130,6],[134,6,131,4],[135,4,132,2],[136,4,134,2],[136,8,134,6],[136,18,134,16],[136,22,134,20,"event"],[136,27,134,25],[136,29,134,27],[137,6,135,4],[137,12,135,10],[138,8,135,12,"response"],[139,6,135,21],[139,7,135,22],[139,10,135,25,"event"],[139,15,135,30],[140,6,136,4,"state"],[140,11,136,9],[140,12,136,10,"responseId"],[140,22,136,20],[140,25,136,23,"response"],[140,33,136,31],[140,34,136,32,"id"],[140,36,136,34],[140,40,136,38,"state"],[140,45,136,43],[140,46,136,44,"responseId"],[140,56,136,54],[141,6,137,4,"state"],[141,11,137,9],[141,12,137,10,"responseModel"],[141,25,137,23],[141,28,137,26,"response"],[141,36,137,34],[141,37,137,35,"model"],[141,42,137,40],[141,46,137,44,"state"],[141,51,137,49],[141,52,137,50,"responseModel"],[141,65,137,63],[142,6,138,4,"state"],[142,11,138,9],[142,12,138,10,"responseTimestamp"],[142,29,138,27],[142,32,138,30,"response"],[142,40,138,38],[142,41,138,39,"created_at"],[142,51,138,49],[142,55,138,53,"state"],[142,60,138,58],[142,61,138,59,"responseTimestamp"],[142,78,138,76],[143,6,140,4],[143,10,140,8,"response"],[143,18,140,16],[143,19,140,17,"usage"],[143,24,140,22],[143,26,140,24],[144,8,141,6],[145,8,142,6],[146,8,143,6],[147,8,144,6],[148,8,145,6],[149,8,146,6,"state"],[149,13,146,11],[149,14,146,12,"promptTokens"],[149,26,146,24],[149,29,146,27,"response"],[149,37,146,35],[149,38,146,36,"usage"],[149,43,146,41],[149,44,146,42,"input_tokens"],[149,56,146,54],[150,8,147,6,"state"],[150,13,147,11],[150,14,147,12,"completionTokens"],[150,30,147,28],[150,33,147,31,"response"],[150,41,147,39],[150,42,147,40,"usage"],[150,47,147,45],[150,48,147,46,"output_tokens"],[150,61,147,59],[151,8,148,6,"state"],[151,13,148,11],[151,14,148,12,"totalTokens"],[151,25,148,23],[151,28,148,26,"response"],[151,36,148,34],[151,37,148,35,"usage"],[151,42,148,40],[151,43,148,41,"total_tokens"],[151,55,148,53],[152,6,149,4],[153,6,151,4],[153,10,151,8,"response"],[153,18,151,16],[153,19,151,17,"status"],[153,25,151,23],[153,27,151,25],[154,8,152,6,"state"],[154,13,152,11],[154,14,152,12,"finishReasons"],[154,27,152,25],[154,28,152,26,"push"],[154,32,152,30],[154,33,152,31,"response"],[154,41,152,39],[154,42,152,40,"status"],[154,48,152,46],[154,49,152,47],[155,6,153,4],[156,6,155,4],[156,10,155,8,"recordOutputs"],[156,23,155,21],[156,27,155,25,"response"],[156,35,155,33],[156,36,155,34,"output_text"],[156,47,155,45],[156,49,155,47],[157,8,156,6,"state"],[157,13,156,11],[157,14,156,12,"responseTexts"],[157,27,156,25],[157,28,156,26,"push"],[157,32,156,30],[157,33,156,31,"response"],[157,41,156,39],[157,42,156,40,"output_text"],[157,53,156,51],[157,54,156,52],[158,6,157,4],[159,4,158,2],[160,2,159,0],[162,2,161,0],[163,0,162,0],[164,0,163,0],[165,0,164,0],[166,0,165,0],[167,0,166,0],[168,0,167,0],[169,0,168,0],[170,0,169,0],[171,0,170,0],[172,2,171,0],[172,18,171,16,"instrumentStream"],[172,34,171,32,"instrumentStream"],[172,35,172,2,"stream"],[172,41,172,8],[172,43,173,2,"span"],[172,47,173,6],[172,49,174,2,"recordOutputs"],[172,62,174,15],[172,64,175,2],[173,4,176,2],[173,10,176,8,"state"],[173,15,176,13],[173,18,176,16],[174,6,177,4,"eventTypes"],[174,16,177,14],[174,18,177,16],[174,20,177,18],[175,6,178,4,"responseTexts"],[175,19,178,17],[175,21,178,19],[175,23,178,21],[176,6,179,4,"finishReasons"],[176,19,179,17],[176,21,179,19],[176,23,179,21],[177,6,180,4,"responseId"],[177,16,180,14],[177,18,180,16],[177,20,180,18],[178,6,181,4,"responseModel"],[178,19,181,17],[178,21,181,19],[178,23,181,21],[179,6,182,4,"responseTimestamp"],[179,23,182,21],[179,25,182,23],[179,26,182,24],[180,6,183,4,"promptTokens"],[180,18,183,16],[180,20,183,18,"undefined"],[180,29,183,27],[181,6,184,4,"completionTokens"],[181,22,184,20],[181,24,184,22,"undefined"],[181,33,184,31],[182,6,185,4,"totalTokens"],[182,17,185,15],[182,19,185,17,"undefined"],[182,28,185,26],[183,6,186,4,"chatCompletionToolCalls"],[183,29,186,27],[183,31,186,29],[183,32,186,30],[183,33,186,31],[184,6,187,4,"responsesApiToolCalls"],[184,27,187,25],[184,29,187,27],[185,4,188,2],[185,5,188,3],[186,4,190,2],[186,8,190,6],[187,6,191,4],[187,17,191,15],[187,23,191,21,"event"],[187,28,191,26],[187,32,191,30,"stream"],[187,38,191,36],[187,40,191,38],[188,8,192,6],[188,12,192,10],[188,16,192,10,"isChatCompletionChunk"],[188,24,192,31],[188,25,192,31,"isChatCompletionChunk"],[188,46,192,31],[188,48,192,32,"event"],[188,53,192,37],[188,54,192,38],[188,56,192,40],[189,10,193,8,"processChatCompletionChunk"],[189,36,193,34],[189,37,193,35,"event"],[189,42,193,40],[189,44,193,43,"state"],[189,49,193,48],[189,51,193,50,"recordOutputs"],[189,64,193,63],[189,65,193,64],[190,8,194,6],[190,9,194,7],[190,15,194,13],[190,19,194,17],[190,23,194,17,"isResponsesApiStreamEvent"],[190,31,194,42],[190,32,194,42,"isResponsesApiStreamEvent"],[190,57,194,42],[190,59,194,43,"event"],[190,64,194,48],[190,65,194,49],[190,67,194,51],[191,10,195,8,"processResponsesApiEvent"],[191,34,195,32],[191,35,195,33,"event"],[191,40,195,38],[191,42,195,41,"state"],[191,47,195,46],[191,49,195,48,"recordOutputs"],[191,62,195,61],[191,64,195,63,"span"],[191,68,195,67],[191,69,195,68],[192,8,196,6],[193,8,197,6],[193,14,197,12,"event"],[193,19,197,17],[194,6,198,4],[195,4,199,2],[195,5,199,3],[195,14,199,12],[196,6,200,4],[196,10,200,4,"setCommonResponseAttributes"],[196,18,200,31],[196,19,200,31,"setCommonResponseAttributes"],[196,46,200,31],[196,48,200,32,"span"],[196,52,200,36],[196,54,200,38,"state"],[196,59,200,43],[196,60,200,44,"responseId"],[196,70,200,54],[196,72,200,56,"state"],[196,77,200,61],[196,78,200,62,"responseModel"],[196,91,200,75],[196,93,200,77,"state"],[196,98,200,82],[196,99,200,83,"responseTimestamp"],[196,116,200,100],[196,117,200,101],[197,6,201,4],[197,10,201,4,"setTokenUsageAttributes"],[197,18,201,27],[197,19,201,27,"setTokenUsageAttributes"],[197,42,201,27],[197,44,201,28,"span"],[197,48,201,32],[197,50,201,34,"state"],[197,55,201,39],[197,56,201,40,"promptTokens"],[197,68,201,52],[197,70,201,54,"state"],[197,75,201,59],[197,76,201,60,"completionTokens"],[197,92,201,76],[197,94,201,78,"state"],[197,99,201,83],[197,100,201,84,"totalTokens"],[197,111,201,95],[197,112,201,96],[198,6,203,4,"span"],[198,10,203,8],[198,11,203,9,"setAttributes"],[198,24,203,22],[198,25,203,23],[199,8,204,6],[199,9,204,7,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[199,29,204,42],[199,30,204,42,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[199,65,204,42],[199,68,204,45],[200,6,205,4],[200,7,205,5],[200,8,205,6],[201,6,207,4],[201,10,207,8,"state"],[201,15,207,13],[201,16,207,14,"finishReasons"],[201,29,207,27],[201,30,207,28,"length"],[201,36,207,34],[201,38,207,36],[202,8,208,6,"span"],[202,12,208,10],[202,13,208,11,"setAttributes"],[202,26,208,24],[202,27,208,25],[203,10,209,8],[203,11,209,9,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[203,31,209,49],[203,32,209,49,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[203,72,209,49],[203,75,209,52,"JSON"],[203,79,209,56],[203,80,209,57,"stringify"],[203,89,209,66],[203,90,209,67,"state"],[203,95,209,72],[203,96,209,73,"finishReasons"],[203,109,209,86],[204,8,210,6],[204,9,210,7],[204,10,210,8],[205,6,211,4],[206,6,213,4],[206,10,213,8,"recordOutputs"],[206,23,213,21],[206,27,213,25,"state"],[206,32,213,30],[206,33,213,31,"responseTexts"],[206,46,213,44],[206,47,213,45,"length"],[206,53,213,51],[206,55,213,53],[207,8,214,6,"span"],[207,12,214,10],[207,13,214,11,"setAttributes"],[207,26,214,24],[207,27,214,25],[208,10,215,8],[208,11,215,9,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[208,31,215,39],[208,32,215,39,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[208,62,215,39],[208,65,215,42,"state"],[208,70,215,47],[208,71,215,48,"responseTexts"],[208,84,215,61],[208,85,215,62,"join"],[208,89,215,66],[208,90,215,67],[208,92,215,69],[209,8,216,6],[209,9,216,7],[209,10,216,8],[210,6,217,4],[212,6,219,4],[213,6,220,4],[213,12,220,10,"chatCompletionToolCallsArray"],[213,40,220,38],[213,43,220,41,"Object"],[213,49,220,47],[213,50,220,48,"values"],[213,56,220,54],[213,57,220,55,"state"],[213,62,220,60],[213,63,220,61,"chatCompletionToolCalls"],[213,86,220,84],[213,87,220,85],[214,6,221,4],[214,12,221,10,"allToolCalls"],[214,24,221,22],[214,27,221,25],[214,28,221,26],[214,31,221,29,"chatCompletionToolCallsArray"],[214,59,221,57],[214,61,221,59],[214,64,221,62,"state"],[214,69,221,67],[214,70,221,68,"responsesApiToolCalls"],[214,91,221,89],[214,92,221,90],[215,6,223,4],[215,10,223,8,"allToolCalls"],[215,22,223,20],[215,23,223,21,"length"],[215,29,223,27],[215,32,223,30],[215,33,223,31],[215,35,223,33],[216,8,224,6,"span"],[216,12,224,10],[216,13,224,11,"setAttributes"],[216,26,224,24],[216,27,224,25],[217,10,225,8],[217,11,225,9,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[217,31,225,45],[217,32,225,45,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[217,68,225,45],[217,71,225,48,"JSON"],[217,75,225,52],[217,76,225,53,"stringify"],[217,85,225,62],[217,86,225,63,"allToolCalls"],[217,98,225,75],[218,8,226,6],[218,9,226,7],[218,10,226,8],[219,6,227,4],[220,6,229,4,"span"],[220,10,229,8],[220,11,229,9,"end"],[220,14,229,12],[220,15,229,13],[220,16,229,14],[221,4,230,2],[222,2,231,0],[223,0,231,1],[223,3]],"functionMap":{"names":["<global>","processChatCompletionToolCalls","processChatCompletionChunk","processResponsesApiEvent","instrumentStream"],"mappings":"AAA;ACmB;CDsB;AES;CF+B;AGU;CHmE;AIY;CJ4D"},"hasCjsExports":false},"type":"js/module"}]}