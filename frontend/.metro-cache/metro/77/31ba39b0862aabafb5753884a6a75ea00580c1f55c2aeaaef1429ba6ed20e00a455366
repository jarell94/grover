{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":99,"index":99}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":100},"end":{"line":2,"column":37,"index":137}}],"key":"8cLkkKYebhz8179+ortY3/pylDg=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"addHistoryInstrumentationHandler\", {\n    enumerable: true,\n    get: function () {\n      return addHistoryInstrumentationHandler;\n    }\n  });\n  Object.defineProperty(exports, \"instrumentHistory\", {\n    enumerable: true,\n    get: function () {\n      return instrumentHistory;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  var _typesJs = require(_dependencyMap[1], \"../types.js\");\n  let lastHref;\n\n  /**\n   * Add an instrumentation handler for when a fetch request happens.\n   * The handler function is called once when the request starts and once when it ends,\n   * which can be identified by checking if it has an `endTimestamp`.\n   *\n   * Use at your own risk, this might break without changelog notice, only used internally.\n   * @hidden\n   */\n  function addHistoryInstrumentationHandler(handler) {\n    const type = 'history';\n    (0, _sentryCore.addHandler)(type, handler);\n    (0, _sentryCore.maybeInstrument)(type, instrumentHistory);\n  }\n\n  /**\n   * Exported just for testing\n   */\n  function instrumentHistory() {\n    // The `popstate` event may also be triggered on `pushState`, but it may not always reliably be emitted by the browser\n    // Which is why we also monkey-patch methods below, in addition to this\n    _typesJs.WINDOW.addEventListener('popstate', () => {\n      const to = _typesJs.WINDOW.location.href;\n      // keep track of the current URL state, as we always receive only the updated state\n      const from = lastHref;\n      lastHref = to;\n      if (from === to) {\n        return;\n      }\n      const handlerData = {\n        from,\n        to\n      };\n      (0, _sentryCore.triggerHandlers)('history', handlerData);\n    });\n\n    // Just guard against this not being available, in weird environments\n    if (!(0, _sentryCore.supportsHistory)()) {\n      return;\n    }\n    function historyReplacementFunction(originalHistoryFunction) {\n      return function (...args) {\n        const url = args.length > 2 ? args[2] : undefined;\n        if (url) {\n          const from = lastHref;\n\n          // Ensure the URL is absolute\n          // this can be either a path, then it is relative to the current origin\n          // or a full URL of the current origin - other origins are not allowed\n          // See: https://developer.mozilla.org/en-US/docs/Web/API/History/pushState#url\n          // coerce to string (this is what pushState does)\n          const to = getAbsoluteUrl(String(url));\n\n          // keep track of the current URL state, as we always receive only the updated state\n          lastHref = to;\n          if (from === to) {\n            return originalHistoryFunction.apply(this, args);\n          }\n          const handlerData = {\n            from,\n            to\n          };\n          (0, _sentryCore.triggerHandlers)('history', handlerData);\n        }\n        return originalHistoryFunction.apply(this, args);\n      };\n    }\n    (0, _sentryCore.fill)(_typesJs.WINDOW.history, 'pushState', historyReplacementFunction);\n    (0, _sentryCore.fill)(_typesJs.WINDOW.history, 'replaceState', historyReplacementFunction);\n  }\n  function getAbsoluteUrl(urlOrPath) {\n    try {\n      const url = new URL(urlOrPath, _typesJs.WINDOW.location.origin);\n      return url.toString();\n    } catch {\n      // fallback, just do nothing\n      return urlOrPath;\n    }\n  }\n});","lineCount":101,"map":[[7,2,86,0,"Object"],[7,8,86,0],[7,9,86,0,"defineProperty"],[7,23,86,0],[7,24,86,0,"exports"],[7,31,86,0],[8,4,86,0,"enumerable"],[8,14,86,0],[9,4,86,0,"get"],[9,7,86,0],[9,18,86,0,"get"],[9,19,86,0],[10,6,86,0],[10,13,86,9,"addHistoryInstrumentationHandler"],[10,45,86,41],[11,4,86,41],[12,2,86,41],[13,2,86,0,"Object"],[13,8,86,0],[13,9,86,0,"defineProperty"],[13,23,86,0],[13,24,86,0,"exports"],[13,31,86,0],[14,4,86,0,"enumerable"],[14,14,86,0],[15,4,86,0,"get"],[15,7,86,0],[15,18,86,0,"get"],[15,19,86,0],[16,6,86,0],[16,13,86,43,"instrumentHistory"],[16,30,86,60],[17,4,86,60],[18,2,86,60],[19,2,1,0],[19,6,1,0,"_sentryCore"],[19,17,1,0],[19,20,1,0,"require"],[19,27,1,0],[19,28,1,0,"_dependencyMap"],[19,42,1,0],[20,2,2,0],[20,6,2,0,"_typesJs"],[20,14,2,0],[20,17,2,0,"require"],[20,24,2,0],[20,25,2,0,"_dependencyMap"],[20,39,2,0],[21,2,4,0],[21,6,4,4,"lastHref"],[21,14,4,12],[23,2,6,0],[24,0,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,2,14,0],[31,11,14,9,"addHistoryInstrumentationHandler"],[31,43,14,41,"addHistoryInstrumentationHandler"],[31,44,14,42,"handler"],[31,51,14,49],[31,53,14,51],[32,4,15,2],[32,10,15,8,"type"],[32,14,15,12],[32,17,15,15],[32,26,15,24],[33,4,16,2],[33,8,16,2,"addHandler"],[33,19,16,12],[33,20,16,12,"addHandler"],[33,30,16,12],[33,32,16,13,"type"],[33,36,16,17],[33,38,16,19,"handler"],[33,45,16,26],[33,46,16,27],[34,4,17,2],[34,8,17,2,"maybeInstrument"],[34,19,17,17],[34,20,17,17,"maybeInstrument"],[34,35,17,17],[34,37,17,18,"type"],[34,41,17,22],[34,43,17,24,"instrumentHistory"],[34,60,17,41],[34,61,17,42],[35,2,18,0],[37,2,20,0],[38,0,21,0],[39,0,22,0],[40,2,23,0],[40,11,23,9,"instrumentHistory"],[40,28,23,26,"instrumentHistory"],[40,29,23,26],[40,31,23,29],[41,4,24,2],[42,4,25,2],[43,4,26,2,"WINDOW"],[43,12,26,8],[43,13,26,8,"WINDOW"],[43,19,26,8],[43,20,26,9,"addEventListener"],[43,36,26,25],[43,37,26,26],[43,47,26,36],[43,49,26,38],[43,55,26,44],[44,6,27,4],[44,12,27,10,"to"],[44,14,27,12],[44,17,27,15,"WINDOW"],[44,25,27,21],[44,26,27,21,"WINDOW"],[44,32,27,21],[44,33,27,22,"location"],[44,41,27,30],[44,42,27,31,"href"],[44,46,27,35],[45,6,28,4],[46,6,29,4],[46,12,29,10,"from"],[46,16,29,14],[46,19,29,17,"lastHref"],[46,27,29,25],[47,6,30,4,"lastHref"],[47,14,30,12],[47,17,30,15,"to"],[47,19,30,17],[48,6,32,4],[48,10,32,8,"from"],[48,14,32,12],[48,19,32,17,"to"],[48,21,32,19],[48,23,32,21],[49,8,33,6],[50,6,34,4],[51,6,36,4],[51,12,36,10,"handlerData"],[51,23,36,21],[51,26,36,24],[52,8,36,26,"from"],[52,12,36,30],[53,8,36,32,"to"],[54,6,36,35],[54,7,36,36],[55,6,37,4],[55,10,37,4,"triggerHandlers"],[55,21,37,19],[55,22,37,19,"triggerHandlers"],[55,37,37,19],[55,39,37,20],[55,48,37,29],[55,50,37,31,"handlerData"],[55,61,37,42],[55,62,37,43],[56,4,38,2],[56,5,38,3],[56,6,38,4],[58,4,40,2],[59,4,41,2],[59,8,41,6],[59,9,41,7],[59,13,41,7,"supportsHistory"],[59,24,41,22],[59,25,41,22,"supportsHistory"],[59,40,41,22],[59,42,41,23],[59,43,41,24],[59,45,41,26],[60,6,42,4],[61,4,43,2],[62,4,45,2],[62,13,45,11,"historyReplacementFunction"],[62,39,45,37,"historyReplacementFunction"],[62,40,45,38,"originalHistoryFunction"],[62,63,45,61],[62,65,45,63],[63,6,46,4],[63,13,46,11],[63,23,46,22],[63,26,46,25,"args"],[63,30,46,29],[63,32,46,31],[64,8,47,6],[64,14,47,12,"url"],[64,17,47,15],[64,20,47,18,"args"],[64,24,47,22],[64,25,47,23,"length"],[64,31,47,29],[64,34,47,32],[64,35,47,33],[64,38,47,36,"args"],[64,42,47,40],[64,43,47,41],[64,44,47,42],[64,45,47,43],[64,48,47,46,"undefined"],[64,57,47,55],[65,8,48,6],[65,12,48,10,"url"],[65,15,48,13],[65,17,48,15],[66,10,49,8],[66,16,49,14,"from"],[66,20,49,18],[66,23,49,21,"lastHref"],[66,31,49,29],[68,10,51,8],[69,10,52,8],[70,10,53,8],[71,10,54,8],[72,10,55,8],[73,10,56,8],[73,16,56,14,"to"],[73,18,56,16],[73,21,56,19,"getAbsoluteUrl"],[73,35,56,33],[73,36,56,34,"String"],[73,42,56,40],[73,43,56,41,"url"],[73,46,56,44],[73,47,56,45],[73,48,56,46],[75,10,58,8],[76,10,59,8,"lastHref"],[76,18,59,16],[76,21,59,19,"to"],[76,23,59,21],[77,10,61,8],[77,14,61,12,"from"],[77,18,61,16],[77,23,61,21,"to"],[77,25,61,23],[77,27,61,25],[78,12,62,10],[78,19,62,17,"originalHistoryFunction"],[78,42,62,40],[78,43,62,41,"apply"],[78,48,62,46],[78,49,62,47],[78,53,62,51],[78,55,62,53,"args"],[78,59,62,57],[78,60,62,58],[79,10,63,8],[80,10,65,8],[80,16,65,14,"handlerData"],[80,27,65,25],[80,30,65,28],[81,12,65,30,"from"],[81,16,65,34],[82,12,65,36,"to"],[83,10,65,39],[83,11,65,40],[84,10,66,8],[84,14,66,8,"triggerHandlers"],[84,25,66,23],[84,26,66,23,"triggerHandlers"],[84,41,66,23],[84,43,66,24],[84,52,66,33],[84,54,66,35,"handlerData"],[84,65,66,46],[84,66,66,47],[85,8,67,6],[86,8,68,6],[86,15,68,13,"originalHistoryFunction"],[86,38,68,36],[86,39,68,37,"apply"],[86,44,68,42],[86,45,68,43],[86,49,68,47],[86,51,68,49,"args"],[86,55,68,53],[86,56,68,54],[87,6,69,4],[87,7,69,5],[88,4,70,2],[89,4,72,2],[89,8,72,2,"fill"],[89,19,72,6],[89,20,72,6,"fill"],[89,24,72,6],[89,26,72,7,"WINDOW"],[89,34,72,13],[89,35,72,13,"WINDOW"],[89,41,72,13],[89,42,72,14,"history"],[89,49,72,21],[89,51,72,23],[89,62,72,34],[89,64,72,36,"historyReplacementFunction"],[89,90,72,62],[89,91,72,63],[90,4,73,2],[90,8,73,2,"fill"],[90,19,73,6],[90,20,73,6,"fill"],[90,24,73,6],[90,26,73,7,"WINDOW"],[90,34,73,13],[90,35,73,13,"WINDOW"],[90,41,73,13],[90,42,73,14,"history"],[90,49,73,21],[90,51,73,23],[90,65,73,37],[90,67,73,39,"historyReplacementFunction"],[90,93,73,65],[90,94,73,66],[91,2,74,0],[92,2,76,0],[92,11,76,9,"getAbsoluteUrl"],[92,25,76,23,"getAbsoluteUrl"],[92,26,76,24,"urlOrPath"],[92,35,76,33],[92,37,76,35],[93,4,77,2],[93,8,77,6],[94,6,78,4],[94,12,78,10,"url"],[94,15,78,13],[94,18,78,16],[94,22,78,20,"URL"],[94,25,78,23],[94,26,78,24,"urlOrPath"],[94,35,78,33],[94,37,78,35,"WINDOW"],[94,45,78,41],[94,46,78,41,"WINDOW"],[94,52,78,41],[94,53,78,42,"location"],[94,61,78,50],[94,62,78,51,"origin"],[94,68,78,57],[94,69,78,58],[95,6,79,4],[95,13,79,11,"url"],[95,16,79,14],[95,17,79,15,"toString"],[95,25,79,23],[95,26,79,24],[95,27,79,25],[96,4,80,2],[96,5,80,3],[96,6,80,4],[96,12,80,10],[97,6,81,4],[98,6,82,4],[98,13,82,11,"urlOrPath"],[98,22,82,20],[99,4,83,2],[100,2,84,0],[101,0,84,1],[101,3]],"functionMap":{"names":["<global>","addHistoryInstrumentationHandler","instrumentHistory","WINDOW.addEventListener$argument_1","historyReplacementFunction","<anonymous>","getAbsoluteUrl"],"mappings":"AAA;ACa;CDI;AEK;sCCG;GDY;EEO;WCC;KDuB;GFC;CFI;AME;CNQ"},"hasCjsExports":false},"type":"js/module"}]}