{"dependencies":[{"name":"../integration.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"B8aKvpmafw58aWtupuC7GWTMiwo=","exportNames":["*"],"imports":1}},{"name":"../utils/cookie.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":49,"index":104}}],"key":"YThdOGzUvaRB6jb/6qXn3WTUc5o=","exportNames":["*"],"imports":1}},{"name":"../vendor/getIpAddress.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":105},"end":{"line":3,"column":78,"index":183}}],"key":"0oKNyq51031kf5wc4IhuDX1sUmA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"requestDataIntegration\", {\n    enumerable: true,\n    get: function () {\n      return requestDataIntegration;\n    }\n  });\n  var _integrationJs = require(_dependencyMap[0], \"../integration.js\");\n  var _utilsCookieJs = require(_dependencyMap[1], \"../utils/cookie.js\");\n  var _vendorGetIpAddressJs = require(_dependencyMap[2], \"../vendor/getIpAddress.js\");\n  // TODO(v11): Change defaults based on `sendDefaultPii`\n  const DEFAULT_INCLUDE = {\n    cookies: true,\n    data: true,\n    headers: true,\n    query_string: true,\n    url: true\n  };\n  const INTEGRATION_NAME = 'RequestData';\n  const _requestDataIntegration = (options = {}) => {\n    const include = {\n      ...DEFAULT_INCLUDE,\n      ...options.include\n    };\n    return {\n      name: INTEGRATION_NAME,\n      processEvent(event, _hint, client) {\n        const {\n          sdkProcessingMetadata = {}\n        } = event;\n        const {\n          normalizedRequest,\n          ipAddress\n        } = sdkProcessingMetadata;\n        const includeWithDefaultPiiApplied = {\n          ...include,\n          ip: include.ip ?? client.getOptions().sendDefaultPii\n        };\n        if (normalizedRequest) {\n          addNormalizedRequestDataToEvent(event, normalizedRequest, {\n            ipAddress\n          }, includeWithDefaultPiiApplied);\n        }\n        return event;\n      }\n    };\n  };\n\n  /**\n   * Add data about a request to an event. Primarily for use in Node-based SDKs, but included in `@sentry/core`\n   * so it can be used in cross-platform SDKs like `@sentry/nextjs`.\n   */\n  const requestDataIntegration = (0, _integrationJs.defineIntegration)(_requestDataIntegration);\n\n  /**\n   * Add already normalized request data to an event.\n   * This mutates the passed in event.\n   */\n  function addNormalizedRequestDataToEvent(event, req,\n  // Data that should not go into `event.request` but is somehow related to requests\n  additionalData, include) {\n    event.request = {\n      ...event.request,\n      ...extractNormalizedRequestData(req, include)\n    };\n    if (include.ip) {\n      const ip = req.headers && (0, _vendorGetIpAddressJs.getClientIPAddress)(req.headers) || additionalData.ipAddress;\n      if (ip) {\n        event.user = {\n          ...event.user,\n          ip_address: ip\n        };\n      }\n    }\n  }\n  function extractNormalizedRequestData(normalizedRequest, include) {\n    const requestData = {};\n    const headers = {\n      ...normalizedRequest.headers\n    };\n    if (include.headers) {\n      requestData.headers = headers;\n\n      // Remove the Cookie header in case cookie data should not be included in the event\n      if (!include.cookies) {\n        delete headers.cookie;\n      }\n\n      // Remove IP headers in case IP data should not be included in the event\n      if (!include.ip) {\n        _vendorGetIpAddressJs.ipHeaderNames.forEach(ipHeaderName => {\n          // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n          delete headers[ipHeaderName];\n        });\n      }\n    }\n    requestData.method = normalizedRequest.method;\n    if (include.url) {\n      requestData.url = normalizedRequest.url;\n    }\n    if (include.cookies) {\n      const cookies = normalizedRequest.cookies || (headers?.cookie ? (0, _utilsCookieJs.parseCookie)(headers.cookie) : undefined);\n      requestData.cookies = cookies || {};\n    }\n    if (include.query_string) {\n      requestData.query_string = normalizedRequest.query_string;\n    }\n    if (include.data) {\n      requestData.data = normalizedRequest.data;\n    }\n    return requestData;\n  }\n});","lineCount":118,"map":[[7,2,121,0,"Object"],[7,8,121,0],[7,9,121,0,"defineProperty"],[7,23,121,0],[7,24,121,0,"exports"],[7,31,121,0],[8,4,121,0,"enumerable"],[8,14,121,0],[9,4,121,0,"get"],[9,7,121,0],[9,18,121,0,"get"],[9,19,121,0],[10,6,121,0],[10,13,121,9,"requestDataIntegration"],[10,35,121,31],[11,4,121,31],[12,2,121,31],[13,2,1,0],[13,6,1,0,"_integrationJs"],[13,20,1,0],[13,23,1,0,"require"],[13,30,1,0],[13,31,1,0,"_dependencyMap"],[13,45,1,0],[14,2,2,0],[14,6,2,0,"_utilsCookieJs"],[14,20,2,0],[14,23,2,0,"require"],[14,30,2,0],[14,31,2,0,"_dependencyMap"],[14,45,2,0],[15,2,3,0],[15,6,3,0,"_vendorGetIpAddressJs"],[15,27,3,0],[15,30,3,0,"require"],[15,37,3,0],[15,38,3,0,"_dependencyMap"],[15,52,3,0],[16,2,5,0],[17,2,6,0],[17,8,6,6,"DEFAULT_INCLUDE"],[17,23,6,21],[17,26,6,24],[18,4,7,2,"cookies"],[18,11,7,9],[18,13,7,11],[18,17,7,15],[19,4,8,2,"data"],[19,8,8,6],[19,10,8,8],[19,14,8,12],[20,4,9,2,"headers"],[20,11,9,9],[20,13,9,11],[20,17,9,15],[21,4,10,2,"query_string"],[21,16,10,14],[21,18,10,16],[21,22,10,20],[22,4,11,2,"url"],[22,7,11,5],[22,9,11,7],[23,2,12,0],[23,3,12,1],[24,2,14,0],[24,8,14,6,"INTEGRATION_NAME"],[24,24,14,22],[24,27,14,25],[24,40,14,38],[25,2,16,0],[25,8,16,6,"_requestDataIntegration"],[25,31,16,29],[25,34,16,33,"_requestDataIntegration"],[25,35,16,34,"options"],[25,42,16,41],[25,45,16,44],[25,46,16,45],[25,47,16,46],[25,52,16,51],[26,4,17,2],[26,10,17,8,"include"],[26,17,17,15],[26,20,17,18],[27,6,18,4],[27,9,18,7,"DEFAULT_INCLUDE"],[27,24,18,22],[28,6,19,4],[28,9,19,7,"options"],[28,16,19,14],[28,17,19,15,"include"],[29,4,20,2],[29,5,20,3],[30,4,22,2],[30,11,22,9],[31,6,23,4,"name"],[31,10,23,8],[31,12,23,10,"INTEGRATION_NAME"],[31,28,23,26],[32,6,24,4,"processEvent"],[32,18,24,16,"processEvent"],[32,19,24,17,"event"],[32,24,24,22],[32,26,24,24,"_hint"],[32,31,24,29],[32,33,24,31,"client"],[32,39,24,37],[32,41,24,39],[33,8,25,6],[33,14,25,12],[34,10,25,14,"sdkProcessingMetadata"],[34,31,25,35],[34,34,25,38],[34,35,25,39],[35,8,25,41],[35,9,25,42],[35,12,25,45,"event"],[35,17,25,50],[36,8,26,6],[36,14,26,12],[37,10,26,14,"normalizedRequest"],[37,27,26,31],[38,10,26,33,"ipAddress"],[39,8,26,43],[39,9,26,44],[39,12,26,47,"sdkProcessingMetadata"],[39,33,26,68],[40,8,28,6],[40,14,28,12,"includeWithDefaultPiiApplied"],[40,42,28,40],[40,45,28,43],[41,10,29,8],[41,13,29,11,"include"],[41,20,29,18],[42,10,30,8,"ip"],[42,12,30,10],[42,14,30,12,"include"],[42,21,30,19],[42,22,30,20,"ip"],[42,24,30,22],[42,28,30,26,"client"],[42,34,30,32],[42,35,30,33,"getOptions"],[42,45,30,43],[42,46,30,44],[42,47,30,45],[42,48,30,46,"sendDefaultPii"],[43,8,31,6],[43,9,31,7],[44,8,33,6],[44,12,33,10,"normalizedRequest"],[44,29,33,27],[44,31,33,29],[45,10,34,8,"addNormalizedRequestDataToEvent"],[45,41,34,39],[45,42,34,40,"event"],[45,47,34,45],[45,49,34,47,"normalizedRequest"],[45,66,34,64],[45,68,34,66],[46,12,34,68,"ipAddress"],[47,10,34,78],[47,11,34,79],[47,13,34,81,"includeWithDefaultPiiApplied"],[47,41,34,109],[47,42,34,110],[48,8,35,6],[49,8,37,6],[49,15,37,13,"event"],[49,20,37,18],[50,6,38,4],[51,4,39,2],[51,5,39,3],[52,2,40,0],[52,3,40,2],[54,2,42,0],[55,0,43,0],[56,0,44,0],[57,0,45,0],[58,2,46,0],[58,8,46,6,"requestDataIntegration"],[58,30,46,28],[58,33,46,31],[58,37,46,31,"defineIntegration"],[58,51,46,48],[58,52,46,48,"defineIntegration"],[58,69,46,48],[58,71,46,49,"_requestDataIntegration"],[58,94,46,72],[58,95,46,73],[60,2,48,0],[61,0,49,0],[62,0,50,0],[63,0,51,0],[64,2,52,0],[64,11,52,9,"addNormalizedRequestDataToEvent"],[64,42,52,40,"addNormalizedRequestDataToEvent"],[64,43,53,2,"event"],[64,48,53,7],[64,50,54,2,"req"],[64,53,54,5],[65,2,55,2],[66,2,56,2,"additionalData"],[66,16,56,16],[66,18,57,2,"include"],[66,25,57,9],[66,27,58,2],[67,4,59,2,"event"],[67,9,59,7],[67,10,59,8,"request"],[67,17,59,15],[67,20,59,18],[68,6,60,4],[68,9,60,7,"event"],[68,14,60,12],[68,15,60,13,"request"],[68,22,60,20],[69,6,61,4],[69,9,61,7,"extractNormalizedRequestData"],[69,37,61,35],[69,38,61,36,"req"],[69,41,61,39],[69,43,61,41,"include"],[69,50,61,48],[70,4,62,2],[70,5,62,3],[71,4,64,2],[71,8,64,6,"include"],[71,15,64,13],[71,16,64,14,"ip"],[71,18,64,16],[71,20,64,18],[72,6,65,4],[72,12,65,10,"ip"],[72,14,65,12],[72,17,65,16,"req"],[72,20,65,19],[72,21,65,20,"headers"],[72,28,65,27],[72,32,65,31],[72,36,65,31,"getClientIPAddress"],[72,57,65,49],[72,58,65,49,"getClientIPAddress"],[72,76,65,49],[72,78,65,50,"req"],[72,81,65,53],[72,82,65,54,"headers"],[72,89,65,61],[72,90,65,62],[72,94,65,67,"additionalData"],[72,108,65,81],[72,109,65,82,"ipAddress"],[72,118,65,91],[73,6,66,4],[73,10,66,8,"ip"],[73,12,66,10],[73,14,66,12],[74,8,67,6,"event"],[74,13,67,11],[74,14,67,12,"user"],[74,18,67,16],[74,21,67,19],[75,10,68,8],[75,13,68,11,"event"],[75,18,68,16],[75,19,68,17,"user"],[75,23,68,21],[76,10,69,8,"ip_address"],[76,20,69,18],[76,22,69,20,"ip"],[77,8,70,6],[77,9,70,7],[78,6,71,4],[79,4,72,2],[80,2,73,0],[81,2,75,0],[81,11,75,9,"extractNormalizedRequestData"],[81,39,75,37,"extractNormalizedRequestData"],[81,40,76,2,"normalizedRequest"],[81,57,76,19],[81,59,77,2,"include"],[81,66,77,9],[81,68,78,2],[82,4,79,2],[82,10,79,8,"requestData"],[82,21,79,19],[82,24,79,22],[82,25,79,23],[82,26,79,24],[83,4,80,2],[83,10,80,8,"headers"],[83,17,80,15],[83,20,80,18],[84,6,80,20],[84,9,80,23,"normalizedRequest"],[84,26,80,40],[84,27,80,41,"headers"],[85,4,80,49],[85,5,80,50],[86,4,82,2],[86,8,82,6,"include"],[86,15,82,13],[86,16,82,14,"headers"],[86,23,82,21],[86,25,82,23],[87,6,83,4,"requestData"],[87,17,83,15],[87,18,83,16,"headers"],[87,25,83,23],[87,28,83,26,"headers"],[87,35,83,33],[89,6,85,4],[90,6,86,4],[90,10,86,8],[90,11,86,9,"include"],[90,18,86,16],[90,19,86,17,"cookies"],[90,26,86,24],[90,28,86,26],[91,8,87,6],[91,15,87,14,"headers"],[91,22,87,21],[91,23,87,24,"cookie"],[91,29,87,30],[92,6,88,4],[94,6,90,4],[95,6,91,4],[95,10,91,8],[95,11,91,9,"include"],[95,18,91,16],[95,19,91,17,"ip"],[95,21,91,19],[95,23,91,21],[96,8,92,6,"ipHeaderNames"],[96,29,92,19],[96,30,92,19,"ipHeaderNames"],[96,43,92,19],[96,44,92,20,"forEach"],[96,51,92,27],[96,52,92,28,"ipHeaderName"],[96,64,92,40],[96,68,92,44],[97,10,93,8],[98,10,94,8],[98,17,94,16,"headers"],[98,24,94,23],[98,25,94,26,"ipHeaderName"],[98,37,94,38],[98,38,94,39],[99,8,95,6],[99,9,95,7],[99,10,95,8],[100,6,96,4],[101,4,97,2],[102,4,99,2,"requestData"],[102,15,99,13],[102,16,99,14,"method"],[102,22,99,20],[102,25,99,23,"normalizedRequest"],[102,42,99,40],[102,43,99,41,"method"],[102,49,99,47],[103,4,101,2],[103,8,101,6,"include"],[103,15,101,13],[103,16,101,14,"url"],[103,19,101,17],[103,21,101,19],[104,6,102,4,"requestData"],[104,17,102,15],[104,18,102,16,"url"],[104,21,102,19],[104,24,102,22,"normalizedRequest"],[104,41,102,39],[104,42,102,40,"url"],[104,45,102,43],[105,4,103,2],[106,4,105,2],[106,8,105,6,"include"],[106,15,105,13],[106,16,105,14,"cookies"],[106,23,105,21],[106,25,105,23],[107,6,106,4],[107,12,106,10,"cookies"],[107,19,106,17],[107,22,106,20,"normalizedRequest"],[107,39,106,37],[107,40,106,38,"cookies"],[107,47,106,45],[107,52,106,50,"headers"],[107,59,106,57],[107,61,106,59,"cookie"],[107,67,106,65],[107,70,106,68],[107,74,106,68,"parseCookie"],[107,88,106,79],[107,89,106,79,"parseCookie"],[107,100,106,79],[107,102,106,80,"headers"],[107,109,106,87],[107,110,106,88,"cookie"],[107,116,106,94],[107,117,106,95],[107,120,106,98,"undefined"],[107,129,106,107],[107,130,106,108],[108,6,107,4,"requestData"],[108,17,107,15],[108,18,107,16,"cookies"],[108,25,107,23],[108,28,107,26,"cookies"],[108,35,107,33],[108,39,107,37],[108,40,107,38],[108,41,107,39],[109,4,108,2],[110,4,110,2],[110,8,110,6,"include"],[110,15,110,13],[110,16,110,14,"query_string"],[110,28,110,26],[110,30,110,28],[111,6,111,4,"requestData"],[111,17,111,15],[111,18,111,16,"query_string"],[111,30,111,28],[111,33,111,31,"normalizedRequest"],[111,50,111,48],[111,51,111,49,"query_string"],[111,63,111,61],[112,4,112,2],[113,4,114,2],[113,8,114,6,"include"],[113,15,114,13],[113,16,114,14,"data"],[113,20,114,18],[113,22,114,20],[114,6,115,4,"requestData"],[114,17,115,15],[114,18,115,16,"data"],[114,22,115,20],[114,25,115,23,"normalizedRequest"],[114,42,115,40],[114,43,115,41,"data"],[114,47,115,45],[115,4,116,2],[116,4,118,2],[116,11,118,9,"requestData"],[116,22,118,20],[117,2,119,0],[118,0,119,1],[118,3]],"functionMap":{"names":["<global>","_requestDataIntegration","processEvent","addNormalizedRequestDataToEvent","extractNormalizedRequestData","ipHeaderNames.forEach$argument_0"],"mappings":"AAA;iCCe;ICQ;KDc;CDE;AGY;CHqB;AIE;4BCiB;ODG;CJwB"},"hasCjsExports":false},"type":"js/module"}]}