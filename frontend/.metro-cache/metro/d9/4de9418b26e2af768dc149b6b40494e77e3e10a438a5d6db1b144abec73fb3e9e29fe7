{"dependencies":[{"name":"../../currentScopes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":51,"index":51}}],"key":"wyofRZtYR2H2+OElRwz4anlbKJw=","exportNames":["*"],"imports":1}},{"name":"../../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":52},"end":{"line":2,"column":52,"index":104}}],"key":"EZPmsHt7bn9JJ4Y0grXw/CrOow0=","exportNames":["*"],"imports":1}},{"name":"../../utils/spanUtils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":105},"end":{"line":3,"column":57,"index":162}}],"key":"jS5ervjTKuQx3M2+nlNDhSlP0iw=","exportNames":["*"],"imports":1}},{"name":"../../tracing/spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":163},"end":{"line":4,"column":64,"index":227}}],"key":"xTnLe4eZ8UwJZsOO8L+5TFoq+AE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"captureError\", {\n    enumerable: true,\n    get: function () {\n      return captureError;\n    }\n  });\n  var _currentScopesJs = require(_dependencyMap[0], \"../../currentScopes.js\");\n  var _exportsJs = require(_dependencyMap[1], \"../../exports.js\");\n  var _utilsSpanUtilsJs = require(_dependencyMap[2], \"../../utils/spanUtils.js\");\n  var _tracingSpanstatusJs = require(_dependencyMap[3], \"../../tracing/spanstatus.js\");\n  /**\n   * Safe error capture utilities for MCP server instrumentation\n   *\n   * Ensures error reporting never interferes with MCP server operation.\n   * All capture operations are wrapped in try-catch to prevent side effects.\n   */\n\n  /**\n   * Captures an error without affecting MCP server operation.\n   *\n   * The active span already contains all MCP context (method, tool, arguments, etc.)\n   * @param error - Error to capture\n   * @param errorType - Classification of error type for filtering\n   * @param extraData - Additional context data to include\n   */\n  function captureError(error, errorType, extraData) {\n    try {\n      const client = (0, _currentScopesJs.getClient)();\n      if (!client) {\n        return;\n      }\n      const activeSpan = (0, _utilsSpanUtilsJs.getActiveSpan)();\n      if (activeSpan?.isRecording()) {\n        activeSpan.setStatus({\n          code: _tracingSpanstatusJs.SPAN_STATUS_ERROR,\n          message: 'internal_error'\n        });\n      }\n      (0, _exportsJs.captureException)(error, {\n        mechanism: {\n          type: 'auto.ai.mcp_server',\n          handled: false,\n          data: Object.assign({\n            error_type: errorType || 'handler_execution'\n          }, extraData)\n        }\n      });\n    } catch {\n      // noop\n    }\n  }\n});","lineCount":58,"map":[[7,2,52,0,"Object"],[7,8,52,0],[7,9,52,0,"defineProperty"],[7,23,52,0],[7,24,52,0,"exports"],[7,31,52,0],[8,4,52,0,"enumerable"],[8,14,52,0],[9,4,52,0,"get"],[9,7,52,0],[9,18,52,0,"get"],[9,19,52,0],[10,6,52,0],[10,13,52,9,"captureError"],[10,25,52,21],[11,4,52,21],[12,2,52,21],[13,2,1,0],[13,6,1,0,"_currentScopesJs"],[13,22,1,0],[13,25,1,0,"require"],[13,32,1,0],[13,33,1,0,"_dependencyMap"],[13,47,1,0],[14,2,2,0],[14,6,2,0,"_exportsJs"],[14,16,2,0],[14,19,2,0,"require"],[14,26,2,0],[14,27,2,0,"_dependencyMap"],[14,41,2,0],[15,2,3,0],[15,6,3,0,"_utilsSpanUtilsJs"],[15,23,3,0],[15,26,3,0,"require"],[15,33,3,0],[15,34,3,0,"_dependencyMap"],[15,48,3,0],[16,2,4,0],[16,6,4,0,"_tracingSpanstatusJs"],[16,26,4,0],[16,29,4,0,"require"],[16,36,4,0],[16,37,4,0,"_dependencyMap"],[16,51,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[24,2,14,0],[25,0,15,0],[26,0,16,0],[27,0,17,0],[28,0,18,0],[29,0,19,0],[30,0,20,0],[31,0,21,0],[32,2,22,0],[32,11,22,9,"captureError"],[32,23,22,21,"captureError"],[32,24,22,22,"error"],[32,29,22,27],[32,31,22,29,"errorType"],[32,40,22,38],[32,42,22,40,"extraData"],[32,51,22,49],[32,53,22,51],[33,4,23,2],[33,8,23,6],[34,6,24,4],[34,12,24,10,"client"],[34,18,24,16],[34,21,24,19],[34,25,24,19,"getClient"],[34,41,24,28],[34,42,24,28,"getClient"],[34,51,24,28],[34,53,24,29],[34,54,24,30],[35,6,25,4],[35,10,25,8],[35,11,25,9,"client"],[35,17,25,15],[35,19,25,17],[36,8,26,6],[37,6,27,4],[38,6,29,4],[38,12,29,10,"activeSpan"],[38,22,29,20],[38,25,29,23],[38,29,29,23,"getActiveSpan"],[38,46,29,36],[38,47,29,36,"getActiveSpan"],[38,60,29,36],[38,62,29,37],[38,63,29,38],[39,6,30,4],[39,10,30,8,"activeSpan"],[39,20,30,18],[39,22,30,20,"isRecording"],[39,33,30,31],[39,34,30,32],[39,35,30,33],[39,37,30,35],[40,8,31,6,"activeSpan"],[40,18,31,16],[40,19,31,17,"setStatus"],[40,28,31,26],[40,29,31,27],[41,10,32,8,"code"],[41,14,32,12],[41,16,32,14,"SPAN_STATUS_ERROR"],[41,36,32,31],[41,37,32,31,"SPAN_STATUS_ERROR"],[41,54,32,31],[42,10,33,8,"message"],[42,17,33,15],[42,19,33,17],[43,8,34,6],[43,9,34,7],[43,10,34,8],[44,6,35,4],[45,6,37,4],[45,10,37,4,"captureException"],[45,20,37,20],[45,21,37,20,"captureException"],[45,37,37,20],[45,39,37,21,"error"],[45,44,37,26],[45,46,37,28],[46,8,38,6,"mechanism"],[46,17,38,15],[46,19,38,17],[47,10,39,8,"type"],[47,14,39,12],[47,16,39,14],[47,36,39,34],[48,10,40,8,"handled"],[48,17,40,15],[48,19,40,17],[48,24,40,22],[49,10,41,8,"data"],[49,14,41,12],[49,16,41,12,"Object"],[49,22,41,12],[49,23,41,12,"assign"],[49,29,41,12],[50,12,42,10,"error_type"],[50,22,42,20],[50,24,42,22,"errorType"],[50,33,42,31],[50,37,42,35],[51,10,42,54],[51,13,43,13,"extraData"],[51,22,43,22],[52,8,45,6],[53,6,46,4],[53,7,46,5],[53,8,46,6],[54,4,47,2],[54,5,47,3],[54,6,47,4],[54,12,47,10],[55,6,48,4],[56,4,48,4],[57,2,50,0],[58,0,50,1],[58,3]],"functionMap":{"names":["<global>","captureError"],"mappings":"AAA;ACqB;CD4B"},"hasCjsExports":false},"type":"js/module"}]}