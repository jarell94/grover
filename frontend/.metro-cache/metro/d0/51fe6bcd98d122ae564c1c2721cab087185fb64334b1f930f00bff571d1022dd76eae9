{"dependencies":[{"name":"../../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":40,"index":40}}],"key":"W1BH0a3HSCo8tOLXH7X+m5FGigs=","exportNames":["*"],"imports":1}},{"name":"./lib/bindReporter.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":41},"end":{"line":2,"column":53,"index":94}}],"key":"yZXTUsWh1M46DyxIbZ88NUHRymg=","exportNames":["*"],"imports":1}},{"name":"./lib/initMetric.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":95},"end":{"line":3,"column":49,"index":144}}],"key":"3h8m+kvAV2o3xN93IHHrmBqzs4s=","exportNames":["*"],"imports":1}},{"name":"./lib/initUnique.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":145},"end":{"line":4,"column":49,"index":194}}],"key":"hut8a99D/Gv1jGW5dfMa/Znpg4I=","exportNames":["*"],"imports":1}},{"name":"./lib/LayoutShiftManager.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":195},"end":{"line":5,"column":65,"index":260}}],"key":"NoAP3DDO8vMmiMFN3TGXUH1dQPA=","exportNames":["*"],"imports":1}},{"name":"./lib/observe.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":261},"end":{"line":6,"column":43,"index":304}}],"key":"Cz2RoRvLyGQyofIDJmcgFo6dicM=","exportNames":["*"],"imports":1}},{"name":"./lib/runOnce.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":305},"end":{"line":7,"column":43,"index":348}}],"key":"bwPHkAH8Ixo/Lbt+Aw9KJe855Jk=","exportNames":["*"],"imports":1}},{"name":"./onFCP.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":349},"end":{"line":8,"column":35,"index":384}}],"key":"9wYIWX7pl9yGISdpNXhM9vCUFQk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"CLSThresholds\", {\n    enumerable: true,\n    get: function () {\n      return CLSThresholds;\n    }\n  });\n  Object.defineProperty(exports, \"onCLS\", {\n    enumerable: true,\n    get: function () {\n      return onCLS;\n    }\n  });\n  var _typesJs = require(_dependencyMap[0], \"../../types.js\");\n  var _libBindReporterJs = require(_dependencyMap[1], \"./lib/bindReporter.js\");\n  var _libInitMetricJs = require(_dependencyMap[2], \"./lib/initMetric.js\");\n  var _libInitUniqueJs = require(_dependencyMap[3], \"./lib/initUnique.js\");\n  var _libLayoutShiftManagerJs = require(_dependencyMap[4], \"./lib/LayoutShiftManager.js\");\n  var _libObserveJs = require(_dependencyMap[5], \"./lib/observe.js\");\n  var _libRunOnceJs = require(_dependencyMap[6], \"./lib/runOnce.js\");\n  var _onFCPJs = require(_dependencyMap[7], \"./onFCP.js\");\n  /*\n   * Copyright 2020 Google LLC\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     https://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /** Thresholds for CLS. See https://web.dev/articles/cls#what_is_a_good_cls_score */\n  const CLSThresholds = [0.1, 0.25];\n\n  /**\n   * Calculates the [CLS](https://web.dev/articles/cls) value for the current page and\n   * calls the `callback` function once the value is ready to be reported, along\n   * with all `layout-shift` performance entries that were used in the metric\n   * value calculation. The reported value is a `double` (corresponding to a\n   * [layout shift score](https://web.dev/articles/cls#layout_shift_score)).\n   *\n   * If the `reportAllChanges` configuration option is set to `true`, the\n   * `callback` function will be called as soon as the value is initially\n   * determined as well as any time the value changes throughout the page\n   * lifespan.\n   *\n   * _**Important:** CLS should be continually monitored for changes throughout\n   * the entire lifespan of a pageâ€”including if the user returns to the page after\n   * it's been hidden/backgrounded. However, since browsers often [will not fire\n   * additional callbacks once the user has backgrounded a\n   * page](https://developer.chrome.com/blog/page-lifecycle-api/#advice-hidden),\n   * `callback` is always called when the page's visibility state changes to\n   * hidden. As a result, the `callback` function might be called multiple times\n   * during the same page load._\n   */\n  const onCLS = (onReport, opts = {}) => {\n    // Start monitoring FCP so we can only report CLS if FCP is also reported.\n    // Note: this is done to match the current behavior of CrUX.\n    (0, _onFCPJs.onFCP)((0, _libRunOnceJs.runOnce)(() => {\n      const metric = (0, _libInitMetricJs.initMetric)('CLS', 0);\n      let report;\n      const layoutShiftManager = (0, _libInitUniqueJs.initUnique)(opts, _libLayoutShiftManagerJs.LayoutShiftManager);\n      const handleEntries = entries => {\n        for (const entry of entries) {\n          layoutShiftManager._processEntry(entry);\n        }\n\n        // If the current session value is larger than the current CLS value,\n        // update CLS and the entries contributing to it.\n        if (layoutShiftManager._sessionValue > metric.value) {\n          metric.value = layoutShiftManager._sessionValue;\n          metric.entries = layoutShiftManager._sessionEntries;\n          report();\n        }\n      };\n      const po = (0, _libObserveJs.observe)('layout-shift', handleEntries);\n      if (po) {\n        report = (0, _libBindReporterJs.bindReporter)(onReport, metric, CLSThresholds, opts.reportAllChanges);\n        _typesJs.WINDOW.document?.addEventListener('visibilitychange', () => {\n          if (_typesJs.WINDOW.document?.visibilityState === 'hidden') {\n            handleEntries(po.takeRecords());\n            report(true);\n          }\n        });\n\n        // Queue a task to report (if nothing else triggers a report first).\n        // This allows CLS to be reported as soon as FCP fires when\n        // `reportAllChanges` is true.\n        _typesJs.WINDOW?.setTimeout?.(report);\n      }\n    }));\n  };\n});","lineCount":104,"map":[[7,2,95,0,"Object"],[7,8,95,0],[7,9,95,0,"defineProperty"],[7,23,95,0],[7,24,95,0,"exports"],[7,31,95,0],[8,4,95,0,"enumerable"],[8,14,95,0],[9,4,95,0,"get"],[9,7,95,0],[9,18,95,0,"get"],[9,19,95,0],[10,6,95,0],[10,13,95,9,"CLSThresholds"],[10,26,95,22],[11,4,95,22],[12,2,95,22],[13,2,95,0,"Object"],[13,8,95,0],[13,9,95,0,"defineProperty"],[13,23,95,0],[13,24,95,0,"exports"],[13,31,95,0],[14,4,95,0,"enumerable"],[14,14,95,0],[15,4,95,0,"get"],[15,7,95,0],[15,18,95,0,"get"],[15,19,95,0],[16,6,95,0],[16,13,95,24,"onCLS"],[16,18,95,29],[17,4,95,29],[18,2,95,29],[19,2,1,0],[19,6,1,0,"_typesJs"],[19,14,1,0],[19,17,1,0,"require"],[19,24,1,0],[19,25,1,0,"_dependencyMap"],[19,39,1,0],[20,2,2,0],[20,6,2,0,"_libBindReporterJs"],[20,24,2,0],[20,27,2,0,"require"],[20,34,2,0],[20,35,2,0,"_dependencyMap"],[20,49,2,0],[21,2,3,0],[21,6,3,0,"_libInitMetricJs"],[21,22,3,0],[21,25,3,0,"require"],[21,32,3,0],[21,33,3,0,"_dependencyMap"],[21,47,3,0],[22,2,4,0],[22,6,4,0,"_libInitUniqueJs"],[22,22,4,0],[22,25,4,0,"require"],[22,32,4,0],[22,33,4,0,"_dependencyMap"],[22,47,4,0],[23,2,5,0],[23,6,5,0,"_libLayoutShiftManagerJs"],[23,30,5,0],[23,33,5,0,"require"],[23,40,5,0],[23,41,5,0,"_dependencyMap"],[23,55,5,0],[24,2,6,0],[24,6,6,0,"_libObserveJs"],[24,19,6,0],[24,22,6,0,"require"],[24,29,6,0],[24,30,6,0,"_dependencyMap"],[24,44,6,0],[25,2,7,0],[25,6,7,0,"_libRunOnceJs"],[25,19,7,0],[25,22,7,0,"require"],[25,29,7,0],[25,30,7,0,"_dependencyMap"],[25,44,7,0],[26,2,8,0],[26,6,8,0,"_onFCPJs"],[26,14,8,0],[26,17,8,0,"require"],[26,24,8,0],[26,25,8,0,"_dependencyMap"],[26,39,8,0],[27,2,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[34,0,17,0],[35,0,18,0],[36,0,19,0],[37,0,20,0],[38,0,21,0],[39,0,22,0],[40,0,23,0],[41,0,24,0],[43,2,27,0],[44,2,28,0],[44,8,28,6,"CLSThresholds"],[44,21,28,19],[44,24,28,22],[44,25,28,23],[44,28,28,26],[44,30,28,28],[44,34,28,32],[44,35,28,33],[46,2,30,0],[47,0,31,0],[48,0,32,0],[49,0,33,0],[50,0,34,0],[51,0,35,0],[52,0,36,0],[53,0,37,0],[54,0,38,0],[55,0,39,0],[56,0,40,0],[57,0,41,0],[58,0,42,0],[59,0,43,0],[60,0,44,0],[61,0,45,0],[62,0,46,0],[63,0,47,0],[64,0,48,0],[65,0,49,0],[66,0,50,0],[67,2,51,0],[67,8,51,6,"onCLS"],[67,13,51,11],[67,16,51,14,"onCLS"],[67,17,51,15,"onReport"],[67,25,51,23],[67,27,51,25,"opts"],[67,31,51,29],[67,34,51,32],[67,35,51,33],[67,36,51,34],[67,41,51,39],[68,4,52,2],[69,4,53,2],[70,4,54,2],[70,8,54,2,"onFCP"],[70,16,54,7],[70,17,54,7,"onFCP"],[70,22,54,7],[70,24,55,4],[70,28,55,4,"runOnce"],[70,41,55,11],[70,42,55,11,"runOnce"],[70,49,55,11],[70,51,55,12],[70,57,55,18],[71,6,56,6],[71,12,56,12,"metric"],[71,18,56,18],[71,21,56,21],[71,25,56,21,"initMetric"],[71,41,56,31],[71,42,56,31,"initMetric"],[71,52,56,31],[71,54,56,32],[71,59,56,37],[71,61,56,39],[71,62,56,40],[71,63,56,41],[72,6,57,6],[72,10,57,10,"report"],[72,16,57,16],[73,6,59,6],[73,12,59,12,"layoutShiftManager"],[73,30,59,30],[73,33,59,33],[73,37,59,33,"initUnique"],[73,53,59,43],[73,54,59,43,"initUnique"],[73,64,59,43],[73,66,59,44,"opts"],[73,70,59,48],[73,72,59,50,"LayoutShiftManager"],[73,96,59,68],[73,97,59,68,"LayoutShiftManager"],[73,115,59,68],[73,116,59,69],[74,6,61,6],[74,12,61,12,"handleEntries"],[74,25,61,25],[74,28,61,29,"entries"],[74,35,61,36],[74,39,61,41],[75,8,62,8],[75,13,62,13],[75,19,62,19,"entry"],[75,24,62,24],[75,28,62,28,"entries"],[75,35,62,35],[75,37,62,37],[76,10,63,10,"layoutShiftManager"],[76,28,63,28],[76,29,63,29,"_processEntry"],[76,42,63,42],[76,43,63,43,"entry"],[76,48,63,48],[76,49,63,49],[77,8,64,8],[79,8,66,8],[80,8,67,8],[81,8,68,8],[81,12,68,12,"layoutShiftManager"],[81,30,68,30],[81,31,68,31,"_sessionValue"],[81,44,68,44],[81,47,68,47,"metric"],[81,53,68,53],[81,54,68,54,"value"],[81,59,68,59],[81,61,68,61],[82,10,69,10,"metric"],[82,16,69,16],[82,17,69,17,"value"],[82,22,69,22],[82,25,69,25,"layoutShiftManager"],[82,43,69,43],[82,44,69,44,"_sessionValue"],[82,57,69,57],[83,10,70,10,"metric"],[83,16,70,16],[83,17,70,17,"entries"],[83,24,70,24],[83,27,70,27,"layoutShiftManager"],[83,45,70,45],[83,46,70,46,"_sessionEntries"],[83,61,70,61],[84,10,71,10,"report"],[84,16,71,16],[84,17,71,17],[84,18,71,18],[85,8,72,8],[86,6,73,6],[86,7,73,7],[87,6,75,6],[87,12,75,12,"po"],[87,14,75,14],[87,17,75,17],[87,21,75,17,"observe"],[87,34,75,24],[87,35,75,24,"observe"],[87,42,75,24],[87,44,75,25],[87,58,75,39],[87,60,75,41,"handleEntries"],[87,73,75,54],[87,74,75,55],[88,6,76,6],[88,10,76,10,"po"],[88,12,76,12],[88,14,76,14],[89,8,77,8,"report"],[89,14,77,14],[89,17,77,17],[89,21,77,17,"bindReporter"],[89,39,77,29],[89,40,77,29,"bindReporter"],[89,52,77,29],[89,54,77,30,"onReport"],[89,62,77,38],[89,64,77,40,"metric"],[89,70,77,46],[89,72,77,48,"CLSThresholds"],[89,85,77,61],[89,87,77,63,"opts"],[89,91,77,67],[89,92,77,68,"reportAllChanges"],[89,108,77,84],[89,109,77,85],[90,8,79,8,"WINDOW"],[90,16,79,14],[90,17,79,14,"WINDOW"],[90,23,79,14],[90,24,79,15,"document"],[90,32,79,23],[90,34,79,25,"addEventListener"],[90,50,79,41],[90,51,79,42],[90,69,79,60],[90,71,79,62],[90,77,79,68],[91,10,80,10],[91,14,80,14,"WINDOW"],[91,22,80,20],[91,23,80,20,"WINDOW"],[91,29,80,20],[91,30,80,21,"document"],[91,38,80,29],[91,40,80,31,"visibilityState"],[91,55,80,46],[91,60,80,51],[91,68,80,59],[91,70,80,61],[92,12,81,12,"handleEntries"],[92,25,81,25],[92,26,81,26,"po"],[92,28,81,28],[92,29,81,29,"takeRecords"],[92,40,81,40],[92,41,81,41],[92,42,81,43],[92,43,81,44],[93,12,82,12,"report"],[93,18,82,18],[93,19,82,19],[93,23,82,23],[93,24,82,24],[94,10,83,10],[95,8,84,8],[95,9,84,9],[95,10,84,10],[97,8,86,8],[98,8,87,8],[99,8,88,8],[100,8,89,8,"WINDOW"],[100,16,89,14],[100,17,89,14,"WINDOW"],[100,23,89,14],[100,25,89,16,"setTimeout"],[100,35,89,26],[100,38,89,29,"report"],[100,44,89,35],[100,45,89,36],[101,6,90,6],[102,4,91,4],[102,5,91,5],[102,6,92,2],[102,7,92,3],[103,2,93,0],[103,3,93,1],[104,0,93,2],[104,3]],"functionMap":{"names":["<global>","onCLS","runOnce$argument_0","handleEntries","WINDOW.document.addEventListener$argument_1"],"mappings":"AAA;cCkD;YCI;4BCM;ODY;8DEM;SFK;KDO;CDE"},"hasCjsExports":false},"type":"js/module"}]}