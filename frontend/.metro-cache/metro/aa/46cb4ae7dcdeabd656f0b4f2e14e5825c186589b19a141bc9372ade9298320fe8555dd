{"dependencies":[{"name":"../debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"rfhktnzi6PvZxT1xtyHWbBktN/w=","exportNames":["*"],"imports":1}},{"name":"../utils/debug-logger.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":49},"end":{"line":2,"column":49,"index":98}}],"key":"bptn1GZFOkS4BOMU8jhPqqHmvAc=","exportNames":["*"],"imports":1}},{"name":"../utils/hasSpansEnabled.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":62,"index":161}}],"key":"5PJ5OboJ1xAWFNG6iC6w5ishwR8=","exportNames":["*"],"imports":1}},{"name":"../utils/parseSampleRate.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":162},"end":{"line":4,"column":62,"index":224}}],"key":"fuSKwon9rTlXsG7MamYKWdW+40U=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"sampleSpan\", {\n    enumerable: true,\n    get: function () {\n      return sampleSpan;\n    }\n  });\n  var _debugBuildJs = require(_dependencyMap[0], \"../debug-build.js\");\n  var _utilsDebugLoggerJs = require(_dependencyMap[1], \"../utils/debug-logger.js\");\n  var _utilsHasSpansEnabledJs = require(_dependencyMap[2], \"../utils/hasSpansEnabled.js\");\n  var _utilsParseSampleRateJs = require(_dependencyMap[3], \"../utils/parseSampleRate.js\");\n  /**\n   * Makes a sampling decision for the given options.\n   *\n   * Called every time a root span is created. Only root spans which emerge with a `sampled` value of `true` will be\n   * sent to Sentry.\n   */\n  function sampleSpan(options, samplingContext, sampleRand) {\n    // nothing to do if span recording is not enabled\n    if (!(0, _utilsHasSpansEnabledJs.hasSpansEnabled)(options)) {\n      return [false];\n    }\n    let localSampleRateWasApplied = undefined;\n\n    // we would have bailed already if neither `tracesSampler` nor `tracesSampleRate` were defined, so one of these should\n    // work; prefer the hook if so\n    let sampleRate;\n    if (typeof options.tracesSampler === 'function') {\n      sampleRate = options.tracesSampler(Object.assign({}, samplingContext, {\n        inheritOrSampleWith: fallbackSampleRate => {\n          // If we have an incoming parent sample rate, we'll just use that one.\n          // The sampling decision will be inherited because of the sample_rand that was generated when the trace reached the incoming boundaries of the SDK.\n          if (typeof samplingContext.parentSampleRate === 'number') {\n            return samplingContext.parentSampleRate;\n          }\n\n          // Fallback if parent sample rate is not on the incoming trace (e.g. if there is no baggage)\n          // This is to provide backwards compatibility if there are incoming traces from older SDKs that don't send a parent sample rate or a sample rand. In these cases we just want to force either a sampling decision on the downstream traces via the sample rate.\n          if (typeof samplingContext.parentSampled === 'boolean') {\n            return Number(samplingContext.parentSampled);\n          }\n          return fallbackSampleRate;\n        }\n      }));\n      localSampleRateWasApplied = true;\n    } else if (samplingContext.parentSampled !== undefined) {\n      sampleRate = samplingContext.parentSampled;\n    } else if (typeof options.tracesSampleRate !== 'undefined') {\n      sampleRate = options.tracesSampleRate;\n      localSampleRateWasApplied = true;\n    }\n\n    // Since this is coming from the user (or from a function provided by the user), who knows what we might get.\n    // (The only valid values are booleans or numbers between 0 and 1.)\n    const parsedSampleRate = (0, _utilsParseSampleRateJs.parseSampleRate)(sampleRate);\n    if (parsedSampleRate === undefined) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.warn(`[Tracing] Discarding root span because of invalid sample rate. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(sampleRate)} of type ${JSON.stringify(typeof sampleRate)}.`);\n      return [false];\n    }\n\n    // if the function returned 0 (or false), or if `tracesSampleRate` is 0, it's a sign the transaction should be dropped\n    if (!parsedSampleRate) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.log(`[Tracing] Discarding transaction because ${typeof options.tracesSampler === 'function' ? 'tracesSampler returned 0 or false' : 'a negative sampling decision was inherited or tracesSampleRate is set to 0'}`);\n      return [false, parsedSampleRate, localSampleRateWasApplied];\n    }\n\n    // We always compare the sample rand for the current execution context against the chosen sample rate.\n    // Read more: https://develop.sentry.dev/sdk/telemetry/traces/#propagated-random-value\n    const shouldSample = sampleRand < parsedSampleRate;\n\n    // if we're not going to keep it, we're done\n    if (!shouldSample) {\n      _debugBuildJs.DEBUG_BUILD && _utilsDebugLoggerJs.debug.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(sampleRate)})`);\n    }\n    return [shouldSample, parsedSampleRate, localSampleRateWasApplied];\n  }\n});","lineCount":82,"map":[[7,2,98,0,"Object"],[7,8,98,0],[7,9,98,0,"defineProperty"],[7,23,98,0],[7,24,98,0,"exports"],[7,31,98,0],[8,4,98,0,"enumerable"],[8,14,98,0],[9,4,98,0,"get"],[9,7,98,0],[9,18,98,0,"get"],[9,19,98,0],[10,6,98,0],[10,13,98,9,"sampleSpan"],[10,23,98,19],[11,4,98,19],[12,2,98,19],[13,2,1,0],[13,6,1,0,"_debugBuildJs"],[13,19,1,0],[13,22,1,0,"require"],[13,29,1,0],[13,30,1,0,"_dependencyMap"],[13,44,1,0],[14,2,2,0],[14,6,2,0,"_utilsDebugLoggerJs"],[14,25,2,0],[14,28,2,0,"require"],[14,35,2,0],[14,36,2,0,"_dependencyMap"],[14,50,2,0],[15,2,3,0],[15,6,3,0,"_utilsHasSpansEnabledJs"],[15,29,3,0],[15,32,3,0,"require"],[15,39,3,0],[15,40,3,0,"_dependencyMap"],[15,54,3,0],[16,2,4,0],[16,6,4,0,"_utilsParseSampleRateJs"],[16,29,4,0],[16,32,4,0,"require"],[16,39,4,0],[16,40,4,0,"_dependencyMap"],[16,54,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,2,12,0],[23,11,12,9,"sampleSpan"],[23,21,12,19,"sampleSpan"],[23,22,13,2,"options"],[23,29,13,9],[23,31,14,2,"samplingContext"],[23,46,14,17],[23,48,15,2,"sampleRand"],[23,58,15,12],[23,60,16,2],[24,4,17,2],[25,4,18,2],[25,8,18,6],[25,9,18,7],[25,13,18,7,"hasSpansEnabled"],[25,36,18,22],[25,37,18,22,"hasSpansEnabled"],[25,52,18,22],[25,54,18,23,"options"],[25,61,18,30],[25,62,18,31],[25,64,18,33],[26,6,19,4],[26,13,19,11],[26,14,19,12],[26,19,19,17],[26,20,19,18],[27,4,20,2],[28,4,22,2],[28,8,22,6,"localSampleRateWasApplied"],[28,33,22,31],[28,36,22,34,"undefined"],[28,45,22,43],[30,4,24,2],[31,4,25,2],[32,4,26,2],[32,8,26,6,"sampleRate"],[32,18,26,16],[33,4,27,2],[33,8,27,6],[33,15,27,13,"options"],[33,22,27,20],[33,23,27,21,"tracesSampler"],[33,36,27,34],[33,41,27,39],[33,51,27,49],[33,53,27,51],[34,6,28,4,"sampleRate"],[34,16,28,14],[34,19,28,17,"options"],[34,26,28,24],[34,27,28,25,"tracesSampler"],[34,40,28,38],[34,41,28,38,"Object"],[34,47,28,38],[34,48,28,38,"assign"],[34,54,28,38],[34,59,29,9,"samplingContext"],[34,74,29,24],[35,8,30,6,"inheritOrSampleWith"],[35,27,30,25],[35,29,30,27,"fallbackSampleRate"],[35,47,30,45],[35,51,30,49],[36,10,31,8],[37,10,32,8],[38,10,33,8],[38,14,33,12],[38,21,33,19,"samplingContext"],[38,36,33,34],[38,37,33,35,"parentSampleRate"],[38,53,33,51],[38,58,33,56],[38,66,33,64],[38,68,33,66],[39,12,34,10],[39,19,34,17,"samplingContext"],[39,34,34,32],[39,35,34,33,"parentSampleRate"],[39,51,34,49],[40,10,35,8],[42,10,37,8],[43,10,38,8],[44,10,39,8],[44,14,39,12],[44,21,39,19,"samplingContext"],[44,36,39,34],[44,37,39,35,"parentSampled"],[44,50,39,48],[44,55,39,53],[44,64,39,62],[44,66,39,64],[45,12,40,10],[45,19,40,17,"Number"],[45,25,40,23],[45,26,40,24,"samplingContext"],[45,41,40,39],[45,42,40,40,"parentSampled"],[45,55,40,53],[45,56,40,54],[46,10,41,8],[47,10,43,8],[47,17,43,15,"fallbackSampleRate"],[47,35,43,33],[48,8,44,6],[49,6,44,7],[49,8,45,5],[49,9,45,6],[50,6,46,4,"localSampleRateWasApplied"],[50,31,46,29],[50,34,46,32],[50,38,46,36],[51,4,47,2],[51,5,47,3],[51,11,47,9],[51,15,47,13,"samplingContext"],[51,30,47,28],[51,31,47,29,"parentSampled"],[51,44,47,42],[51,49,47,47,"undefined"],[51,58,47,56],[51,60,47,58],[52,6,48,4,"sampleRate"],[52,16,48,14],[52,19,48,17,"samplingContext"],[52,34,48,32],[52,35,48,33,"parentSampled"],[52,48,48,46],[53,4,49,2],[53,5,49,3],[53,11,49,9],[53,15,49,13],[53,22,49,20,"options"],[53,29,49,27],[53,30,49,28,"tracesSampleRate"],[53,46,49,44],[53,51,49,49],[53,62,49,60],[53,64,49,62],[54,6,50,4,"sampleRate"],[54,16,50,14],[54,19,50,17,"options"],[54,26,50,24],[54,27,50,25,"tracesSampleRate"],[54,43,50,41],[55,6,51,4,"localSampleRateWasApplied"],[55,31,51,29],[55,34,51,32],[55,38,51,36],[56,4,52,2],[58,4,54,2],[59,4,55,2],[60,4,56,2],[60,10,56,8,"parsedSampleRate"],[60,26,56,24],[60,29,56,27],[60,33,56,27,"parseSampleRate"],[60,56,56,42],[60,57,56,42,"parseSampleRate"],[60,72,56,42],[60,74,56,43,"sampleRate"],[60,84,56,53],[60,85,56,54],[61,4,58,2],[61,8,58,6,"parsedSampleRate"],[61,24,58,22],[61,29,58,27,"undefined"],[61,38,58,36],[61,40,58,38],[62,6,59,4,"DEBUG_BUILD"],[62,19,59,15],[62,20,59,15,"DEBUG_BUILD"],[62,31,59,15],[62,35,60,6,"debug"],[62,54,60,11],[62,55,60,11,"debug"],[62,60,60,11],[62,61,60,12,"warn"],[62,65,60,16],[62,66,61,8],[62,195,61,137,"JSON"],[62,199,61,141],[62,200,61,142,"stringify"],[62,209,61,151],[62,210,62,10,"sampleRate"],[62,220,63,8],[62,221,63,9],[62,233,63,21,"JSON"],[62,237,63,25],[62,238,63,26,"stringify"],[62,247,63,35],[62,248,63,36],[62,255,63,43,"sampleRate"],[62,265,63,53],[62,266,63,54],[62,269,64,6],[62,270,64,7],[63,6,65,4],[63,13,65,11],[63,14,65,12],[63,19,65,17],[63,20,65,18],[64,4,66,2],[66,4,68,2],[67,4,69,2],[67,8,69,6],[67,9,69,7,"parsedSampleRate"],[67,25,69,23],[67,27,69,25],[68,6,70,4,"DEBUG_BUILD"],[68,19,70,15],[68,20,70,15,"DEBUG_BUILD"],[68,31,70,15],[68,35,71,6,"debug"],[68,54,71,11],[68,55,71,11,"debug"],[68,60,71,11],[68,61,71,12,"log"],[68,64,71,15],[68,65,72,8],[68,109,73,10],[68,116,73,17,"options"],[68,123,73,24],[68,124,73,25,"tracesSampler"],[68,137,73,38],[68,142,73,43],[68,152,73,53],[68,155,74,14],[68,190,74,49],[68,193,75,14],[68,269,75,90],[68,271,77,6],[68,272,77,7],[69,6,78,4],[69,13,78,11],[69,14,78,12],[69,19,78,17],[69,21,78,19,"parsedSampleRate"],[69,37,78,35],[69,39,78,37,"localSampleRateWasApplied"],[69,64,78,62],[69,65,78,63],[70,4,79,2],[72,4,81,2],[73,4,82,2],[74,4,83,2],[74,10,83,8,"shouldSample"],[74,22,83,20],[74,25,83,23,"sampleRand"],[74,35,83,33],[74,38,83,36,"parsedSampleRate"],[74,54,83,52],[76,4,85,2],[77,4,86,2],[77,8,86,6],[77,9,86,7,"shouldSample"],[77,21,86,19],[77,23,86,21],[78,6,87,4,"DEBUG_BUILD"],[78,19,87,15],[78,20,87,15,"DEBUG_BUILD"],[78,31,87,15],[78,35,88,6,"debug"],[78,54,88,11],[78,55,88,11,"debug"],[78,60,88,11],[78,61,88,12,"log"],[78,64,88,15],[78,65,89,8],[78,165,89,108,"Number"],[78,171,89,114],[78,172,90,10,"sampleRate"],[78,182,91,8],[78,183,91,9],[78,186,92,6],[78,187,92,7],[79,4,93,2],[80,4,95,2],[80,11,95,9],[80,12,95,10,"shouldSample"],[80,24,95,22],[80,26,95,24,"parsedSampleRate"],[80,42,95,40],[80,44,95,42,"localSampleRateWasApplied"],[80,69,95,67],[80,70,95,68],[81,2,96,0],[82,0,96,1],[82,3]],"functionMap":{"names":["<global>","sampleSpan","options.tracesSampler$argument_0.inheritOrSampleWith"],"mappings":"AAA;ACW;2BCkB;ODc;CDoD"},"hasCjsExports":false},"type":"js/module"}]}