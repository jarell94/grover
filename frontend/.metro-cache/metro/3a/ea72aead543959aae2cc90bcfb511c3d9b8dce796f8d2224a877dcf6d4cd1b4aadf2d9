{"dependencies":[{"name":"./is.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":39,"index":39}}],"key":"C6fLnEQPNIdj7xXbougAJ0zoinA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"applyAggregateErrorsToEvent\", {\n    enumerable: true,\n    get: function () {\n      return applyAggregateErrorsToEvent;\n    }\n  });\n  var _isJs = require(_dependencyMap[0], \"./is.js\");\n  /**\n   * Creates exceptions inside `event.exception.values` for errors that are nested on properties based on the `key` parameter.\n   */\n  function applyAggregateErrorsToEvent(exceptionFromErrorImplementation, parser, key, limit, event, hint) {\n    if (!event.exception?.values || !hint || !(0, _isJs.isInstanceOf)(hint.originalException, Error)) {\n      return;\n    }\n\n    // Generally speaking the last item in `event.exception.values` is the exception originating from the original Error\n    const originalException = event.exception.values.length > 0 ? event.exception.values[event.exception.values.length - 1] : undefined;\n\n    // We only create exception grouping if there is an exception in the event.\n    if (originalException) {\n      event.exception.values = aggregateExceptionsFromError(exceptionFromErrorImplementation, parser, limit, hint.originalException, key, event.exception.values, originalException, 0);\n    }\n  }\n  function aggregateExceptionsFromError(exceptionFromErrorImplementation, parser, limit, error, key, prevExceptions, exception, exceptionId) {\n    if (prevExceptions.length >= limit + 1) {\n      return prevExceptions;\n    }\n    let newExceptions = [...prevExceptions];\n\n    // Recursively call this function in order to walk down a chain of errors\n    if ((0, _isJs.isInstanceOf)(error[key], Error)) {\n      applyExceptionGroupFieldsForParentException(exception, exceptionId);\n      const newException = exceptionFromErrorImplementation(parser, error[key]);\n      const newExceptionId = newExceptions.length;\n      applyExceptionGroupFieldsForChildException(newException, key, newExceptionId, exceptionId);\n      newExceptions = aggregateExceptionsFromError(exceptionFromErrorImplementation, parser, limit, error[key], key, [newException, ...newExceptions], newException, newExceptionId);\n    }\n\n    // This will create exception grouping for AggregateErrors\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AggregateError\n    if (Array.isArray(error.errors)) {\n      error.errors.forEach((childError, i) => {\n        if ((0, _isJs.isInstanceOf)(childError, Error)) {\n          applyExceptionGroupFieldsForParentException(exception, exceptionId);\n          const newException = exceptionFromErrorImplementation(parser, childError);\n          const newExceptionId = newExceptions.length;\n          applyExceptionGroupFieldsForChildException(newException, `errors[${i}]`, newExceptionId, exceptionId);\n          newExceptions = aggregateExceptionsFromError(exceptionFromErrorImplementation, parser, limit, childError, key, [newException, ...newExceptions], newException, newExceptionId);\n        }\n      });\n    }\n    return newExceptions;\n  }\n  function applyExceptionGroupFieldsForParentException(exception, exceptionId) {\n    exception.mechanism = {\n      handled: true,\n      type: 'auto.core.linked_errors',\n      ...exception.mechanism,\n      ...(exception.type === 'AggregateError' && {\n        is_exception_group: true\n      }),\n      exception_id: exceptionId\n    };\n  }\n  function applyExceptionGroupFieldsForChildException(exception, source, exceptionId, parentId) {\n    exception.mechanism = {\n      handled: true,\n      ...exception.mechanism,\n      type: 'chained',\n      source,\n      exception_id: exceptionId,\n      parent_id: parentId\n    };\n  }\n});","lineCount":81,"map":[[7,2,123,0,"Object"],[7,8,123,0],[7,9,123,0,"defineProperty"],[7,23,123,0],[7,24,123,0,"exports"],[7,31,123,0],[8,4,123,0,"enumerable"],[8,14,123,0],[9,4,123,0,"get"],[9,7,123,0],[9,18,123,0,"get"],[9,19,123,0],[10,6,123,0],[10,13,123,9,"applyAggregateErrorsToEvent"],[10,40,123,36],[11,4,123,36],[12,2,123,36],[13,2,1,0],[13,6,1,0,"_isJs"],[13,11,1,0],[13,14,1,0,"require"],[13,21,1,0],[13,22,1,0,"_dependencyMap"],[13,36,1,0],[14,2,3,0],[15,0,4,0],[16,0,5,0],[17,2,6,0],[17,11,6,9,"applyAggregateErrorsToEvent"],[17,38,6,36,"applyAggregateErrorsToEvent"],[17,39,7,2,"exceptionFromErrorImplementation"],[17,71,7,34],[17,73,8,2,"parser"],[17,79,8,8],[17,81,9,2,"key"],[17,84,9,5],[17,86,10,2,"limit"],[17,91,10,7],[17,93,11,2,"event"],[17,98,11,7],[17,100,12,2,"hint"],[17,104,12,6],[17,106,13,2],[18,4,14,2],[18,8,14,6],[18,9,14,7,"event"],[18,14,14,12],[18,15,14,13,"exception"],[18,24,14,22],[18,26,14,24,"values"],[18,32,14,30],[18,36,14,34],[18,37,14,35,"hint"],[18,41,14,39],[18,45,14,43],[18,46,14,44],[18,50,14,44,"isInstanceOf"],[18,55,14,56],[18,56,14,56,"isInstanceOf"],[18,68,14,56],[18,70,14,57,"hint"],[18,74,14,61],[18,75,14,62,"originalException"],[18,92,14,79],[18,94,14,81,"Error"],[18,99,14,86],[18,100,14,87],[18,102,14,89],[19,6,15,4],[20,4,16,2],[22,4,18,2],[23,4,19,2],[23,10,19,8,"originalException"],[23,27,19,25],[23,30,20,4,"event"],[23,35,20,9],[23,36,20,10,"exception"],[23,45,20,19],[23,46,20,20,"values"],[23,52,20,26],[23,53,20,27,"length"],[23,59,20,33],[23,62,20,36],[23,63,20,37],[23,66,20,40,"event"],[23,71,20,45],[23,72,20,46,"exception"],[23,81,20,55],[23,82,20,56,"values"],[23,88,20,62],[23,89,20,63,"event"],[23,94,20,68],[23,95,20,69,"exception"],[23,104,20,78],[23,105,20,79,"values"],[23,111,20,85],[23,112,20,86,"length"],[23,118,20,92],[23,121,20,95],[23,122,20,96],[23,123,20,97],[23,126,20,100,"undefined"],[23,135,20,109],[25,4,22,2],[26,4,23,2],[26,8,23,6,"originalException"],[26,25,23,23],[26,27,23,25],[27,6,24,4,"event"],[27,11,24,9],[27,12,24,10,"exception"],[27,21,24,19],[27,22,24,20,"values"],[27,28,24,26],[27,31,24,29,"aggregateExceptionsFromError"],[27,59,24,57],[27,60,25,6,"exceptionFromErrorImplementation"],[27,92,25,38],[27,94,26,6,"parser"],[27,100,26,12],[27,102,27,6,"limit"],[27,107,27,11],[27,109,28,6,"hint"],[27,113,28,10],[27,114,28,11,"originalException"],[27,131,28,28],[27,133,29,6,"key"],[27,136,29,9],[27,138,30,6,"event"],[27,143,30,11],[27,144,30,12,"exception"],[27,153,30,21],[27,154,30,22,"values"],[27,160,30,28],[27,162,31,6,"originalException"],[27,179,31,23],[27,181,32,6],[27,182,33,4],[27,183,33,5],[28,4,34,2],[29,2,35,0],[30,2,37,0],[30,11,37,9,"aggregateExceptionsFromError"],[30,39,37,37,"aggregateExceptionsFromError"],[30,40,38,2,"exceptionFromErrorImplementation"],[30,72,38,34],[30,74,39,2,"parser"],[30,80,39,8],[30,82,40,2,"limit"],[30,87,40,7],[30,89,41,2,"error"],[30,94,41,7],[30,96,42,2,"key"],[30,99,42,5],[30,101,43,2,"prevExceptions"],[30,115,43,16],[30,117,44,2,"exception"],[30,126,44,11],[30,128,45,2,"exceptionId"],[30,139,45,13],[30,141,46,2],[31,4,47,2],[31,8,47,6,"prevExceptions"],[31,22,47,20],[31,23,47,21,"length"],[31,29,47,27],[31,33,47,31,"limit"],[31,38,47,36],[31,41,47,39],[31,42,47,40],[31,44,47,42],[32,6,48,4],[32,13,48,11,"prevExceptions"],[32,27,48,25],[33,4,49,2],[34,4,51,2],[34,8,51,6,"newExceptions"],[34,21,51,19],[34,24,51,22],[34,25,51,23],[34,28,51,26,"prevExceptions"],[34,42,51,40],[34,43,51,41],[36,4,53,2],[37,4,54,2],[37,8,54,6],[37,12,54,6,"isInstanceOf"],[37,17,54,18],[37,18,54,18,"isInstanceOf"],[37,30,54,18],[37,32,54,19,"error"],[37,37,54,24],[37,38,54,25,"key"],[37,41,54,28],[37,42,54,29],[37,44,54,31,"Error"],[37,49,54,36],[37,50,54,37],[37,52,54,39],[38,6,55,4,"applyExceptionGroupFieldsForParentException"],[38,49,55,47],[38,50,55,48,"exception"],[38,59,55,57],[38,61,55,59,"exceptionId"],[38,72,55,70],[38,73,55,71],[39,6,56,4],[39,12,56,10,"newException"],[39,24,56,22],[39,27,56,25,"exceptionFromErrorImplementation"],[39,59,56,57],[39,60,56,58,"parser"],[39,66,56,64],[39,68,56,66,"error"],[39,73,56,71],[39,74,56,72,"key"],[39,77,56,75],[39,78,56,76],[39,79,56,77],[40,6,57,4],[40,12,57,10,"newExceptionId"],[40,26,57,24],[40,29,57,27,"newExceptions"],[40,42,57,40],[40,43,57,41,"length"],[40,49,57,47],[41,6,58,4,"applyExceptionGroupFieldsForChildException"],[41,48,58,46],[41,49,58,47,"newException"],[41,61,58,59],[41,63,58,61,"key"],[41,66,58,64],[41,68,58,66,"newExceptionId"],[41,82,58,80],[41,84,58,82,"exceptionId"],[41,95,58,93],[41,96,58,94],[42,6,59,4,"newExceptions"],[42,19,59,17],[42,22,59,20,"aggregateExceptionsFromError"],[42,50,59,48],[42,51,60,6,"exceptionFromErrorImplementation"],[42,83,60,38],[42,85,61,6,"parser"],[42,91,61,12],[42,93,62,6,"limit"],[42,98,62,11],[42,100,63,6,"error"],[42,105,63,11],[42,106,63,12,"key"],[42,109,63,15],[42,110,63,16],[42,112,64,6,"key"],[42,115,64,9],[42,117,65,6],[42,118,65,7,"newException"],[42,130,65,19],[42,132,65,21],[42,135,65,24,"newExceptions"],[42,148,65,37],[42,149,65,38],[42,151,66,6,"newException"],[42,163,66,18],[42,165,67,6,"newExceptionId"],[42,179,68,4],[42,180,68,5],[43,4,69,2],[45,4,71,2],[46,4,72,2],[47,4,73,2],[47,8,73,6,"Array"],[47,13,73,11],[47,14,73,12,"isArray"],[47,21,73,19],[47,22,73,20,"error"],[47,27,73,25],[47,28,73,26,"errors"],[47,34,73,32],[47,35,73,33],[47,37,73,35],[48,6,74,4,"error"],[48,11,74,9],[48,12,74,10,"errors"],[48,18,74,16],[48,19,74,17,"forEach"],[48,26,74,24],[48,27,74,25],[48,28,74,26,"childError"],[48,38,74,36],[48,40,74,38,"i"],[48,41,74,39],[48,46,74,44],[49,8,75,6],[49,12,75,10],[49,16,75,10,"isInstanceOf"],[49,21,75,22],[49,22,75,22,"isInstanceOf"],[49,34,75,22],[49,36,75,23,"childError"],[49,46,75,33],[49,48,75,35,"Error"],[49,53,75,40],[49,54,75,41],[49,56,75,43],[50,10,76,8,"applyExceptionGroupFieldsForParentException"],[50,53,76,51],[50,54,76,52,"exception"],[50,63,76,61],[50,65,76,63,"exceptionId"],[50,76,76,74],[50,77,76,75],[51,10,77,8],[51,16,77,14,"newException"],[51,28,77,26],[51,31,77,29,"exceptionFromErrorImplementation"],[51,63,77,61],[51,64,77,62,"parser"],[51,70,77,68],[51,72,77,70,"childError"],[51,82,77,80],[51,83,77,81],[52,10,78,8],[52,16,78,14,"newExceptionId"],[52,30,78,28],[52,33,78,31,"newExceptions"],[52,46,78,44],[52,47,78,45,"length"],[52,53,78,51],[53,10,79,8,"applyExceptionGroupFieldsForChildException"],[53,52,79,50],[53,53,79,51,"newException"],[53,65,79,63],[53,67,79,65],[53,77,79,75,"i"],[53,78,79,76],[53,81,79,79],[53,83,79,81,"newExceptionId"],[53,97,79,95],[53,99,79,97,"exceptionId"],[53,110,79,108],[53,111,79,109],[54,10,80,8,"newExceptions"],[54,23,80,21],[54,26,80,24,"aggregateExceptionsFromError"],[54,54,80,52],[54,55,81,10,"exceptionFromErrorImplementation"],[54,87,81,42],[54,89,82,10,"parser"],[54,95,82,16],[54,97,83,10,"limit"],[54,102,83,15],[54,104,84,10,"childError"],[54,114,84,20],[54,116,85,10,"key"],[54,119,85,13],[54,121,86,10],[54,122,86,11,"newException"],[54,134,86,23],[54,136,86,25],[54,139,86,28,"newExceptions"],[54,152,86,41],[54,153,86,42],[54,155,87,10,"newException"],[54,167,87,22],[54,169,88,10,"newExceptionId"],[54,183,89,8],[54,184,89,9],[55,8,90,6],[56,6,91,4],[56,7,91,5],[56,8,91,6],[57,4,92,2],[58,4,94,2],[58,11,94,9,"newExceptions"],[58,24,94,22],[59,2,95,0],[60,2,97,0],[60,11,97,9,"applyExceptionGroupFieldsForParentException"],[60,54,97,52,"applyExceptionGroupFieldsForParentException"],[60,55,97,53,"exception"],[60,64,97,62],[60,66,97,64,"exceptionId"],[60,77,97,75],[60,79,97,77],[61,4,98,2,"exception"],[61,13,98,11],[61,14,98,12,"mechanism"],[61,23,98,21],[61,26,98,24],[62,6,99,4,"handled"],[62,13,99,11],[62,15,99,13],[62,19,99,17],[63,6,100,4,"type"],[63,10,100,8],[63,12,100,10],[63,37,100,35],[64,6,101,4],[64,9,101,7,"exception"],[64,18,101,16],[64,19,101,17,"mechanism"],[64,28,101,26],[65,6,102,4],[65,10,102,8,"exception"],[65,19,102,17],[65,20,102,18,"type"],[65,24,102,22],[65,29,102,27],[65,45,102,43],[65,49,102,47],[66,8,102,49,"is_exception_group"],[66,26,102,67],[66,28,102,69],[67,6,102,74],[67,7,102,75],[67,8,102,76],[68,6,103,4,"exception_id"],[68,18,103,16],[68,20,103,18,"exceptionId"],[69,4,104,2],[69,5,104,3],[70,2,105,0],[71,2,107,0],[71,11,107,9,"applyExceptionGroupFieldsForChildException"],[71,53,107,51,"applyExceptionGroupFieldsForChildException"],[71,54,108,2,"exception"],[71,63,108,11],[71,65,109,2,"source"],[71,71,109,8],[71,73,110,2,"exceptionId"],[71,84,110,13],[71,86,111,2,"parentId"],[71,94,111,10],[71,96,112,2],[72,4,113,2,"exception"],[72,13,113,11],[72,14,113,12,"mechanism"],[72,23,113,21],[72,26,113,24],[73,6,114,4,"handled"],[73,13,114,11],[73,15,114,13],[73,19,114,17],[74,6,115,4],[74,9,115,7,"exception"],[74,18,115,16],[74,19,115,17,"mechanism"],[74,28,115,26],[75,6,116,4,"type"],[75,10,116,8],[75,12,116,10],[75,21,116,19],[76,6,117,4,"source"],[76,12,117,10],[77,6,118,4,"exception_id"],[77,18,118,16],[77,20,118,18,"exceptionId"],[77,31,118,29],[78,6,119,4,"parent_id"],[78,15,119,13],[78,17,119,15,"parentId"],[79,4,120,2],[79,5,120,3],[80,2,121,0],[81,0,121,1],[81,3]],"functionMap":{"names":["<global>","applyAggregateErrorsToEvent","aggregateExceptionsFromError","error.errors.forEach$argument_0","applyExceptionGroupFieldsForParentException","applyExceptionGroupFieldsForChildException"],"mappings":"AAA;ACK;CD6B;AEE;yBCqC;KDiB;CFI;AIE;CJQ;AKE;CLc"},"hasCjsExports":false},"type":"js/module"}]}