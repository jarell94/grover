{"dependencies":[{"name":"../integration.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"B8aKvpmafw58aWtupuC7GWTMiwo=","exportNames":["*"],"imports":1}},{"name":"../utils/cookie.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":49,"index":104}}],"key":"YThdOGzUvaRB6jb/6qXn3WTUc5o=","exportNames":["*"],"imports":1}},{"name":"../vendor/getIpAddress.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":105},"end":{"line":3,"column":78,"index":183}}],"key":"0oKNyq51031kf5wc4IhuDX1sUmA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"requestDataIntegration\", {\n    enumerable: true,\n    get: function () {\n      return requestDataIntegration;\n    }\n  });\n  var _integrationJs = require(_dependencyMap[0], \"../integration.js\");\n  var _utilsCookieJs = require(_dependencyMap[1], \"../utils/cookie.js\");\n  var _vendorGetIpAddressJs = require(_dependencyMap[2], \"../vendor/getIpAddress.js\");\n  // TODO(v11): Change defaults based on `sendDefaultPii`\n  const DEFAULT_INCLUDE = {\n    cookies: true,\n    data: true,\n    headers: true,\n    query_string: true,\n    url: true\n  };\n  const INTEGRATION_NAME = 'RequestData';\n  const _requestDataIntegration = (options = {}) => {\n    const include = Object.assign({}, DEFAULT_INCLUDE, options.include);\n    return {\n      name: INTEGRATION_NAME,\n      processEvent(event, _hint, client) {\n        const {\n          sdkProcessingMetadata = {}\n        } = event;\n        const {\n          normalizedRequest,\n          ipAddress\n        } = sdkProcessingMetadata;\n        const includeWithDefaultPiiApplied = Object.assign({}, include, {\n          ip: include.ip ?? client.getOptions().sendDefaultPii\n        });\n        if (normalizedRequest) {\n          addNormalizedRequestDataToEvent(event, normalizedRequest, {\n            ipAddress\n          }, includeWithDefaultPiiApplied);\n        }\n        return event;\n      }\n    };\n  };\n\n  /**\n   * Add data about a request to an event. Primarily for use in Node-based SDKs, but included in `@sentry/core`\n   * so it can be used in cross-platform SDKs like `@sentry/nextjs`.\n   */\n  const requestDataIntegration = (0, _integrationJs.defineIntegration)(_requestDataIntegration);\n\n  /**\n   * Add already normalized request data to an event.\n   * This mutates the passed in event.\n   */\n  function addNormalizedRequestDataToEvent(event, req,\n  // Data that should not go into `event.request` but is somehow related to requests\n  additionalData, include) {\n    event.request = Object.assign({}, event.request, extractNormalizedRequestData(req, include));\n    if (include.ip) {\n      const ip = req.headers && (0, _vendorGetIpAddressJs.getClientIPAddress)(req.headers) || additionalData.ipAddress;\n      if (ip) {\n        event.user = Object.assign({}, event.user, {\n          ip_address: ip\n        });\n      }\n    }\n  }\n  function extractNormalizedRequestData(normalizedRequest, include) {\n    const requestData = {};\n    const headers = Object.assign({}, normalizedRequest.headers);\n    if (include.headers) {\n      requestData.headers = headers;\n\n      // Remove the Cookie header in case cookie data should not be included in the event\n      if (!include.cookies) {\n        delete headers.cookie;\n      }\n\n      // Remove IP headers in case IP data should not be included in the event\n      if (!include.ip) {\n        _vendorGetIpAddressJs.ipHeaderNames.forEach(ipHeaderName => {\n          // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n          delete headers[ipHeaderName];\n        });\n      }\n    }\n    requestData.method = normalizedRequest.method;\n    if (include.url) {\n      requestData.url = normalizedRequest.url;\n    }\n    if (include.cookies) {\n      const cookies = normalizedRequest.cookies || (headers?.cookie ? (0, _utilsCookieJs.parseCookie)(headers.cookie) : undefined);\n      requestData.cookies = cookies || {};\n    }\n    if (include.query_string) {\n      requestData.query_string = normalizedRequest.query_string;\n    }\n    if (include.data) {\n      requestData.data = normalizedRequest.data;\n    }\n    return requestData;\n  }\n});","lineCount":108,"map":[[7,2,121,0,"Object"],[7,8,121,0],[7,9,121,0,"defineProperty"],[7,23,121,0],[7,24,121,0,"exports"],[7,31,121,0],[8,4,121,0,"enumerable"],[8,14,121,0],[9,4,121,0,"get"],[9,7,121,0],[9,18,121,0,"get"],[9,19,121,0],[10,6,121,0],[10,13,121,9,"requestDataIntegration"],[10,35,121,31],[11,4,121,31],[12,2,121,31],[13,2,1,0],[13,6,1,0,"_integrationJs"],[13,20,1,0],[13,23,1,0,"require"],[13,30,1,0],[13,31,1,0,"_dependencyMap"],[13,45,1,0],[14,2,2,0],[14,6,2,0,"_utilsCookieJs"],[14,20,2,0],[14,23,2,0,"require"],[14,30,2,0],[14,31,2,0,"_dependencyMap"],[14,45,2,0],[15,2,3,0],[15,6,3,0,"_vendorGetIpAddressJs"],[15,27,3,0],[15,30,3,0,"require"],[15,37,3,0],[15,38,3,0,"_dependencyMap"],[15,52,3,0],[16,2,5,0],[17,2,6,0],[17,8,6,6,"DEFAULT_INCLUDE"],[17,23,6,21],[17,26,6,24],[18,4,7,2,"cookies"],[18,11,7,9],[18,13,7,11],[18,17,7,15],[19,4,8,2,"data"],[19,8,8,6],[19,10,8,8],[19,14,8,12],[20,4,9,2,"headers"],[20,11,9,9],[20,13,9,11],[20,17,9,15],[21,4,10,2,"query_string"],[21,16,10,14],[21,18,10,16],[21,22,10,20],[22,4,11,2,"url"],[22,7,11,5],[22,9,11,7],[23,2,12,0],[23,3,12,1],[24,2,14,0],[24,8,14,6,"INTEGRATION_NAME"],[24,24,14,22],[24,27,14,25],[24,40,14,38],[25,2,16,0],[25,8,16,6,"_requestDataIntegration"],[25,31,16,29],[25,34,16,33,"_requestDataIntegration"],[25,35,16,34,"options"],[25,42,16,41],[25,45,16,44],[25,46,16,45],[25,47,16,46],[25,52,16,51],[26,4,17,2],[26,10,17,8,"include"],[26,17,17,15],[26,20,17,15,"Object"],[26,26,17,15],[26,27,17,15,"assign"],[26,33,17,15],[26,38,18,7,"DEFAULT_INCLUDE"],[26,53,18,22],[26,55,19,7,"options"],[26,62,19,14],[26,63,19,15,"include"],[26,70,19,22],[26,71,20,3],[27,4,22,2],[27,11,22,9],[28,6,23,4,"name"],[28,10,23,8],[28,12,23,10,"INTEGRATION_NAME"],[28,28,23,26],[29,6,24,4,"processEvent"],[29,18,24,16,"processEvent"],[29,19,24,17,"event"],[29,24,24,22],[29,26,24,24,"_hint"],[29,31,24,29],[29,33,24,31,"client"],[29,39,24,37],[29,41,24,39],[30,8,25,6],[30,14,25,12],[31,10,25,14,"sdkProcessingMetadata"],[31,31,25,35],[31,34,25,38],[31,35,25,39],[32,8,25,41],[32,9,25,42],[32,12,25,45,"event"],[32,17,25,50],[33,8,26,6],[33,14,26,12],[34,10,26,14,"normalizedRequest"],[34,27,26,31],[35,10,26,33,"ipAddress"],[36,8,26,43],[36,9,26,44],[36,12,26,47,"sdkProcessingMetadata"],[36,33,26,68],[37,8,28,6],[37,14,28,12,"includeWithDefaultPiiApplied"],[37,42,28,40],[37,45,28,40,"Object"],[37,51,28,40],[37,52,28,40,"assign"],[37,58,28,40],[37,63,29,11,"include"],[37,70,29,18],[38,10,30,8,"ip"],[38,12,30,10],[38,14,30,12,"include"],[38,21,30,19],[38,22,30,20,"ip"],[38,24,30,22],[38,28,30,26,"client"],[38,34,30,32],[38,35,30,33,"getOptions"],[38,45,30,43],[38,46,30,44],[38,47,30,45],[38,48,30,46,"sendDefaultPii"],[39,8,30,60],[39,10,31,7],[40,8,33,6],[40,12,33,10,"normalizedRequest"],[40,29,33,27],[40,31,33,29],[41,10,34,8,"addNormalizedRequestDataToEvent"],[41,41,34,39],[41,42,34,40,"event"],[41,47,34,45],[41,49,34,47,"normalizedRequest"],[41,66,34,64],[41,68,34,66],[42,12,34,68,"ipAddress"],[43,10,34,78],[43,11,34,79],[43,13,34,81,"includeWithDefaultPiiApplied"],[43,41,34,109],[43,42,34,110],[44,8,35,6],[45,8,37,6],[45,15,37,13,"event"],[45,20,37,18],[46,6,38,4],[47,4,39,2],[47,5,39,3],[48,2,40,0],[48,3,40,2],[50,2,42,0],[51,0,43,0],[52,0,44,0],[53,0,45,0],[54,2,46,0],[54,8,46,6,"requestDataIntegration"],[54,30,46,28],[54,33,46,31],[54,37,46,31,"defineIntegration"],[54,51,46,48],[54,52,46,48,"defineIntegration"],[54,69,46,48],[54,71,46,49,"_requestDataIntegration"],[54,94,46,72],[54,95,46,73],[56,2,48,0],[57,0,49,0],[58,0,50,0],[59,0,51,0],[60,2,52,0],[60,11,52,9,"addNormalizedRequestDataToEvent"],[60,42,52,40,"addNormalizedRequestDataToEvent"],[60,43,53,2,"event"],[60,48,53,7],[60,50,54,2,"req"],[60,53,54,5],[61,2,55,2],[62,2,56,2,"additionalData"],[62,16,56,16],[62,18,57,2,"include"],[62,25,57,9],[62,27,58,2],[63,4,59,2,"event"],[63,9,59,7],[63,10,59,8,"request"],[63,17,59,15],[63,20,59,15,"Object"],[63,26,59,15],[63,27,59,15,"assign"],[63,33,59,15],[63,38,60,7,"event"],[63,43,60,12],[63,44,60,13,"request"],[63,51,60,20],[63,53,61,7,"extractNormalizedRequestData"],[63,81,61,35],[63,82,61,36,"req"],[63,85,61,39],[63,87,61,41,"include"],[63,94,61,48],[63,95,61,49],[63,96,62,3],[64,4,64,2],[64,8,64,6,"include"],[64,15,64,13],[64,16,64,14,"ip"],[64,18,64,16],[64,20,64,18],[65,6,65,4],[65,12,65,10,"ip"],[65,14,65,12],[65,17,65,16,"req"],[65,20,65,19],[65,21,65,20,"headers"],[65,28,65,27],[65,32,65,31],[65,36,65,31,"getClientIPAddress"],[65,57,65,49],[65,58,65,49,"getClientIPAddress"],[65,76,65,49],[65,78,65,50,"req"],[65,81,65,53],[65,82,65,54,"headers"],[65,89,65,61],[65,90,65,62],[65,94,65,67,"additionalData"],[65,108,65,81],[65,109,65,82,"ipAddress"],[65,118,65,91],[66,6,66,4],[66,10,66,8,"ip"],[66,12,66,10],[66,14,66,12],[67,8,67,6,"event"],[67,13,67,11],[67,14,67,12,"user"],[67,18,67,16],[67,21,67,16,"Object"],[67,27,67,16],[67,28,67,16,"assign"],[67,34,67,16],[67,39,68,11,"event"],[67,44,68,16],[67,45,68,17,"user"],[67,49,68,21],[68,10,69,8,"ip_address"],[68,20,69,18],[68,22,69,20,"ip"],[69,8,69,22],[69,10,70,7],[70,6,71,4],[71,4,72,2],[72,2,73,0],[73,2,75,0],[73,11,75,9,"extractNormalizedRequestData"],[73,39,75,37,"extractNormalizedRequestData"],[73,40,76,2,"normalizedRequest"],[73,57,76,19],[73,59,77,2,"include"],[73,66,77,9],[73,68,78,2],[74,4,79,2],[74,10,79,8,"requestData"],[74,21,79,19],[74,24,79,22],[74,25,79,23],[74,26,79,24],[75,4,80,2],[75,10,80,8,"headers"],[75,17,80,15],[75,20,80,15,"Object"],[75,26,80,15],[75,27,80,15,"assign"],[75,33,80,15],[75,38,80,23,"normalizedRequest"],[75,55,80,40],[75,56,80,41,"headers"],[75,63,80,48],[75,64,80,50],[76,4,82,2],[76,8,82,6,"include"],[76,15,82,13],[76,16,82,14,"headers"],[76,23,82,21],[76,25,82,23],[77,6,83,4,"requestData"],[77,17,83,15],[77,18,83,16,"headers"],[77,25,83,23],[77,28,83,26,"headers"],[77,35,83,33],[79,6,85,4],[80,6,86,4],[80,10,86,8],[80,11,86,9,"include"],[80,18,86,16],[80,19,86,17,"cookies"],[80,26,86,24],[80,28,86,26],[81,8,87,6],[81,15,87,14,"headers"],[81,22,87,21],[81,23,87,24,"cookie"],[81,29,87,30],[82,6,88,4],[84,6,90,4],[85,6,91,4],[85,10,91,8],[85,11,91,9,"include"],[85,18,91,16],[85,19,91,17,"ip"],[85,21,91,19],[85,23,91,21],[86,8,92,6,"ipHeaderNames"],[86,29,92,19],[86,30,92,19,"ipHeaderNames"],[86,43,92,19],[86,44,92,20,"forEach"],[86,51,92,27],[86,52,92,28,"ipHeaderName"],[86,64,92,40],[86,68,92,44],[87,10,93,8],[88,10,94,8],[88,17,94,16,"headers"],[88,24,94,23],[88,25,94,26,"ipHeaderName"],[88,37,94,38],[88,38,94,39],[89,8,95,6],[89,9,95,7],[89,10,95,8],[90,6,96,4],[91,4,97,2],[92,4,99,2,"requestData"],[92,15,99,13],[92,16,99,14,"method"],[92,22,99,20],[92,25,99,23,"normalizedRequest"],[92,42,99,40],[92,43,99,41,"method"],[92,49,99,47],[93,4,101,2],[93,8,101,6,"include"],[93,15,101,13],[93,16,101,14,"url"],[93,19,101,17],[93,21,101,19],[94,6,102,4,"requestData"],[94,17,102,15],[94,18,102,16,"url"],[94,21,102,19],[94,24,102,22,"normalizedRequest"],[94,41,102,39],[94,42,102,40,"url"],[94,45,102,43],[95,4,103,2],[96,4,105,2],[96,8,105,6,"include"],[96,15,105,13],[96,16,105,14,"cookies"],[96,23,105,21],[96,25,105,23],[97,6,106,4],[97,12,106,10,"cookies"],[97,19,106,17],[97,22,106,20,"normalizedRequest"],[97,39,106,37],[97,40,106,38,"cookies"],[97,47,106,45],[97,52,106,50,"headers"],[97,59,106,57],[97,61,106,59,"cookie"],[97,67,106,65],[97,70,106,68],[97,74,106,68,"parseCookie"],[97,88,106,79],[97,89,106,79,"parseCookie"],[97,100,106,79],[97,102,106,80,"headers"],[97,109,106,87],[97,110,106,88,"cookie"],[97,116,106,94],[97,117,106,95],[97,120,106,98,"undefined"],[97,129,106,107],[97,130,106,108],[98,6,107,4,"requestData"],[98,17,107,15],[98,18,107,16,"cookies"],[98,25,107,23],[98,28,107,26,"cookies"],[98,35,107,33],[98,39,107,37],[98,40,107,38],[98,41,107,39],[99,4,108,2],[100,4,110,2],[100,8,110,6,"include"],[100,15,110,13],[100,16,110,14,"query_string"],[100,28,110,26],[100,30,110,28],[101,6,111,4,"requestData"],[101,17,111,15],[101,18,111,16,"query_string"],[101,30,111,28],[101,33,111,31,"normalizedRequest"],[101,50,111,48],[101,51,111,49,"query_string"],[101,63,111,61],[102,4,112,2],[103,4,114,2],[103,8,114,6,"include"],[103,15,114,13],[103,16,114,14,"data"],[103,20,114,18],[103,22,114,20],[104,6,115,4,"requestData"],[104,17,115,15],[104,18,115,16,"data"],[104,22,115,20],[104,25,115,23,"normalizedRequest"],[104,42,115,40],[104,43,115,41,"data"],[104,47,115,45],[105,4,116,2],[106,4,118,2],[106,11,118,9,"requestData"],[106,22,118,20],[107,2,119,0],[108,0,119,1],[108,3]],"functionMap":{"names":["<global>","_requestDataIntegration","processEvent","addNormalizedRequestDataToEvent","extractNormalizedRequestData","ipHeaderNames.forEach$argument_0"],"mappings":"AAA;iCCe;ICQ;KDc;CDE;AGY;CHqB;AIE;4BCiB;ODG;CJwB"},"hasCjsExports":false},"type":"js/module"}]}