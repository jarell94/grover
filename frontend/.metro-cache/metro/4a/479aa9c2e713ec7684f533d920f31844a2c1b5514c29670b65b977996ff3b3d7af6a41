{"dependencies":[{"name":"../asyncContext/index.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":67,"index":67}}],"key":"0lgbsiOKFlLN56kb6TORm/gLqf8=","exportNames":["*"],"imports":1}},{"name":"../carrier.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":68},"end":{"line":2,"column":47,"index":115}}],"key":"/CHWq5A6N7GxVM0vQJS3tsMdXuE=","exportNames":["*"],"imports":1}},{"name":"../currentScopes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":116},"end":{"line":3,"column":65,"index":181}}],"key":"4IMzW1L9FGOQbFYVibN4P3pVG0E=","exportNames":["*"],"imports":1}},{"name":"../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":182},"end":{"line":4,"column":42,"index":224}}],"key":"PyiI6yM07W7J+gN2cHiTPsTCV4c=","exportNames":["*"],"imports":1}},{"name":"./debug-logger.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":225},"end":{"line":5,"column":42,"index":267}}],"key":"VSeoyyJzODV++e70LcO1jVtvSwg=","exportNames":["*"],"imports":1}},{"name":"./spanUtils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":268},"end":{"line":6,"column":91,"index":359}}],"key":"pE6EbrkYaK+zZjEPcLbMGlNIybs=","exportNames":["*"],"imports":1}},{"name":"../tracing/dynamicSamplingContext.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":360},"end":{"line":7,"column":125,"index":485}}],"key":"FvwhgvpQZsL+PnAoapZrk+Q+d08=","exportNames":["*"],"imports":1}},{"name":"./baggage.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":486},"end":{"line":8,"column":75,"index":561}}],"key":"YLOHW1rZiihehep84TQ0K/MkF3E=","exportNames":["*"],"imports":1}},{"name":"./tracing.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":9,"column":0,"index":562},"end":{"line":9,"column":104,"index":666}}],"key":"/BFmc2J2ETDGb0NsBczfU3vlDXI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"getTraceData\", {\n    enumerable: true,\n    get: function () {\n      return getTraceData;\n    }\n  });\n  var _asyncContextIndexJs = require(_dependencyMap[0], \"../asyncContext/index.js\");\n  var _carrierJs = require(_dependencyMap[1], \"../carrier.js\");\n  var _currentScopesJs = require(_dependencyMap[2], \"../currentScopes.js\");\n  var _exportsJs = require(_dependencyMap[3], \"../exports.js\");\n  var _debugLoggerJs = require(_dependencyMap[4], \"./debug-logger.js\");\n  var _spanUtilsJs = require(_dependencyMap[5], \"./spanUtils.js\");\n  var _tracingDynamicSamplingContextJs = require(_dependencyMap[6], \"../tracing/dynamicSamplingContext.js\");\n  var _baggageJs = require(_dependencyMap[7], \"./baggage.js\");\n  var _tracingJs = require(_dependencyMap[8], \"./tracing.js\");\n  /**\n   * Extracts trace propagation data from the current span or from the client's scope (via transaction or propagation\n   * context) and serializes it to `sentry-trace` and `baggage` values. These values can be used to propagate\n   * a trace via our tracing Http headers or Html `<meta>` tags.\n   *\n   * This function also applies some validation to the generated sentry-trace and baggage values to ensure that\n   * only valid strings are returned.\n   *\n   * If (@param options.propagateTraceparent) is `true`, the function will also generate a `traceparent` value,\n   * following the W3C traceparent header format.\n   *\n   * @returns an object with the tracing data values. The object keys are the name of the tracing key to be used as header\n   * or meta tag name.\n   */\n  function getTraceData(options = {}) {\n    const client = options.client || (0, _currentScopesJs.getClient)();\n    if (!(0, _exportsJs.isEnabled)() || !client) {\n      return {};\n    }\n    const carrier = (0, _carrierJs.getMainCarrier)();\n    const acs = (0, _asyncContextIndexJs.getAsyncContextStrategy)(carrier);\n    if (acs.getTraceData) {\n      return acs.getTraceData(options);\n    }\n    const scope = options.scope || (0, _currentScopesJs.getCurrentScope)();\n    const span = options.span || (0, _spanUtilsJs.getActiveSpan)();\n    const sentryTrace = span ? (0, _spanUtilsJs.spanToTraceHeader)(span) : scopeToTraceHeader(scope);\n    const dsc = span ? (0, _tracingDynamicSamplingContextJs.getDynamicSamplingContextFromSpan)(span) : (0, _tracingDynamicSamplingContextJs.getDynamicSamplingContextFromScope)(client, scope);\n    const baggage = (0, _baggageJs.dynamicSamplingContextToSentryBaggageHeader)(dsc);\n    const isValidSentryTraceHeader = _tracingJs.TRACEPARENT_REGEXP.test(sentryTrace);\n    if (!isValidSentryTraceHeader) {\n      _debugLoggerJs.debug.warn('Invalid sentry-trace data. Cannot generate trace data');\n      return {};\n    }\n    const traceData = {\n      'sentry-trace': sentryTrace,\n      baggage\n    };\n    if (options.propagateTraceparent) {\n      const traceparent = span ? (0, _spanUtilsJs.spanToTraceparentHeader)(span) : scopeToTraceparentHeader(scope);\n      if (traceparent) {\n        traceData.traceparent = traceparent;\n      }\n    }\n    return traceData;\n  }\n\n  /**\n   * Get a sentry-trace header value for the given scope.\n   */\n  function scopeToTraceHeader(scope) {\n    const {\n      traceId,\n      sampled,\n      propagationSpanId\n    } = scope.getPropagationContext();\n    return (0, _tracingJs.generateSentryTraceHeader)(traceId, propagationSpanId, sampled);\n  }\n  function scopeToTraceparentHeader(scope) {\n    const {\n      traceId,\n      sampled,\n      propagationSpanId\n    } = scope.getPropagationContext();\n    return (0, _tracingJs.generateTraceparentHeader)(traceId, propagationSpanId, sampled);\n  }\n});","lineCount":88,"map":[[7,2,79,0,"Object"],[7,8,79,0],[7,9,79,0,"defineProperty"],[7,23,79,0],[7,24,79,0,"exports"],[7,31,79,0],[8,4,79,0,"enumerable"],[8,14,79,0],[9,4,79,0,"get"],[9,7,79,0],[9,18,79,0,"get"],[9,19,79,0],[10,6,79,0],[10,13,79,9,"getTraceData"],[10,25,79,21],[11,4,79,21],[12,2,79,21],[13,2,1,0],[13,6,1,0,"_asyncContextIndexJs"],[13,26,1,0],[13,29,1,0,"require"],[13,36,1,0],[13,37,1,0,"_dependencyMap"],[13,51,1,0],[14,2,2,0],[14,6,2,0,"_carrierJs"],[14,16,2,0],[14,19,2,0,"require"],[14,26,2,0],[14,27,2,0,"_dependencyMap"],[14,41,2,0],[15,2,3,0],[15,6,3,0,"_currentScopesJs"],[15,22,3,0],[15,25,3,0,"require"],[15,32,3,0],[15,33,3,0,"_dependencyMap"],[15,47,3,0],[16,2,4,0],[16,6,4,0,"_exportsJs"],[16,16,4,0],[16,19,4,0,"require"],[16,26,4,0],[16,27,4,0,"_dependencyMap"],[16,41,4,0],[17,2,5,0],[17,6,5,0,"_debugLoggerJs"],[17,20,5,0],[17,23,5,0,"require"],[17,30,5,0],[17,31,5,0,"_dependencyMap"],[17,45,5,0],[18,2,6,0],[18,6,6,0,"_spanUtilsJs"],[18,18,6,0],[18,21,6,0,"require"],[18,28,6,0],[18,29,6,0,"_dependencyMap"],[18,43,6,0],[19,2,7,0],[19,6,7,0,"_tracingDynamicSamplingContextJs"],[19,38,7,0],[19,41,7,0,"require"],[19,48,7,0],[19,49,7,0,"_dependencyMap"],[19,63,7,0],[20,2,8,0],[20,6,8,0,"_baggageJs"],[20,16,8,0],[20,19,8,0,"require"],[20,26,8,0],[20,27,8,0,"_dependencyMap"],[20,41,8,0],[21,2,9,0],[21,6,9,0,"_tracingJs"],[21,16,9,0],[21,19,9,0,"require"],[21,26,9,0],[21,27,9,0,"_dependencyMap"],[21,41,9,0],[22,2,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,0,18,0],[30,0,19,0],[31,0,20,0],[32,0,21,0],[33,0,22,0],[34,0,23,0],[35,0,24,0],[36,2,25,0],[36,11,25,9,"getTraceData"],[36,23,25,21,"getTraceData"],[36,24,26,2,"options"],[36,31,26,9],[36,34,26,12],[36,35,26,13],[36,36,26,14],[36,38,27,2],[37,4,28,2],[37,10,28,8,"client"],[37,16,28,14],[37,19,28,17,"options"],[37,26,28,24],[37,27,28,25,"client"],[37,33,28,31],[37,37,28,35],[37,41,28,35,"getClient"],[37,57,28,44],[37,58,28,44,"getClient"],[37,67,28,44],[37,69,28,45],[37,70,28,46],[38,4,29,2],[38,8,29,6],[38,9,29,7],[38,13,29,7,"isEnabled"],[38,23,29,16],[38,24,29,16,"isEnabled"],[38,33,29,16],[38,35,29,17],[38,36,29,18],[38,40,29,22],[38,41,29,23,"client"],[38,47,29,29],[38,49,29,31],[39,6,30,4],[39,13,30,11],[39,14,30,12],[39,15,30,13],[40,4,31,2],[41,4,33,2],[41,10,33,8,"carrier"],[41,17,33,15],[41,20,33,18],[41,24,33,18,"getMainCarrier"],[41,34,33,32],[41,35,33,32,"getMainCarrier"],[41,49,33,32],[41,51,33,33],[41,52,33,34],[42,4,34,2],[42,10,34,8,"acs"],[42,13,34,11],[42,16,34,14],[42,20,34,14,"getAsyncContextStrategy"],[42,40,34,37],[42,41,34,37,"getAsyncContextStrategy"],[42,64,34,37],[42,66,34,38,"carrier"],[42,73,34,45],[42,74,34,46],[43,4,35,2],[43,8,35,6,"acs"],[43,11,35,9],[43,12,35,10,"getTraceData"],[43,24,35,22],[43,26,35,24],[44,6,36,4],[44,13,36,11,"acs"],[44,16,36,14],[44,17,36,15,"getTraceData"],[44,29,36,27],[44,30,36,28,"options"],[44,37,36,35],[44,38,36,36],[45,4,37,2],[46,4,39,2],[46,10,39,8,"scope"],[46,15,39,13],[46,18,39,16,"options"],[46,25,39,23],[46,26,39,24,"scope"],[46,31,39,29],[46,35,39,33],[46,39,39,33,"getCurrentScope"],[46,55,39,48],[46,56,39,48,"getCurrentScope"],[46,71,39,48],[46,73,39,49],[46,74,39,50],[47,4,40,2],[47,10,40,8,"span"],[47,14,40,12],[47,17,40,15,"options"],[47,24,40,22],[47,25,40,23,"span"],[47,29,40,27],[47,33,40,31],[47,37,40,31,"getActiveSpan"],[47,49,40,44],[47,50,40,44,"getActiveSpan"],[47,63,40,44],[47,65,40,45],[47,66,40,46],[48,4,41,2],[48,10,41,8,"sentryTrace"],[48,21,41,19],[48,24,41,22,"span"],[48,28,41,26],[48,31,41,29],[48,35,41,29,"spanToTraceHeader"],[48,47,41,46],[48,48,41,46,"spanToTraceHeader"],[48,65,41,46],[48,67,41,47,"span"],[48,71,41,51],[48,72,41,52],[48,75,41,55,"scopeToTraceHeader"],[48,93,41,73],[48,94,41,74,"scope"],[48,99,41,79],[48,100,41,80],[49,4,42,2],[49,10,42,8,"dsc"],[49,13,42,11],[49,16,42,14,"span"],[49,20,42,18],[49,23,42,21],[49,27,42,21,"getDynamicSamplingContextFromSpan"],[49,59,42,54],[49,60,42,54,"getDynamicSamplingContextFromSpan"],[49,93,42,54],[49,95,42,55,"span"],[49,99,42,59],[49,100,42,60],[49,103,42,63],[49,107,42,63,"getDynamicSamplingContextFromScope"],[49,139,42,97],[49,140,42,97,"getDynamicSamplingContextFromScope"],[49,174,42,97],[49,176,42,98,"client"],[49,182,42,104],[49,184,42,106,"scope"],[49,189,42,111],[49,190,42,112],[50,4,43,2],[50,10,43,8,"baggage"],[50,17,43,15],[50,20,43,18],[50,24,43,18,"dynamicSamplingContextToSentryBaggageHeader"],[50,34,43,61],[50,35,43,61,"dynamicSamplingContextToSentryBaggageHeader"],[50,78,43,61],[50,80,43,62,"dsc"],[50,83,43,65],[50,84,43,66],[51,4,45,2],[51,10,45,8,"isValidSentryTraceHeader"],[51,34,45,32],[51,37,45,35,"TRACEPARENT_REGEXP"],[51,47,45,53],[51,48,45,53,"TRACEPARENT_REGEXP"],[51,66,45,53],[51,67,45,54,"test"],[51,71,45,58],[51,72,45,59,"sentryTrace"],[51,83,45,70],[51,84,45,71],[52,4,46,2],[52,8,46,6],[52,9,46,7,"isValidSentryTraceHeader"],[52,33,46,31],[52,35,46,33],[53,6,47,4,"debug"],[53,20,47,9],[53,21,47,9,"debug"],[53,26,47,9],[53,27,47,10,"warn"],[53,31,47,14],[53,32,47,15],[53,87,47,70],[53,88,47,71],[54,6,48,4],[54,13,48,11],[54,14,48,12],[54,15,48,13],[55,4,49,2],[56,4,51,2],[56,10,51,8,"traceData"],[56,19,51,17],[56,22,51,20],[57,6,52,4],[57,20,52,18],[57,22,52,20,"sentryTrace"],[57,33,52,31],[58,6,53,4,"baggage"],[59,4,54,2],[59,5,54,3],[60,4,56,2],[60,8,56,6,"options"],[60,15,56,13],[60,16,56,14,"propagateTraceparent"],[60,36,56,34],[60,38,56,36],[61,6,57,4],[61,12,57,10,"traceparent"],[61,23,57,21],[61,26,57,24,"span"],[61,30,57,28],[61,33,57,31],[61,37,57,31,"spanToTraceparentHeader"],[61,49,57,54],[61,50,57,54,"spanToTraceparentHeader"],[61,73,57,54],[61,75,57,55,"span"],[61,79,57,59],[61,80,57,60],[61,83,57,63,"scopeToTraceparentHeader"],[61,107,57,87],[61,108,57,88,"scope"],[61,113,57,93],[61,114,57,94],[62,6,58,4],[62,10,58,8,"traceparent"],[62,21,58,19],[62,23,58,21],[63,8,59,6,"traceData"],[63,17,59,15],[63,18,59,16,"traceparent"],[63,29,59,27],[63,32,59,30,"traceparent"],[63,43,59,41],[64,6,60,4],[65,4,61,2],[66,4,63,2],[66,11,63,9,"traceData"],[66,20,63,18],[67,2,64,0],[69,2,66,0],[70,0,67,0],[71,0,68,0],[72,2,69,0],[72,11,69,9,"scopeToTraceHeader"],[72,29,69,27,"scopeToTraceHeader"],[72,30,69,28,"scope"],[72,35,69,33],[72,37,69,35],[73,4,70,2],[73,10,70,8],[74,6,70,10,"traceId"],[74,13,70,17],[75,6,70,19,"sampled"],[75,13,70,26],[76,6,70,28,"propagationSpanId"],[77,4,70,46],[77,5,70,47],[77,8,70,50,"scope"],[77,13,70,55],[77,14,70,56,"getPropagationContext"],[77,35,70,77],[77,36,70,78],[77,37,70,79],[78,4,71,2],[78,11,71,9],[78,15,71,9,"generateSentryTraceHeader"],[78,25,71,34],[78,26,71,34,"generateSentryTraceHeader"],[78,51,71,34],[78,53,71,35,"traceId"],[78,60,71,42],[78,62,71,44,"propagationSpanId"],[78,79,71,61],[78,81,71,63,"sampled"],[78,88,71,70],[78,89,71,71],[79,2,72,0],[80,2,74,0],[80,11,74,9,"scopeToTraceparentHeader"],[80,35,74,33,"scopeToTraceparentHeader"],[80,36,74,34,"scope"],[80,41,74,39],[80,43,74,41],[81,4,75,2],[81,10,75,8],[82,6,75,10,"traceId"],[82,13,75,17],[83,6,75,19,"sampled"],[83,13,75,26],[84,6,75,28,"propagationSpanId"],[85,4,75,46],[85,5,75,47],[85,8,75,50,"scope"],[85,13,75,55],[85,14,75,56,"getPropagationContext"],[85,35,75,77],[85,36,75,78],[85,37,75,79],[86,4,76,2],[86,11,76,9],[86,15,76,9,"generateTraceparentHeader"],[86,25,76,34],[86,26,76,34,"generateTraceparentHeader"],[86,51,76,34],[86,53,76,35,"traceId"],[86,60,76,42],[86,62,76,44,"propagationSpanId"],[86,79,76,61],[86,81,76,63,"sampled"],[86,88,76,70],[86,89,76,71],[87,2,77,0],[88,0,77,1],[88,3]],"functionMap":{"names":["<global>","getTraceData","scopeToTraceHeader","scopeToTraceparentHeader"],"mappings":"AAA;ACwB;CDuC;AEK;CFG;AGE;CHG"},"hasCjsExports":false},"type":"js/module"}]}