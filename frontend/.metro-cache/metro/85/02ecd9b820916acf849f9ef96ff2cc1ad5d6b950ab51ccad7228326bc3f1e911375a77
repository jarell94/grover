{"dependencies":[{"name":"../integration.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"B8aKvpmafw58aWtupuC7GWTMiwo=","exportNames":["*"],"imports":1}},{"name":"../utils/path.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":54,"index":109}}],"key":"Sa82m734Od8MEqL/BO7LVp0/eR0=","exportNames":["*"],"imports":1}},{"name":"../utils/worldwide.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":110},"end":{"line":3,"column":51,"index":161}}],"key":"P+UFfr1ne09dGLmc90iZCFaYonQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"generateIteratee\", {\n    enumerable: true,\n    get: function () {\n      return generateIteratee;\n    }\n  });\n  Object.defineProperty(exports, \"rewriteFramesIntegration\", {\n    enumerable: true,\n    get: function () {\n      return rewriteFramesIntegration;\n    }\n  });\n  var _integrationJs = require(_dependencyMap[0], \"../integration.js\");\n  var _utilsPathJs = require(_dependencyMap[1], \"../utils/path.js\");\n  var _utilsWorldwideJs = require(_dependencyMap[2], \"../utils/worldwide.js\");\n  const INTEGRATION_NAME = 'RewriteFrames';\n\n  /**\n   * Rewrite event frames paths.\n   */\n  const rewriteFramesIntegration = (0, _integrationJs.defineIntegration)((options = {}) => {\n    const root = options.root;\n    const prefix = options.prefix || 'app:///';\n    const isBrowser = 'window' in _utilsWorldwideJs.GLOBAL_OBJ && !!_utilsWorldwideJs.GLOBAL_OBJ.window;\n    const iteratee = options.iteratee || generateIteratee({\n      isBrowser,\n      root,\n      prefix\n    });\n\n    /** Process an exception event. */\n    function _processExceptionsEvent(event) {\n      try {\n        return Object.assign({}, event, {\n          exception: Object.assign({}, event.exception, {\n            // The check for this is performed inside `process` call itself, safe to skip here\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            values: event.exception.values.map(value => Object.assign({}, value, value.stacktrace && {\n              stacktrace: _processStacktrace(value.stacktrace)\n            }))\n          })\n        });\n      } catch {\n        return event;\n      }\n    }\n\n    /** Process a stack trace. */\n    function _processStacktrace(stacktrace) {\n      return Object.assign({}, stacktrace, {\n        frames: stacktrace?.frames?.map(f => iteratee(f))\n      });\n    }\n    return {\n      name: INTEGRATION_NAME,\n      processEvent(originalEvent) {\n        let processedEvent = originalEvent;\n        if (originalEvent.exception && Array.isArray(originalEvent.exception.values)) {\n          processedEvent = _processExceptionsEvent(processedEvent);\n        }\n        return processedEvent;\n      }\n    };\n  });\n\n  /**\n   * Exported only for tests.\n   */\n  function generateIteratee({\n    isBrowser,\n    root,\n    prefix\n  }) {\n    return frame => {\n      if (!frame.filename) {\n        return frame;\n      }\n\n      // Determine if this is a Windows frame by checking for a Windows-style prefix such as `C:\\`\n      const isWindowsFrame = /^[a-zA-Z]:\\\\/.test(frame.filename) ||\n      // or the presence of a backslash without a forward slash (which are not allowed on Windows)\n      frame.filename.includes('\\\\') && !frame.filename.includes('/');\n\n      // Check if the frame filename begins with `/`\n      const startsWithSlash = /^\\//.test(frame.filename);\n      if (isBrowser) {\n        if (root) {\n          const oldFilename = frame.filename;\n          if (oldFilename.indexOf(root) === 0) {\n            frame.filename = oldFilename.replace(root, prefix);\n          }\n        }\n      } else {\n        if (isWindowsFrame || startsWithSlash) {\n          const filename = isWindowsFrame ? frame.filename.replace(/^[a-zA-Z]:/, '') // remove Windows-style prefix\n          .replace(/\\\\/g, '/') // replace all `\\\\` instances with `/`\n          : frame.filename;\n          const base = root ? (0, _utilsPathJs.relative)(root, filename) : (0, _utilsPathJs.basename)(filename);\n          frame.filename = `${prefix}${base}`;\n        }\n      }\n      return frame;\n    };\n  }\n});","lineCount":111,"map":[[7,2,107,0,"Object"],[7,8,107,0],[7,9,107,0,"defineProperty"],[7,23,107,0],[7,24,107,0,"exports"],[7,31,107,0],[8,4,107,0,"enumerable"],[8,14,107,0],[9,4,107,0,"get"],[9,7,107,0],[9,18,107,0,"get"],[9,19,107,0],[10,6,107,0],[10,13,107,9,"generateIteratee"],[10,29,107,25],[11,4,107,25],[12,2,107,25],[13,2,107,0,"Object"],[13,8,107,0],[13,9,107,0,"defineProperty"],[13,23,107,0],[13,24,107,0,"exports"],[13,31,107,0],[14,4,107,0,"enumerable"],[14,14,107,0],[15,4,107,0,"get"],[15,7,107,0],[15,18,107,0,"get"],[15,19,107,0],[16,6,107,0],[16,13,107,27,"rewriteFramesIntegration"],[16,37,107,51],[17,4,107,51],[18,2,107,51],[19,2,1,0],[19,6,1,0,"_integrationJs"],[19,20,1,0],[19,23,1,0,"require"],[19,30,1,0],[19,31,1,0,"_dependencyMap"],[19,45,1,0],[20,2,2,0],[20,6,2,0,"_utilsPathJs"],[20,18,2,0],[20,21,2,0,"require"],[20,28,2,0],[20,29,2,0,"_dependencyMap"],[20,43,2,0],[21,2,3,0],[21,6,3,0,"_utilsWorldwideJs"],[21,23,3,0],[21,26,3,0,"require"],[21,33,3,0],[21,34,3,0,"_dependencyMap"],[21,48,3,0],[22,2,5,0],[22,8,5,6,"INTEGRATION_NAME"],[22,24,5,22],[22,27,5,25],[22,42,5,40],[24,2,7,0],[25,0,8,0],[26,0,9,0],[27,2,10,0],[27,8,10,6,"rewriteFramesIntegration"],[27,32,10,30],[27,35,10,33],[27,39,10,33,"defineIntegration"],[27,53,10,50],[27,54,10,50,"defineIntegration"],[27,71,10,50],[27,73,10,51],[27,74,10,52,"options"],[27,81,10,59],[27,84,10,62],[27,85,10,63],[27,86,10,64],[27,91,10,69],[28,4,11,2],[28,10,11,8,"root"],[28,14,11,12],[28,17,11,15,"options"],[28,24,11,22],[28,25,11,23,"root"],[28,29,11,27],[29,4,12,2],[29,10,12,8,"prefix"],[29,16,12,14],[29,19,12,17,"options"],[29,26,12,24],[29,27,12,25,"prefix"],[29,33,12,31],[29,37,12,35],[29,46,12,44],[30,4,14,2],[30,10,14,8,"isBrowser"],[30,19,14,17],[30,22,14,20],[30,30,14,28],[30,34,14,32,"GLOBAL_OBJ"],[30,51,14,42],[30,52,14,42,"GLOBAL_OBJ"],[30,62,14,42],[30,66,14,46],[30,67,14,47],[30,68,14,48,"GLOBAL_OBJ"],[30,85,14,58],[30,86,14,58,"GLOBAL_OBJ"],[30,96,14,58],[30,97,14,59,"window"],[30,103,14,65],[31,4,16,2],[31,10,16,8,"iteratee"],[31,18,16,16],[31,21,16,19,"options"],[31,28,16,26],[31,29,16,27,"iteratee"],[31,37,16,35],[31,41,16,39,"generateIteratee"],[31,57,16,55],[31,58,16,56],[32,6,16,58,"isBrowser"],[32,15,16,67],[33,6,16,69,"root"],[33,10,16,73],[34,6,16,75,"prefix"],[35,4,16,82],[35,5,16,83],[35,6,16,84],[37,4,18,2],[38,4,19,2],[38,13,19,11,"_processExceptionsEvent"],[38,36,19,34,"_processExceptionsEvent"],[38,37,19,35,"event"],[38,42,19,40],[38,44,19,42],[39,6,20,4],[39,10,20,8],[40,8,21,6],[40,15,21,6,"Object"],[40,21,21,6],[40,22,21,6,"assign"],[40,28,21,6],[40,33,22,11,"event"],[40,38,22,16],[41,10,23,8,"exception"],[41,19,23,17],[41,21,23,17,"Object"],[41,27,23,17],[41,28,23,17,"assign"],[41,34,23,17],[41,39,24,13,"event"],[41,44,24,18],[41,45,24,19,"exception"],[41,54,24,28],[42,12,25,10],[43,12,26,10],[44,12,27,10,"values"],[44,18,27,16],[44,20,27,18,"event"],[44,25,27,23],[44,26,27,24,"exception"],[44,35,27,33],[44,36,27,34,"values"],[44,42,27,40],[44,43,27,41,"map"],[44,46,27,44],[44,47,27,45,"value"],[44,52,27,50],[44,56,27,50,"Object"],[44,62,27,50],[44,63,27,50,"assign"],[44,69,27,50],[44,74,28,15,"value"],[44,79,28,20],[44,81,29,16,"value"],[44,86,29,21],[44,87,29,22,"stacktrace"],[44,97,29,32],[44,101,29,36],[45,14,29,38,"stacktrace"],[45,24,29,48],[45,26,29,50,"_processStacktrace"],[45,44,29,68],[45,45,29,69,"value"],[45,50,29,74],[45,51,29,75,"stacktrace"],[45,61,29,85],[46,12,29,87],[46,13,29,88],[46,14,30,12],[47,10,30,13],[48,8,31,9],[49,6,33,4],[49,7,33,5],[49,8,33,6],[49,14,33,12],[50,8,34,6],[50,15,34,13,"event"],[50,20,34,18],[51,6,35,4],[52,4,36,2],[54,4,38,2],[55,4,39,2],[55,13,39,11,"_processStacktrace"],[55,31,39,29,"_processStacktrace"],[55,32,39,30,"stacktrace"],[55,42,39,40],[55,44,39,42],[56,6,40,4],[56,13,40,4,"Object"],[56,19,40,4],[56,20,40,4,"assign"],[56,26,40,4],[56,31,41,9,"stacktrace"],[56,41,41,19],[57,8,42,6,"frames"],[57,14,42,12],[57,16,42,14,"stacktrace"],[57,26,42,24],[57,28,42,26,"frames"],[57,34,42,32],[57,36,42,34,"map"],[57,39,42,37],[57,40,42,38,"f"],[57,41,42,39],[57,45,42,43,"iteratee"],[57,53,42,51],[57,54,42,52,"f"],[57,55,42,53],[57,56,42,54],[58,6,42,55],[59,4,44,2],[60,4,46,2],[60,11,46,9],[61,6,47,4,"name"],[61,10,47,8],[61,12,47,10,"INTEGRATION_NAME"],[61,28,47,26],[62,6,48,4,"processEvent"],[62,18,48,16,"processEvent"],[62,19,48,17,"originalEvent"],[62,32,48,30],[62,34,48,32],[63,8,49,6],[63,12,49,10,"processedEvent"],[63,26,49,24],[63,29,49,27,"originalEvent"],[63,42,49,40],[64,8,51,6],[64,12,51,10,"originalEvent"],[64,25,51,23],[64,26,51,24,"exception"],[64,35,51,33],[64,39,51,37,"Array"],[64,44,51,42],[64,45,51,43,"isArray"],[64,52,51,50],[64,53,51,51,"originalEvent"],[64,66,51,64],[64,67,51,65,"exception"],[64,76,51,74],[64,77,51,75,"values"],[64,83,51,81],[64,84,51,82],[64,86,51,84],[65,10,52,8,"processedEvent"],[65,24,52,22],[65,27,52,25,"_processExceptionsEvent"],[65,50,52,48],[65,51,52,49,"processedEvent"],[65,65,52,63],[65,66,52,64],[66,8,53,6],[67,8,55,6],[67,15,55,13,"processedEvent"],[67,29,55,27],[68,6,56,4],[69,4,57,2],[69,5,57,3],[70,2,58,0],[70,3,58,1],[70,4,58,2],[72,2,60,0],[73,0,61,0],[74,0,62,0],[75,2,63,0],[75,11,63,9,"generateIteratee"],[75,27,63,25,"generateIteratee"],[75,28,63,26],[76,4,64,2,"isBrowser"],[76,13,64,11],[77,4,65,2,"root"],[77,8,65,6],[78,4,66,2,"prefix"],[79,2,67,0],[79,3,67,1],[79,5,69,2],[80,4,70,2],[80,11,70,10,"frame"],[80,16,70,15],[80,20,70,20],[81,6,71,4],[81,10,71,8],[81,11,71,9,"frame"],[81,16,71,14],[81,17,71,15,"filename"],[81,25,71,23],[81,27,71,25],[82,8,72,6],[82,15,72,13,"frame"],[82,20,72,18],[83,6,73,4],[85,6,75,4],[86,6,76,4],[86,12,76,10,"isWindowsFrame"],[86,26,76,24],[86,29,77,6],[86,43,77,20],[86,44,77,21,"test"],[86,48,77,25],[86,49,77,26,"frame"],[86,54,77,31],[86,55,77,32,"filename"],[86,63,77,40],[86,64,77,41],[87,6,78,6],[88,6,79,7,"frame"],[88,11,79,12],[88,12,79,13,"filename"],[88,20,79,21],[88,21,79,22,"includes"],[88,29,79,30],[88,30,79,31],[88,34,79,35],[88,35,79,36],[88,39,79,40],[88,40,79,41,"frame"],[88,45,79,46],[88,46,79,47,"filename"],[88,54,79,55],[88,55,79,56,"includes"],[88,63,79,64],[88,64,79,65],[88,67,79,68],[88,68,79,70],[90,6,81,4],[91,6,82,4],[91,12,82,10,"startsWithSlash"],[91,27,82,25],[91,30,82,28],[91,35,82,33],[91,36,82,34,"test"],[91,40,82,38],[91,41,82,39,"frame"],[91,46,82,44],[91,47,82,45,"filename"],[91,55,82,53],[91,56,82,54],[92,6,84,4],[92,10,84,8,"isBrowser"],[92,19,84,17],[92,21,84,19],[93,8,85,6],[93,12,85,10,"root"],[93,16,85,14],[93,18,85,16],[94,10,86,8],[94,16,86,14,"oldFilename"],[94,27,86,25],[94,30,86,28,"frame"],[94,35,86,33],[94,36,86,34,"filename"],[94,44,86,42],[95,10,87,8],[95,14,87,12,"oldFilename"],[95,25,87,23],[95,26,87,24,"indexOf"],[95,33,87,31],[95,34,87,32,"root"],[95,38,87,36],[95,39,87,37],[95,44,87,42],[95,45,87,43],[95,47,87,45],[96,12,88,10,"frame"],[96,17,88,15],[96,18,88,16,"filename"],[96,26,88,24],[96,29,88,27,"oldFilename"],[96,40,88,38],[96,41,88,39,"replace"],[96,48,88,46],[96,49,88,47,"root"],[96,53,88,51],[96,55,88,53,"prefix"],[96,61,88,59],[96,62,88,60],[97,10,89,8],[98,8,90,6],[99,6,91,4],[99,7,91,5],[99,13,91,11],[100,8,92,6],[100,12,92,10,"isWindowsFrame"],[100,26,92,24],[100,30,92,28,"startsWithSlash"],[100,45,92,43],[100,47,92,45],[101,10,93,8],[101,16,93,14,"filename"],[101,24,93,22],[101,27,93,25,"isWindowsFrame"],[101,41,93,39],[101,44,94,12,"frame"],[101,49,94,17],[101,50,94,18,"filename"],[101,58,94,26],[101,59,95,15,"replace"],[101,66,95,22],[101,67,95,23],[101,79,95,35],[101,81,95,37],[101,83,95,39],[101,84,95,40],[101,85,95,41],[102,10,95,41],[102,11,96,15,"replace"],[102,18,96,22],[102,19,96,23],[102,24,96,28],[102,26,96,30],[102,29,96,33],[102,30,96,34],[102,31,96,35],[103,10,96,35],[103,12,97,12,"frame"],[103,17,97,17],[103,18,97,18,"filename"],[103,26,97,26],[104,10,98,8],[104,16,98,14,"base"],[104,20,98,18],[104,23,98,21,"root"],[104,27,98,25],[104,30,98,28],[104,34,98,28,"relative"],[104,46,98,36],[104,47,98,36,"relative"],[104,55,98,36],[104,57,98,37,"root"],[104,61,98,41],[104,63,98,43,"filename"],[104,71,98,51],[104,72,98,52],[104,75,98,55],[104,79,98,55,"basename"],[104,91,98,63],[104,92,98,63,"basename"],[104,100,98,63],[104,102,98,64,"filename"],[104,110,98,72],[104,111,98,73],[105,10,99,8,"frame"],[105,15,99,13],[105,16,99,14,"filename"],[105,24,99,22],[105,27,99,25],[105,30,99,28,"prefix"],[105,36,99,34],[105,39,99,37,"base"],[105,43,99,41],[105,45,99,43],[106,8,100,6],[107,6,101,4],[108,6,103,4],[108,13,103,11,"frame"],[108,18,103,16],[109,4,104,2],[109,5,104,3],[110,2,105,0],[111,0,105,1],[111,3]],"functionMap":{"names":["<global>","defineIntegration$argument_0","_processExceptionsEvent","event.exception.values.map$argument_0","_processStacktrace","stacktrace.frames.map$argument_0","processEvent","generateIteratee","<anonymous>"],"mappings":"AAA;mDCS;ECS;6CCQ;YDG;GDM;EGG;sCCG,gBD;GHE;IKI;KLQ;CDE;AOK;SCO;GDkC;CPC"},"hasCjsExports":false},"type":"js/module"}]}