{"dependencies":[{"name":"./string.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":48,"index":48}}],"key":"4SgKKWBRWk0zxI3arZcISee7pnU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"reparentChildSpans\", {\n    enumerable: true,\n    get: function () {\n      return reparentChildSpans;\n    }\n  });\n  Object.defineProperty(exports, \"shouldIgnoreSpan\", {\n    enumerable: true,\n    get: function () {\n      return shouldIgnoreSpan;\n    }\n  });\n  var _stringJs = require(_dependencyMap[0], \"./string.js\");\n  /**\n   * Check if a span should be ignored based on the ignoreSpans configuration.\n   */\n  function shouldIgnoreSpan(span, ignoreSpans) {\n    if (!ignoreSpans?.length || !span.description) {\n      return false;\n    }\n    for (const pattern of ignoreSpans) {\n      if (isStringOrRegExp(pattern)) {\n        if ((0, _stringJs.isMatchingPattern)(span.description, pattern)) {\n          return true;\n        }\n        continue;\n      }\n      if (!pattern.name && !pattern.op) {\n        continue;\n      }\n      const nameMatches = pattern.name ? (0, _stringJs.isMatchingPattern)(span.description, pattern.name) : true;\n      const opMatches = pattern.op ? span.op && (0, _stringJs.isMatchingPattern)(span.op, pattern.op) : true;\n\n      // This check here is only correct because we can guarantee that we ran `isMatchingPattern`\n      // for at least one of `nameMatches` and `opMatches`. So in contrary to how this looks,\n      // not both op and name actually have to match. This is the most efficient way to check\n      // for all combinations of name and op patterns.\n      if (nameMatches && opMatches) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Takes a list of spans, and a span that was dropped, and re-parents the child spans of the dropped span to the parent of the dropped span, if possible.\n   * This mutates the spans array in place!\n   */\n  function reparentChildSpans(spans, dropSpan) {\n    const droppedSpanParentId = dropSpan.parent_span_id;\n    const droppedSpanId = dropSpan.span_id;\n\n    // This should generally not happen, as we do not apply this on root spans\n    // but to be safe, we just bail in this case\n    if (!droppedSpanParentId) {\n      return;\n    }\n    for (const span of spans) {\n      if (span.parent_span_id === droppedSpanId) {\n        span.parent_span_id = droppedSpanParentId;\n      }\n    }\n  }\n  function isStringOrRegExp(value) {\n    return typeof value === 'string' || value instanceof RegExp;\n  }\n});","lineCount":73,"map":[[7,2,66,0,"Object"],[7,8,66,0],[7,9,66,0,"defineProperty"],[7,23,66,0],[7,24,66,0,"exports"],[7,31,66,0],[8,4,66,0,"enumerable"],[8,14,66,0],[9,4,66,0,"get"],[9,7,66,0],[9,18,66,0,"get"],[9,19,66,0],[10,6,66,0],[10,13,66,9,"reparentChildSpans"],[10,31,66,27],[11,4,66,27],[12,2,66,27],[13,2,66,0,"Object"],[13,8,66,0],[13,9,66,0,"defineProperty"],[13,23,66,0],[13,24,66,0,"exports"],[13,31,66,0],[14,4,66,0,"enumerable"],[14,14,66,0],[15,4,66,0,"get"],[15,7,66,0],[15,18,66,0,"get"],[15,19,66,0],[16,6,66,0],[16,13,66,29,"shouldIgnoreSpan"],[16,29,66,45],[17,4,66,45],[18,2,66,45],[19,2,1,0],[19,6,1,0,"_stringJs"],[19,15,1,0],[19,18,1,0,"require"],[19,25,1,0],[19,26,1,0,"_dependencyMap"],[19,40,1,0],[20,2,3,0],[21,0,4,0],[22,0,5,0],[23,2,6,0],[23,11,6,9,"shouldIgnoreSpan"],[23,27,6,25,"shouldIgnoreSpan"],[23,28,7,2,"span"],[23,32,7,6],[23,34,8,2,"ignoreSpans"],[23,45,8,13],[23,47,9,2],[24,4,10,2],[24,8,10,6],[24,9,10,7,"ignoreSpans"],[24,20,10,18],[24,22,10,20,"length"],[24,28,10,26],[24,32,10,30],[24,33,10,31,"span"],[24,37,10,35],[24,38,10,36,"description"],[24,49,10,47],[24,51,10,49],[25,6,11,4],[25,13,11,11],[25,18,11,16],[26,4,12,2],[27,4,14,2],[27,9,14,7],[27,15,14,13,"pattern"],[27,22,14,20],[27,26,14,24,"ignoreSpans"],[27,37,14,35],[27,39,14,37],[28,6,15,4],[28,10,15,8,"isStringOrRegExp"],[28,26,15,24],[28,27,15,25,"pattern"],[28,34,15,32],[28,35,15,33],[28,37,15,35],[29,8,16,6],[29,12,16,10],[29,16,16,10,"isMatchingPattern"],[29,25,16,27],[29,26,16,27,"isMatchingPattern"],[29,43,16,27],[29,45,16,28,"span"],[29,49,16,32],[29,50,16,33,"description"],[29,61,16,44],[29,63,16,46,"pattern"],[29,70,16,53],[29,71,16,54],[29,73,16,56],[30,10,17,8],[30,17,17,15],[30,21,17,19],[31,8,18,6],[32,8,19,6],[33,6,20,4],[34,6,22,4],[34,10,22,8],[34,11,22,9,"pattern"],[34,18,22,16],[34,19,22,17,"name"],[34,23,22,21],[34,27,22,25],[34,28,22,26,"pattern"],[34,35,22,33],[34,36,22,34,"op"],[34,38,22,36],[34,40,22,38],[35,8,23,6],[36,6,24,4],[37,6,26,4],[37,12,26,10,"nameMatches"],[37,23,26,21],[37,26,26,24,"pattern"],[37,33,26,31],[37,34,26,32,"name"],[37,38,26,36],[37,41,26,39],[37,45,26,39,"isMatchingPattern"],[37,54,26,56],[37,55,26,56,"isMatchingPattern"],[37,72,26,56],[37,74,26,57,"span"],[37,78,26,61],[37,79,26,62,"description"],[37,90,26,73],[37,92,26,75,"pattern"],[37,99,26,82],[37,100,26,83,"name"],[37,104,26,87],[37,105,26,88],[37,108,26,91],[37,112,26,95],[38,6,27,4],[38,12,27,10,"opMatches"],[38,21,27,19],[38,24,27,22,"pattern"],[38,31,27,29],[38,32,27,30,"op"],[38,34,27,32],[38,37,27,35,"span"],[38,41,27,39],[38,42,27,40,"op"],[38,44,27,42],[38,48,27,46],[38,52,27,46,"isMatchingPattern"],[38,61,27,63],[38,62,27,63,"isMatchingPattern"],[38,79,27,63],[38,81,27,64,"span"],[38,85,27,68],[38,86,27,69,"op"],[38,88,27,71],[38,90,27,73,"pattern"],[38,97,27,80],[38,98,27,81,"op"],[38,100,27,83],[38,101,27,84],[38,104,27,87],[38,108,27,91],[40,6,29,4],[41,6,30,4],[42,6,31,4],[43,6,32,4],[44,6,33,4],[44,10,33,8,"nameMatches"],[44,21,33,19],[44,25,33,23,"opMatches"],[44,34,33,32],[44,36,33,34],[45,8,34,6],[45,15,34,13],[45,19,34,17],[46,6,35,4],[47,4,36,2],[48,4,38,2],[48,11,38,9],[48,16,38,14],[49,2,39,0],[51,2,41,0],[52,0,42,0],[53,0,43,0],[54,0,44,0],[55,2,45,0],[55,11,45,9,"reparentChildSpans"],[55,29,45,27,"reparentChildSpans"],[55,30,45,28,"spans"],[55,35,45,33],[55,37,45,35,"dropSpan"],[55,45,45,43],[55,47,45,45],[56,4,46,2],[56,10,46,8,"droppedSpanParentId"],[56,29,46,27],[56,32,46,30,"dropSpan"],[56,40,46,38],[56,41,46,39,"parent_span_id"],[56,55,46,53],[57,4,47,2],[57,10,47,8,"droppedSpanId"],[57,23,47,21],[57,26,47,24,"dropSpan"],[57,34,47,32],[57,35,47,33,"span_id"],[57,42,47,40],[59,4,49,2],[60,4,50,2],[61,4,51,2],[61,8,51,6],[61,9,51,7,"droppedSpanParentId"],[61,28,51,26],[61,30,51,28],[62,6,52,4],[63,4,53,2],[64,4,55,2],[64,9,55,7],[64,15,55,13,"span"],[64,19,55,17],[64,23,55,21,"spans"],[64,28,55,26],[64,30,55,28],[65,6,56,4],[65,10,56,8,"span"],[65,14,56,12],[65,15,56,13,"parent_span_id"],[65,29,56,27],[65,34,56,32,"droppedSpanId"],[65,47,56,45],[65,49,56,47],[66,8,57,6,"span"],[66,12,57,10],[66,13,57,11,"parent_span_id"],[66,27,57,25],[66,30,57,28,"droppedSpanParentId"],[66,49,57,47],[67,6,58,4],[68,4,59,2],[69,2,60,0],[70,2,62,0],[70,11,62,9,"isStringOrRegExp"],[70,27,62,25,"isStringOrRegExp"],[70,28,62,26,"value"],[70,33,62,31],[70,35,62,33],[71,4,63,2],[71,11,63,9],[71,18,63,16,"value"],[71,23,63,21],[71,28,63,26],[71,36,63,34],[71,40,63,38,"value"],[71,45,63,43],[71,57,63,55,"RegExp"],[71,63,63,61],[72,2,64,0],[73,0,64,1],[73,3]],"functionMap":{"names":["<global>","shouldIgnoreSpan","reparentChildSpans","isStringOrRegExp"],"mappings":"AAA;ACK;CDiC;AEM;CFe;AGE;CHE"},"hasCjsExports":false},"type":"js/module"}]}