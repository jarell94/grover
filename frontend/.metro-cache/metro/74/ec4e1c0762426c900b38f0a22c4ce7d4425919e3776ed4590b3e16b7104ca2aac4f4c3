{"dependencies":[{"name":"../integration.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"B8aKvpmafw58aWtupuC7GWTMiwo=","exportNames":["*"],"imports":1}},{"name":"../metadata.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":88,"index":143}}],"key":"e+GcWU7PM4jYDq7rLAthu62vi9g=","exportNames":["*"],"imports":1}},{"name":"../utils/envelope.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":144},"end":{"line":3,"column":59,"index":203}}],"key":"yiniLg9hHeIHPDkrzeivR1oDz5o=","exportNames":["*"],"imports":1}},{"name":"../utils/stacktrace.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":204},"end":{"line":4,"column":60,"index":264}}],"key":"WpLJaT745+DkgThT6ewjxOGI2qI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"thirdPartyErrorFilterIntegration\", {\n    enumerable: true,\n    get: function () {\n      return thirdPartyErrorFilterIntegration;\n    }\n  });\n  var _integrationJs = require(_dependencyMap[0], \"../integration.js\");\n  var _metadataJs = require(_dependencyMap[1], \"../metadata.js\");\n  var _utilsEnvelopeJs = require(_dependencyMap[2], \"../utils/envelope.js\");\n  var _utilsStacktraceJs = require(_dependencyMap[3], \"../utils/stacktrace.js\");\n  /**\n   * This integration allows you to filter out, or tag error events that do not come from user code marked with a bundle key via the Sentry bundler plugins.\n   */\n  const thirdPartyErrorFilterIntegration = (0, _integrationJs.defineIntegration)(options => {\n    return {\n      name: 'ThirdPartyErrorsFilter',\n      setup(client) {\n        // We need to strip metadata from stack frames before sending them to Sentry since these are client side only.\n        // TODO(lforst): Move this cleanup logic into a more central place in the SDK.\n        client.on('beforeEnvelope', envelope => {\n          (0, _utilsEnvelopeJs.forEachEnvelopeItem)(envelope, (item, type) => {\n            if (type === 'event') {\n              const event = Array.isArray(item) ? item[1] : undefined;\n              if (event) {\n                (0, _metadataJs.stripMetadataFromStackFrames)(event);\n                item[1] = event;\n              }\n            }\n          });\n        });\n        client.on('applyFrameMetadata', event => {\n          // Only apply stack frame metadata to error events\n          if (event.type) {\n            return;\n          }\n          const stackParser = client.getOptions().stackParser;\n          (0, _metadataJs.addMetadataToStackFrames)(stackParser, event);\n        });\n      },\n      processEvent(event) {\n        const frameKeys = getBundleKeysForAllFramesWithFilenames(event);\n        if (frameKeys) {\n          const arrayMethod = options.behaviour === 'drop-error-if-contains-third-party-frames' || options.behaviour === 'apply-tag-if-contains-third-party-frames' ? 'some' : 'every';\n          const behaviourApplies = frameKeys[arrayMethod](keys => !keys.some(key => options.filterKeys.includes(key)));\n          if (behaviourApplies) {\n            const shouldDrop = options.behaviour === 'drop-error-if-contains-third-party-frames' || options.behaviour === 'drop-error-if-exclusively-contains-third-party-frames';\n            if (shouldDrop) {\n              return null;\n            } else {\n              event.tags = Object.assign({}, event.tags, {\n                third_party_code: true\n              });\n            }\n          }\n        }\n        return event;\n      }\n    };\n  });\n  function getBundleKeysForAllFramesWithFilenames(event) {\n    const frames = (0, _utilsStacktraceJs.getFramesFromEvent)(event);\n    if (!frames) {\n      return undefined;\n    }\n    return frames\n    // Exclude frames without a filename since these are likely native code or built-ins\n    .filter(frame => !!frame.filename).map(frame => {\n      if (frame.module_metadata) {\n        return Object.keys(frame.module_metadata).filter(key => key.startsWith(BUNDLER_PLUGIN_APP_KEY_PREFIX)).map(key => key.slice(BUNDLER_PLUGIN_APP_KEY_PREFIX.length));\n      }\n      return [];\n    });\n  }\n  const BUNDLER_PLUGIN_APP_KEY_PREFIX = '_sentryBundlerPluginAppKey:';\n});","lineCount":81,"map":[[7,2,95,0,"Object"],[7,8,95,0],[7,9,95,0,"defineProperty"],[7,23,95,0],[7,24,95,0,"exports"],[7,31,95,0],[8,4,95,0,"enumerable"],[8,14,95,0],[9,4,95,0,"get"],[9,7,95,0],[9,18,95,0,"get"],[9,19,95,0],[10,6,95,0],[10,13,95,9,"thirdPartyErrorFilterIntegration"],[10,45,95,41],[11,4,95,41],[12,2,95,41],[13,2,1,0],[13,6,1,0,"_integrationJs"],[13,20,1,0],[13,23,1,0,"require"],[13,30,1,0],[13,31,1,0,"_dependencyMap"],[13,45,1,0],[14,2,2,0],[14,6,2,0,"_metadataJs"],[14,17,2,0],[14,20,2,0,"require"],[14,27,2,0],[14,28,2,0,"_dependencyMap"],[14,42,2,0],[15,2,3,0],[15,6,3,0,"_utilsEnvelopeJs"],[15,22,3,0],[15,25,3,0,"require"],[15,32,3,0],[15,33,3,0,"_dependencyMap"],[15,47,3,0],[16,2,4,0],[16,6,4,0,"_utilsStacktraceJs"],[16,24,4,0],[16,27,4,0,"require"],[16,34,4,0],[16,35,4,0,"_dependencyMap"],[16,49,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,2,9,0],[20,8,9,6,"thirdPartyErrorFilterIntegration"],[20,40,9,38],[20,43,9,41],[20,47,9,41,"defineIntegration"],[20,61,9,58],[20,62,9,58,"defineIntegration"],[20,79,9,58],[20,81,9,60,"options"],[20,88,9,67],[20,92,9,72],[21,4,10,2],[21,11,10,9],[22,6,11,4,"name"],[22,10,11,8],[22,12,11,10],[22,36,11,34],[23,6,12,4,"setup"],[23,11,12,9,"setup"],[23,12,12,10,"client"],[23,18,12,16],[23,20,12,18],[24,8,13,6],[25,8,14,6],[26,8,15,6,"client"],[26,14,15,12],[26,15,15,13,"on"],[26,17,15,15],[26,18,15,16],[26,34,15,32],[26,36,15,34,"envelope"],[26,44,15,42],[26,48,15,46],[27,10,16,8],[27,14,16,8,"forEachEnvelopeItem"],[27,30,16,27],[27,31,16,27,"forEachEnvelopeItem"],[27,50,16,27],[27,52,16,28,"envelope"],[27,60,16,36],[27,62,16,38],[27,63,16,39,"item"],[27,67,16,43],[27,69,16,45,"type"],[27,73,16,49],[27,78,16,54],[28,12,17,10],[28,16,17,14,"type"],[28,20,17,18],[28,25,17,23],[28,32,17,30],[28,34,17,32],[29,14,18,12],[29,20,18,18,"event"],[29,25,18,23],[29,28,18,26,"Array"],[29,33,18,31],[29,34,18,32,"isArray"],[29,41,18,39],[29,42,18,40,"item"],[29,46,18,44],[29,47,18,45],[29,50,18,49,"item"],[29,54,18,53],[29,55,18,56],[29,56,18,57],[29,57,18,58],[29,60,18,61,"undefined"],[29,69,18,70],[30,14,20,12],[30,18,20,16,"event"],[30,23,20,21],[30,25,20,23],[31,16,21,14],[31,20,21,14,"stripMetadataFromStackFrames"],[31,31,21,42],[31,32,21,42,"stripMetadataFromStackFrames"],[31,60,21,42],[31,62,21,43,"event"],[31,67,21,48],[31,68,21,49],[32,16,22,14,"item"],[32,20,22,18],[32,21,22,19],[32,22,22,20],[32,23,22,21],[32,26,22,24,"event"],[32,31,22,29],[33,14,23,12],[34,12,24,10],[35,10,25,8],[35,11,25,9],[35,12,25,10],[36,8,26,6],[36,9,26,7],[36,10,26,8],[37,8,28,6,"client"],[37,14,28,12],[37,15,28,13,"on"],[37,17,28,15],[37,18,28,16],[37,38,28,36],[37,40,28,38,"event"],[37,45,28,43],[37,49,28,47],[38,10,29,8],[39,10,30,8],[39,14,30,12,"event"],[39,19,30,17],[39,20,30,18,"type"],[39,24,30,22],[39,26,30,24],[40,12,31,10],[41,10,32,8],[42,10,34,8],[42,16,34,14,"stackParser"],[42,27,34,25],[42,30,34,28,"client"],[42,36,34,34],[42,37,34,35,"getOptions"],[42,47,34,45],[42,48,34,46],[42,49,34,47],[42,50,34,48,"stackParser"],[42,61,34,59],[43,10,35,8],[43,14,35,8,"addMetadataToStackFrames"],[43,25,35,32],[43,26,35,32,"addMetadataToStackFrames"],[43,50,35,32],[43,52,35,33,"stackParser"],[43,63,35,44],[43,65,35,46,"event"],[43,70,35,51],[43,71,35,52],[44,8,36,6],[44,9,36,7],[44,10,36,8],[45,6,37,4],[45,7,37,5],[46,6,39,4,"processEvent"],[46,18,39,16,"processEvent"],[46,19,39,17,"event"],[46,24,39,22],[46,26,39,24],[47,8,40,6],[47,14,40,12,"frameKeys"],[47,23,40,21],[47,26,40,24,"getBundleKeysForAllFramesWithFilenames"],[47,64,40,62],[47,65,40,63,"event"],[47,70,40,68],[47,71,40,69],[48,8,42,6],[48,12,42,10,"frameKeys"],[48,21,42,19],[48,23,42,21],[49,10,43,8],[49,16,43,14,"arrayMethod"],[49,27,43,25],[49,30,44,10,"options"],[49,37,44,17],[49,38,44,18,"behaviour"],[49,47,44,27],[49,52,44,32],[49,95,44,75],[49,99,45,10,"options"],[49,106,45,17],[49,107,45,18,"behaviour"],[49,116,45,27],[49,121,45,32],[49,163,45,74],[49,166,46,14],[49,172,46,20],[49,175,47,14],[49,182,47,21],[50,10,49,8],[50,16,49,14,"behaviourApplies"],[50,32,49,30],[50,35,49,33,"frameKeys"],[50,44,49,42],[50,45,49,43,"arrayMethod"],[50,56,49,54],[50,57,49,55],[50,58,49,56,"keys"],[50,62,49,60],[50,66,49,64],[50,67,49,65,"keys"],[50,71,49,69],[50,72,49,70,"some"],[50,76,49,74],[50,77,49,75,"key"],[50,80,49,78],[50,84,49,82,"options"],[50,91,49,89],[50,92,49,90,"filterKeys"],[50,102,49,100],[50,103,49,101,"includes"],[50,111,49,109],[50,112,49,110,"key"],[50,115,49,113],[50,116,49,114],[50,117,49,115],[50,118,49,116],[51,10,51,8],[51,14,51,12,"behaviourApplies"],[51,30,51,28],[51,32,51,30],[52,12,52,10],[52,18,52,16,"shouldDrop"],[52,28,52,26],[52,31,53,12,"options"],[52,38,53,19],[52,39,53,20,"behaviour"],[52,48,53,29],[52,53,53,34],[52,96,53,77],[52,100,54,12,"options"],[52,107,54,19],[52,108,54,20,"behaviour"],[52,117,54,29],[52,122,54,34],[52,177,54,89],[53,12,55,10],[53,16,55,14,"shouldDrop"],[53,26,55,24],[53,28,55,26],[54,14,56,12],[54,21,56,19],[54,25,56,23],[55,12,57,10],[55,13,57,11],[55,19,57,17],[56,14,58,12,"event"],[56,19,58,17],[56,20,58,18,"tags"],[56,24,58,22],[56,27,58,22,"Object"],[56,33,58,22],[56,34,58,22,"assign"],[56,40,58,22],[56,45,59,17,"event"],[56,50,59,22],[56,51,59,23,"tags"],[56,55,59,27],[57,16,60,14,"third_party_code"],[57,32,60,30],[57,34,60,32],[58,14,60,36],[58,16,61,13],[59,12,62,10],[60,10,63,8],[61,8,64,6],[62,8,66,6],[62,15,66,13,"event"],[62,20,66,18],[63,6,67,4],[64,4,68,2],[64,5,68,3],[65,2,69,0],[65,3,69,1],[65,4,69,2],[66,2,71,0],[66,11,71,9,"getBundleKeysForAllFramesWithFilenames"],[66,49,71,47,"getBundleKeysForAllFramesWithFilenames"],[66,50,71,48,"event"],[66,55,71,53],[66,57,71,55],[67,4,72,2],[67,10,72,8,"frames"],[67,16,72,14],[67,19,72,17],[67,23,72,17,"getFramesFromEvent"],[67,41,72,35],[67,42,72,35,"getFramesFromEvent"],[67,60,72,35],[67,62,72,36,"event"],[67,67,72,41],[67,68,72,42],[68,4,74,2],[68,8,74,6],[68,9,74,7,"frames"],[68,15,74,13],[68,17,74,15],[69,6,75,4],[69,13,75,11,"undefined"],[69,22,75,20],[70,4,76,2],[71,4,78,2],[71,11,79,4,"frames"],[72,4,80,6],[73,4,80,6],[73,5,81,7,"filter"],[73,11,81,13],[73,12,81,14,"frame"],[73,17,81,19],[73,21,81,23],[73,22,81,24],[73,23,81,25,"frame"],[73,28,81,30],[73,29,81,31,"filename"],[73,37,81,39],[73,38,81,40],[73,39,82,7,"map"],[73,42,82,10],[73,43,82,11,"frame"],[73,48,82,16],[73,52,82,20],[74,6,83,8],[74,10,83,12,"frame"],[74,15,83,17],[74,16,83,18,"module_metadata"],[74,31,83,33],[74,33,83,35],[75,8,84,10],[75,15,84,17,"Object"],[75,21,84,23],[75,22,84,24,"keys"],[75,26,84,28],[75,27,84,29,"frame"],[75,32,84,34],[75,33,84,35,"module_metadata"],[75,48,84,50],[75,49,84,51],[75,50,85,13,"filter"],[75,56,85,19],[75,57,85,20,"key"],[75,60,85,23],[75,64,85,27,"key"],[75,67,85,30],[75,68,85,31,"startsWith"],[75,78,85,41],[75,79,85,42,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[75,108,85,71],[75,109,85,72],[75,110,85,73],[75,111,86,13,"map"],[75,114,86,16],[75,115,86,17,"key"],[75,118,86,20],[75,122,86,24,"key"],[75,125,86,27],[75,126,86,28,"slice"],[75,131,86,33],[75,132,86,34,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[75,161,86,63],[75,162,86,64,"length"],[75,168,86,70],[75,169,86,71],[75,170,86,72],[76,6,87,8],[77,6,88,8],[77,13,88,15],[77,15,88,17],[78,4,89,6],[78,5,89,7],[78,6,89,8],[79,2,91,0],[80,2,93,0],[80,8,93,6,"BUNDLER_PLUGIN_APP_KEY_PREFIX"],[80,37,93,35],[80,40,93,38],[80,69,93,67],[81,0,93,68],[81,3]],"functionMap":{"names":["<global>","defineIntegration$argument_0","setup","client.on$argument_1","forEachEnvelopeItem$argument_1","processEvent","frameKeys.arrayMethod$argument_0","keys.some$argument_0","getBundleKeysForAllFramesWithFilenames","frames.filter$argument_0","frames.filter.map$argument_0","Object.keys.filter$argument_0","Object.keys.filter.map$argument_0"],"mappings":"AAA;2DCQ;ICG;kCCG;sCCC;SDS;ODC;sCCE;ODQ;KDC;IIE;wDCU,mBC,uCD,CD;KJkB;CDE;AQE;cCU,yBD;WEC;oBCG,oDD;iBEC,sDF;OFG;CRE"},"hasCjsExports":false},"type":"js/module"}]}