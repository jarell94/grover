{"dependencies":[{"name":"../../exports.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"EZPmsHt7bn9JJ4Y0grXw/CrOow0=","exportNames":["*"],"imports":1}},{"name":"../../tracing/spanstatus.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":64,"index":117}}],"key":"xTnLe4eZ8UwJZsOO8L+5TFoq+AE=","exportNames":["*"],"imports":1}},{"name":"../ai/gen-ai-attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":118},"end":{"line":3,"column":193,"index":311}}],"key":"nKHaXfEjIYF1icPUCGJgR0o1cZ8=","exportNames":["*"],"imports":1}},{"name":"./constants.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":312},"end":{"line":4,"column":54,"index":366}}],"key":"46QfplZMuoT7/1B4GqMDknw8q/g=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":367},"end":{"line":5,"column":132,"index":499}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"instrumentStream\", {\n    enumerable: true,\n    get: function () {\n      return instrumentStream;\n    }\n  });\n  var _exportsJs = require(_dependencyMap[0], \"../../exports.js\");\n  var _tracingSpanstatusJs = require(_dependencyMap[1], \"../../tracing/spanstatus.js\");\n  var _aiGenAiAttributesJs = require(_dependencyMap[2], \"../ai/gen-ai-attributes.js\");\n  var _constantsJs = require(_dependencyMap[3], \"./constants.js\");\n  var _utilsJs = require(_dependencyMap[4], \"./utils.js\");\n  /**\n   * State object used to accumulate information from a stream of OpenAI events/chunks.\n   */\n\n  /**\n   * Processes tool calls from a chat completion chunk delta.\n   * Follows the pattern: accumulate by index, then convert to array at the end.\n   *\n   * @param toolCalls - Array of tool calls from the delta.\n   * @param state - The current streaming state to update.\n   *\n   *  @see https://platform.openai.com/docs/guides/function-calling#streaming\n   */\n  function processChatCompletionToolCalls(toolCalls, state) {\n    for (const toolCall of toolCalls) {\n      const index = toolCall.index;\n      if (index === undefined || !toolCall.function) continue;\n\n      // Initialize tool call if this is the first chunk for this index\n      if (!(index in state.chatCompletionToolCalls)) {\n        state.chatCompletionToolCalls[index] = {\n          ...toolCall,\n          function: {\n            name: toolCall.function.name,\n            arguments: toolCall.function.arguments || ''\n          }\n        };\n      } else {\n        // Accumulate function arguments from subsequent chunks\n        const existingToolCall = state.chatCompletionToolCalls[index];\n        if (toolCall.function.arguments && existingToolCall?.function) {\n          existingToolCall.function.arguments += toolCall.function.arguments;\n        }\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI ChatCompletionChunk event, updating the streaming state.\n   *\n   * @param chunk - The ChatCompletionChunk event to process.\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   */\n  function processChatCompletionChunk(chunk, state, recordOutputs) {\n    state.responseId = chunk.id ?? state.responseId;\n    state.responseModel = chunk.model ?? state.responseModel;\n    state.responseTimestamp = chunk.created ?? state.responseTimestamp;\n    if (chunk.usage) {\n      // For stream responses, the input tokens remain constant across all events in the stream.\n      // Output tokens, however, are only finalized in the last event.\n      // Since we can't guarantee that the last event will include usage data or even be a typed event,\n      // we update the output token values on every event that includes them.\n      // This ensures that output token usage is always set, even if the final event lacks it.\n      state.promptTokens = chunk.usage.prompt_tokens;\n      state.completionTokens = chunk.usage.completion_tokens;\n      state.totalTokens = chunk.usage.total_tokens;\n    }\n    for (const choice of chunk.choices ?? []) {\n      if (recordOutputs) {\n        if (choice.delta?.content) {\n          state.responseTexts.push(choice.delta.content);\n        }\n\n        // Handle tool calls from delta\n        if (choice.delta?.tool_calls) {\n          processChatCompletionToolCalls(choice.delta.tool_calls, state);\n        }\n      }\n      if (choice.finish_reason) {\n        state.finishReasons.push(choice.finish_reason);\n      }\n    }\n  }\n\n  /**\n   * Processes a single OpenAI Responses API streaming event, updating the streaming state and span.\n   *\n   * @param streamEvent - The event to process (may be an error or unknown object).\n   * @param state - The current streaming state to update.\n   * @param recordOutputs - Whether to record output text fragments.\n   * @param span - The span to update with error status if needed.\n   */\n  function processResponsesApiEvent(streamEvent, state, recordOutputs, span) {\n    if (!(streamEvent && typeof streamEvent === 'object')) {\n      state.eventTypes.push('unknown:non-object');\n      return;\n    }\n    if (streamEvent instanceof Error) {\n      span.setStatus({\n        code: _tracingSpanstatusJs.SPAN_STATUS_ERROR,\n        message: 'internal_error'\n      });\n      (0, _exportsJs.captureException)(streamEvent, {\n        mechanism: {\n          handled: false,\n          type: 'auto.ai.openai.stream-response'\n        }\n      });\n      return;\n    }\n    if (!('type' in streamEvent)) return;\n    const event = streamEvent;\n    if (!_constantsJs.RESPONSE_EVENT_TYPES.includes(event.type)) {\n      state.eventTypes.push(event.type);\n      return;\n    }\n\n    // Handle output text delta\n    if (recordOutputs) {\n      // Handle tool call events for Responses API\n      if (event.type === 'response.output_item.done' && 'item' in event) {\n        state.responsesApiToolCalls.push(event.item);\n      }\n      if (event.type === 'response.output_text.delta' && 'delta' in event && event.delta) {\n        state.responseTexts.push(event.delta);\n        return;\n      }\n    }\n    if ('response' in event) {\n      const {\n        response\n      } = event;\n      state.responseId = response.id ?? state.responseId;\n      state.responseModel = response.model ?? state.responseModel;\n      state.responseTimestamp = response.created_at ?? state.responseTimestamp;\n      if (response.usage) {\n        // For stream responses, the input tokens remain constant across all events in the stream.\n        // Output tokens, however, are only finalized in the last event.\n        // Since we can't guarantee that the last event will include usage data or even be a typed event,\n        // we update the output token values on every event that includes them.\n        // This ensures that output token usage is always set, even if the final event lacks it.\n        state.promptTokens = response.usage.input_tokens;\n        state.completionTokens = response.usage.output_tokens;\n        state.totalTokens = response.usage.total_tokens;\n      }\n      if (response.status) {\n        state.finishReasons.push(response.status);\n      }\n      if (recordOutputs && response.output_text) {\n        state.responseTexts.push(response.output_text);\n      }\n    }\n  }\n\n  /**\n   * Instruments a stream of OpenAI events, updating the provided span with relevant attributes and\n   * optionally recording output text. This function yields each event from the input stream as it is processed.\n   *\n   * @template T - The type of events in the stream.\n   * @param stream - The async iterable stream of events to instrument.\n   * @param span - The span to add attributes to and to finish at the end of the stream.\n   * @param recordOutputs - Whether to record output text fragments in the span.\n   * @returns An async generator yielding each event from the input stream.\n   */\n  async function* instrumentStream(stream, span, recordOutputs) {\n    const state = {\n      eventTypes: [],\n      responseTexts: [],\n      finishReasons: [],\n      responseId: '',\n      responseModel: '',\n      responseTimestamp: 0,\n      promptTokens: undefined,\n      completionTokens: undefined,\n      totalTokens: undefined,\n      chatCompletionToolCalls: {},\n      responsesApiToolCalls: []\n    };\n    try {\n      for await (const event of stream) {\n        if ((0, _utilsJs.isChatCompletionChunk)(event)) {\n          processChatCompletionChunk(event, state, recordOutputs);\n        } else if ((0, _utilsJs.isResponsesApiStreamEvent)(event)) {\n          processResponsesApiEvent(event, state, recordOutputs, span);\n        }\n        yield event;\n      }\n    } finally {\n      (0, _utilsJs.setCommonResponseAttributes)(span, state.responseId, state.responseModel, state.responseTimestamp);\n      (0, _utilsJs.setTokenUsageAttributes)(span, state.promptTokens, state.completionTokens, state.totalTokens);\n      span.setAttributes({\n        [_aiGenAiAttributesJs.GEN_AI_RESPONSE_STREAMING_ATTRIBUTE]: true\n      });\n      if (state.finishReasons.length) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE]: JSON.stringify(state.finishReasons)\n        });\n      }\n      if (recordOutputs && state.responseTexts.length) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TEXT_ATTRIBUTE]: state.responseTexts.join('')\n        });\n      }\n\n      // Set tool calls attribute if any were accumulated\n      const chatCompletionToolCallsArray = Object.values(state.chatCompletionToolCalls);\n      const allToolCalls = [...chatCompletionToolCallsArray, ...state.responsesApiToolCalls];\n      if (allToolCalls.length > 0) {\n        span.setAttributes({\n          [_aiGenAiAttributesJs.GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE]: JSON.stringify(allToolCalls)\n        });\n      }\n      span.end();\n    }\n  }\n});","lineCount":224,"map":[[7,2,233,0,"Object"],[7,8,233,0],[7,9,233,0,"defineProperty"],[7,23,233,0],[7,24,233,0,"exports"],[7,31,233,0],[8,4,233,0,"enumerable"],[8,14,233,0],[9,4,233,0,"get"],[9,7,233,0],[9,18,233,0,"get"],[9,19,233,0],[10,6,233,0],[10,13,233,9,"instrumentStream"],[10,29,233,25],[11,4,233,25],[12,2,233,25],[13,2,1,0],[13,6,1,0,"_exportsJs"],[13,16,1,0],[13,19,1,0,"require"],[13,26,1,0],[13,27,1,0,"_dependencyMap"],[13,41,1,0],[14,2,2,0],[14,6,2,0,"_tracingSpanstatusJs"],[14,26,2,0],[14,29,2,0,"require"],[14,36,2,0],[14,37,2,0,"_dependencyMap"],[14,51,2,0],[15,2,3,0],[15,6,3,0,"_aiGenAiAttributesJs"],[15,26,3,0],[15,29,3,0,"require"],[15,36,3,0],[15,37,3,0,"_dependencyMap"],[15,51,3,0],[16,2,4,0],[16,6,4,0,"_constantsJs"],[16,18,4,0],[16,21,4,0,"require"],[16,28,4,0],[16,29,4,0,"_dependencyMap"],[16,43,4,0],[17,2,5,0],[17,6,5,0,"_utilsJs"],[17,14,5,0],[17,17,5,0,"require"],[17,24,5,0],[17,25,5,0,"_dependencyMap"],[17,39,5,0],[18,2,7,0],[19,0,8,0],[20,0,9,0],[22,2,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,0,15,0],[27,0,16,0],[28,0,17,0],[29,0,18,0],[30,0,19,0],[31,2,20,0],[31,11,20,9,"processChatCompletionToolCalls"],[31,41,20,39,"processChatCompletionToolCalls"],[31,42,20,40,"toolCalls"],[31,51,20,49],[31,53,20,51,"state"],[31,58,20,56],[31,60,20,58],[32,4,21,2],[32,9,21,7],[32,15,21,13,"toolCall"],[32,23,21,21],[32,27,21,25,"toolCalls"],[32,36,21,34],[32,38,21,36],[33,6,22,4],[33,12,22,10,"index"],[33,17,22,15],[33,20,22,18,"toolCall"],[33,28,22,26],[33,29,22,27,"index"],[33,34,22,32],[34,6,23,4],[34,10,23,8,"index"],[34,15,23,13],[34,20,23,18,"undefined"],[34,29,23,27],[34,33,23,31],[34,34,23,32,"toolCall"],[34,42,23,40],[34,43,23,41,"function"],[34,51,23,49],[34,53,23,51],[36,6,25,4],[37,6,26,4],[37,10,26,8],[37,12,26,10,"index"],[37,17,26,15],[37,21,26,19,"state"],[37,26,26,24],[37,27,26,25,"chatCompletionToolCalls"],[37,50,26,48],[37,51,26,49],[37,53,26,51],[38,8,27,6,"state"],[38,13,27,11],[38,14,27,12,"chatCompletionToolCalls"],[38,37,27,35],[38,38,27,36,"index"],[38,43,27,41],[38,44,27,42],[38,47,27,45],[39,10,28,8],[39,13,28,11,"toolCall"],[39,21,28,19],[40,10,29,8,"function"],[40,18,29,16],[40,20,29,18],[41,12,30,10,"name"],[41,16,30,14],[41,18,30,16,"toolCall"],[41,26,30,24],[41,27,30,25,"function"],[41,35,30,33],[41,36,30,34,"name"],[41,40,30,38],[42,12,31,10,"arguments"],[42,21,31,19],[42,23,31,21,"toolCall"],[42,31,31,29],[42,32,31,30,"function"],[42,40,31,38],[42,41,31,39,"arguments"],[42,50,31,48],[42,54,31,52],[43,10,32,8],[44,8,33,6],[44,9,33,7],[45,6,34,4],[45,7,34,5],[45,13,34,11],[46,8,35,6],[47,8,36,6],[47,14,36,12,"existingToolCall"],[47,30,36,28],[47,33,36,31,"state"],[47,38,36,36],[47,39,36,37,"chatCompletionToolCalls"],[47,62,36,60],[47,63,36,61,"index"],[47,68,36,66],[47,69,36,67],[48,8,37,6],[48,12,37,10,"toolCall"],[48,20,37,18],[48,21,37,19,"function"],[48,29,37,27],[48,30,37,28,"arguments"],[48,39,37,37],[48,43,37,41,"existingToolCall"],[48,59,37,57],[48,61,37,59,"function"],[48,69,37,67],[48,71,37,69],[49,10,38,8,"existingToolCall"],[49,26,38,24],[49,27,38,25,"function"],[49,35,38,33],[49,36,38,34,"arguments"],[49,45,38,43],[49,49,38,47,"toolCall"],[49,57,38,55],[49,58,38,56,"function"],[49,66,38,64],[49,67,38,65,"arguments"],[49,76,38,74],[50,8,39,6],[51,6,40,4],[52,4,41,2],[53,2,42,0],[55,2,44,0],[56,0,45,0],[57,0,46,0],[58,0,47,0],[59,0,48,0],[60,0,49,0],[61,0,50,0],[62,2,51,0],[62,11,51,9,"processChatCompletionChunk"],[62,37,51,35,"processChatCompletionChunk"],[62,38,51,36,"chunk"],[62,43,51,41],[62,45,51,43,"state"],[62,50,51,48],[62,52,51,50,"recordOutputs"],[62,65,51,63],[62,67,51,65],[63,4,52,2,"state"],[63,9,52,7],[63,10,52,8,"responseId"],[63,20,52,18],[63,23,52,21,"chunk"],[63,28,52,26],[63,29,52,27,"id"],[63,31,52,29],[63,35,52,33,"state"],[63,40,52,38],[63,41,52,39,"responseId"],[63,51,52,49],[64,4,53,2,"state"],[64,9,53,7],[64,10,53,8,"responseModel"],[64,23,53,21],[64,26,53,24,"chunk"],[64,31,53,29],[64,32,53,30,"model"],[64,37,53,35],[64,41,53,39,"state"],[64,46,53,44],[64,47,53,45,"responseModel"],[64,60,53,58],[65,4,54,2,"state"],[65,9,54,7],[65,10,54,8,"responseTimestamp"],[65,27,54,25],[65,30,54,28,"chunk"],[65,35,54,33],[65,36,54,34,"created"],[65,43,54,41],[65,47,54,45,"state"],[65,52,54,50],[65,53,54,51,"responseTimestamp"],[65,70,54,68],[66,4,56,2],[66,8,56,6,"chunk"],[66,13,56,11],[66,14,56,12,"usage"],[66,19,56,17],[66,21,56,19],[67,6,57,4],[68,6,58,4],[69,6,59,4],[70,6,60,4],[71,6,61,4],[72,6,62,4,"state"],[72,11,62,9],[72,12,62,10,"promptTokens"],[72,24,62,22],[72,27,62,25,"chunk"],[72,32,62,30],[72,33,62,31,"usage"],[72,38,62,36],[72,39,62,37,"prompt_tokens"],[72,52,62,50],[73,6,63,4,"state"],[73,11,63,9],[73,12,63,10,"completionTokens"],[73,28,63,26],[73,31,63,29,"chunk"],[73,36,63,34],[73,37,63,35,"usage"],[73,42,63,40],[73,43,63,41,"completion_tokens"],[73,60,63,58],[74,6,64,4,"state"],[74,11,64,9],[74,12,64,10,"totalTokens"],[74,23,64,21],[74,26,64,24,"chunk"],[74,31,64,29],[74,32,64,30,"usage"],[74,37,64,35],[74,38,64,36,"total_tokens"],[74,50,64,48],[75,4,65,2],[76,4,67,2],[76,9,67,7],[76,15,67,13,"choice"],[76,21,67,19],[76,25,67,23,"chunk"],[76,30,67,28],[76,31,67,29,"choices"],[76,38,67,36],[76,42,67,40],[76,44,67,42],[76,46,67,44],[77,6,68,4],[77,10,68,8,"recordOutputs"],[77,23,68,21],[77,25,68,23],[78,8,69,6],[78,12,69,10,"choice"],[78,18,69,16],[78,19,69,17,"delta"],[78,24,69,22],[78,26,69,24,"content"],[78,33,69,31],[78,35,69,33],[79,10,70,8,"state"],[79,15,70,13],[79,16,70,14,"responseTexts"],[79,29,70,27],[79,30,70,28,"push"],[79,34,70,32],[79,35,70,33,"choice"],[79,41,70,39],[79,42,70,40,"delta"],[79,47,70,45],[79,48,70,46,"content"],[79,55,70,53],[79,56,70,54],[80,8,71,6],[82,8,73,6],[83,8,74,6],[83,12,74,10,"choice"],[83,18,74,16],[83,19,74,17,"delta"],[83,24,74,22],[83,26,74,24,"tool_calls"],[83,36,74,34],[83,38,74,36],[84,10,75,8,"processChatCompletionToolCalls"],[84,40,75,38],[84,41,75,39,"choice"],[84,47,75,45],[84,48,75,46,"delta"],[84,53,75,51],[84,54,75,52,"tool_calls"],[84,64,75,62],[84,66,75,64,"state"],[84,71,75,69],[84,72,75,70],[85,8,76,6],[86,6,77,4],[87,6,78,4],[87,10,78,8,"choice"],[87,16,78,14],[87,17,78,15,"finish_reason"],[87,30,78,28],[87,32,78,30],[88,8,79,6,"state"],[88,13,79,11],[88,14,79,12,"finishReasons"],[88,27,79,25],[88,28,79,26,"push"],[88,32,79,30],[88,33,79,31,"choice"],[88,39,79,37],[88,40,79,38,"finish_reason"],[88,53,79,51],[88,54,79,52],[89,6,80,4],[90,4,81,2],[91,2,82,0],[93,2,84,0],[94,0,85,0],[95,0,86,0],[96,0,87,0],[97,0,88,0],[98,0,89,0],[99,0,90,0],[100,0,91,0],[101,2,92,0],[101,11,92,9,"processResponsesApiEvent"],[101,35,92,33,"processResponsesApiEvent"],[101,36,93,2,"streamEvent"],[101,47,93,13],[101,49,94,2,"state"],[101,54,94,7],[101,56,95,2,"recordOutputs"],[101,69,95,15],[101,71,96,2,"span"],[101,75,96,6],[101,77,97,2],[102,4,98,2],[102,8,98,6],[102,10,98,8,"streamEvent"],[102,21,98,19],[102,25,98,23],[102,32,98,30,"streamEvent"],[102,43,98,41],[102,48,98,46],[102,56,98,54],[102,57,98,55],[102,59,98,57],[103,6,99,4,"state"],[103,11,99,9],[103,12,99,10,"eventTypes"],[103,22,99,20],[103,23,99,21,"push"],[103,27,99,25],[103,28,99,26],[103,48,99,46],[103,49,99,47],[104,6,100,4],[105,4,101,2],[106,4,102,2],[106,8,102,6,"streamEvent"],[106,19,102,17],[106,31,102,29,"Error"],[106,36,102,34],[106,38,102,36],[107,6,103,4,"span"],[107,10,103,8],[107,11,103,9,"setStatus"],[107,20,103,18],[107,21,103,19],[108,8,103,21,"code"],[108,12,103,25],[108,14,103,27,"SPAN_STATUS_ERROR"],[108,34,103,44],[108,35,103,44,"SPAN_STATUS_ERROR"],[108,52,103,44],[109,8,103,46,"message"],[109,15,103,53],[109,17,103,55],[110,6,103,72],[110,7,103,73],[110,8,103,74],[111,6,104,4],[111,10,104,4,"captureException"],[111,20,104,20],[111,21,104,20,"captureException"],[111,37,104,20],[111,39,104,21,"streamEvent"],[111,50,104,32],[111,52,104,34],[112,8,105,6,"mechanism"],[112,17,105,15],[112,19,105,17],[113,10,106,8,"handled"],[113,17,106,15],[113,19,106,17],[113,24,106,22],[114,10,107,8,"type"],[114,14,107,12],[114,16,107,14],[115,8,108,6],[116,6,109,4],[116,7,109,5],[116,8,109,6],[117,6,110,4],[118,4,111,2],[119,4,113,2],[119,8,113,6],[119,10,113,8],[119,16,113,14],[119,20,113,18,"streamEvent"],[119,31,113,29],[119,32,113,30],[119,34,113,32],[120,4,114,2],[120,10,114,8,"event"],[120,15,114,13],[120,18,114,16,"streamEvent"],[120,29,114,27],[121,4,116,2],[121,8,116,6],[121,9,116,7,"RESPONSE_EVENT_TYPES"],[121,21,116,27],[121,22,116,27,"RESPONSE_EVENT_TYPES"],[121,42,116,27],[121,43,116,28,"includes"],[121,51,116,36],[121,52,116,37,"event"],[121,57,116,42],[121,58,116,43,"type"],[121,62,116,47],[121,63,116,48],[121,65,116,50],[122,6,117,4,"state"],[122,11,117,9],[122,12,117,10,"eventTypes"],[122,22,117,20],[122,23,117,21,"push"],[122,27,117,25],[122,28,117,26,"event"],[122,33,117,31],[122,34,117,32,"type"],[122,38,117,36],[122,39,117,37],[123,6,118,4],[124,4,119,2],[126,4,121,2],[127,4,122,2],[127,8,122,6,"recordOutputs"],[127,21,122,19],[127,23,122,21],[128,6,123,4],[129,6,124,4],[129,10,124,8,"event"],[129,15,124,13],[129,16,124,14,"type"],[129,20,124,18],[129,25,124,23],[129,52,124,50],[129,56,124,54],[129,62,124,60],[129,66,124,64,"event"],[129,71,124,69],[129,73,124,71],[130,8,125,6,"state"],[130,13,125,11],[130,14,125,12,"responsesApiToolCalls"],[130,35,125,33],[130,36,125,34,"push"],[130,40,125,38],[130,41,125,39,"event"],[130,46,125,44],[130,47,125,45,"item"],[130,51,125,49],[130,52,125,50],[131,6,126,4],[132,6,128,4],[132,10,128,8,"event"],[132,15,128,13],[132,16,128,14,"type"],[132,20,128,18],[132,25,128,23],[132,53,128,51],[132,57,128,55],[132,64,128,62],[132,68,128,66,"event"],[132,73,128,71],[132,77,128,75,"event"],[132,82,128,80],[132,83,128,81,"delta"],[132,88,128,86],[132,90,128,88],[133,8,129,6,"state"],[133,13,129,11],[133,14,129,12,"responseTexts"],[133,27,129,25],[133,28,129,26,"push"],[133,32,129,30],[133,33,129,31,"event"],[133,38,129,36],[133,39,129,37,"delta"],[133,44,129,42],[133,45,129,43],[134,8,130,6],[135,6,131,4],[136,4,132,2],[137,4,134,2],[137,8,134,6],[137,18,134,16],[137,22,134,20,"event"],[137,27,134,25],[137,29,134,27],[138,6,135,4],[138,12,135,10],[139,8,135,12,"response"],[140,6,135,21],[140,7,135,22],[140,10,135,25,"event"],[140,15,135,30],[141,6,136,4,"state"],[141,11,136,9],[141,12,136,10,"responseId"],[141,22,136,20],[141,25,136,23,"response"],[141,33,136,31],[141,34,136,32,"id"],[141,36,136,34],[141,40,136,38,"state"],[141,45,136,43],[141,46,136,44,"responseId"],[141,56,136,54],[142,6,137,4,"state"],[142,11,137,9],[142,12,137,10,"responseModel"],[142,25,137,23],[142,28,137,26,"response"],[142,36,137,34],[142,37,137,35,"model"],[142,42,137,40],[142,46,137,44,"state"],[142,51,137,49],[142,52,137,50,"responseModel"],[142,65,137,63],[143,6,138,4,"state"],[143,11,138,9],[143,12,138,10,"responseTimestamp"],[143,29,138,27],[143,32,138,30,"response"],[143,40,138,38],[143,41,138,39,"created_at"],[143,51,138,49],[143,55,138,53,"state"],[143,60,138,58],[143,61,138,59,"responseTimestamp"],[143,78,138,76],[144,6,140,4],[144,10,140,8,"response"],[144,18,140,16],[144,19,140,17,"usage"],[144,24,140,22],[144,26,140,24],[145,8,141,6],[146,8,142,6],[147,8,143,6],[148,8,144,6],[149,8,145,6],[150,8,146,6,"state"],[150,13,146,11],[150,14,146,12,"promptTokens"],[150,26,146,24],[150,29,146,27,"response"],[150,37,146,35],[150,38,146,36,"usage"],[150,43,146,41],[150,44,146,42,"input_tokens"],[150,56,146,54],[151,8,147,6,"state"],[151,13,147,11],[151,14,147,12,"completionTokens"],[151,30,147,28],[151,33,147,31,"response"],[151,41,147,39],[151,42,147,40,"usage"],[151,47,147,45],[151,48,147,46,"output_tokens"],[151,61,147,59],[152,8,148,6,"state"],[152,13,148,11],[152,14,148,12,"totalTokens"],[152,25,148,23],[152,28,148,26,"response"],[152,36,148,34],[152,37,148,35,"usage"],[152,42,148,40],[152,43,148,41,"total_tokens"],[152,55,148,53],[153,6,149,4],[154,6,151,4],[154,10,151,8,"response"],[154,18,151,16],[154,19,151,17,"status"],[154,25,151,23],[154,27,151,25],[155,8,152,6,"state"],[155,13,152,11],[155,14,152,12,"finishReasons"],[155,27,152,25],[155,28,152,26,"push"],[155,32,152,30],[155,33,152,31,"response"],[155,41,152,39],[155,42,152,40,"status"],[155,48,152,46],[155,49,152,47],[156,6,153,4],[157,6,155,4],[157,10,155,8,"recordOutputs"],[157,23,155,21],[157,27,155,25,"response"],[157,35,155,33],[157,36,155,34,"output_text"],[157,47,155,45],[157,49,155,47],[158,8,156,6,"state"],[158,13,156,11],[158,14,156,12,"responseTexts"],[158,27,156,25],[158,28,156,26,"push"],[158,32,156,30],[158,33,156,31,"response"],[158,41,156,39],[158,42,156,40,"output_text"],[158,53,156,51],[158,54,156,52],[159,6,157,4],[160,4,158,2],[161,2,159,0],[163,2,161,0],[164,0,162,0],[165,0,163,0],[166,0,164,0],[167,0,165,0],[168,0,166,0],[169,0,167,0],[170,0,168,0],[171,0,169,0],[172,0,170,0],[173,2,171,0],[173,18,171,16,"instrumentStream"],[173,34,171,32,"instrumentStream"],[173,35,172,2,"stream"],[173,41,172,8],[173,43,173,2,"span"],[173,47,173,6],[173,49,174,2,"recordOutputs"],[173,62,174,15],[173,64,175,2],[174,4,176,2],[174,10,176,8,"state"],[174,15,176,13],[174,18,176,16],[175,6,177,4,"eventTypes"],[175,16,177,14],[175,18,177,16],[175,20,177,18],[176,6,178,4,"responseTexts"],[176,19,178,17],[176,21,178,19],[176,23,178,21],[177,6,179,4,"finishReasons"],[177,19,179,17],[177,21,179,19],[177,23,179,21],[178,6,180,4,"responseId"],[178,16,180,14],[178,18,180,16],[178,20,180,18],[179,6,181,4,"responseModel"],[179,19,181,17],[179,21,181,19],[179,23,181,21],[180,6,182,4,"responseTimestamp"],[180,23,182,21],[180,25,182,23],[180,26,182,24],[181,6,183,4,"promptTokens"],[181,18,183,16],[181,20,183,18,"undefined"],[181,29,183,27],[182,6,184,4,"completionTokens"],[182,22,184,20],[182,24,184,22,"undefined"],[182,33,184,31],[183,6,185,4,"totalTokens"],[183,17,185,15],[183,19,185,17,"undefined"],[183,28,185,26],[184,6,186,4,"chatCompletionToolCalls"],[184,29,186,27],[184,31,186,29],[184,32,186,30],[184,33,186,31],[185,6,187,4,"responsesApiToolCalls"],[185,27,187,25],[185,29,187,27],[186,4,188,2],[186,5,188,3],[187,4,190,2],[187,8,190,6],[188,6,191,4],[188,17,191,15],[188,23,191,21,"event"],[188,28,191,26],[188,32,191,30,"stream"],[188,38,191,36],[188,40,191,38],[189,8,192,6],[189,12,192,10],[189,16,192,10,"isChatCompletionChunk"],[189,24,192,31],[189,25,192,31,"isChatCompletionChunk"],[189,46,192,31],[189,48,192,32,"event"],[189,53,192,37],[189,54,192,38],[189,56,192,40],[190,10,193,8,"processChatCompletionChunk"],[190,36,193,34],[190,37,193,35,"event"],[190,42,193,40],[190,44,193,43,"state"],[190,49,193,48],[190,51,193,50,"recordOutputs"],[190,64,193,63],[190,65,193,64],[191,8,194,6],[191,9,194,7],[191,15,194,13],[191,19,194,17],[191,23,194,17,"isResponsesApiStreamEvent"],[191,31,194,42],[191,32,194,42,"isResponsesApiStreamEvent"],[191,57,194,42],[191,59,194,43,"event"],[191,64,194,48],[191,65,194,49],[191,67,194,51],[192,10,195,8,"processResponsesApiEvent"],[192,34,195,32],[192,35,195,33,"event"],[192,40,195,38],[192,42,195,41,"state"],[192,47,195,46],[192,49,195,48,"recordOutputs"],[192,62,195,61],[192,64,195,63,"span"],[192,68,195,67],[192,69,195,68],[193,8,196,6],[194,8,197,6],[194,14,197,12,"event"],[194,19,197,17],[195,6,198,4],[196,4,199,2],[196,5,199,3],[196,14,199,12],[197,6,200,4],[197,10,200,4,"setCommonResponseAttributes"],[197,18,200,31],[197,19,200,31,"setCommonResponseAttributes"],[197,46,200,31],[197,48,200,32,"span"],[197,52,200,36],[197,54,200,38,"state"],[197,59,200,43],[197,60,200,44,"responseId"],[197,70,200,54],[197,72,200,56,"state"],[197,77,200,61],[197,78,200,62,"responseModel"],[197,91,200,75],[197,93,200,77,"state"],[197,98,200,82],[197,99,200,83,"responseTimestamp"],[197,116,200,100],[197,117,200,101],[198,6,201,4],[198,10,201,4,"setTokenUsageAttributes"],[198,18,201,27],[198,19,201,27,"setTokenUsageAttributes"],[198,42,201,27],[198,44,201,28,"span"],[198,48,201,32],[198,50,201,34,"state"],[198,55,201,39],[198,56,201,40,"promptTokens"],[198,68,201,52],[198,70,201,54,"state"],[198,75,201,59],[198,76,201,60,"completionTokens"],[198,92,201,76],[198,94,201,78,"state"],[198,99,201,83],[198,100,201,84,"totalTokens"],[198,111,201,95],[198,112,201,96],[199,6,203,4,"span"],[199,10,203,8],[199,11,203,9,"setAttributes"],[199,24,203,22],[199,25,203,23],[200,8,204,6],[200,9,204,7,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[200,29,204,42],[200,30,204,42,"GEN_AI_RESPONSE_STREAMING_ATTRIBUTE"],[200,65,204,42],[200,68,204,45],[201,6,205,4],[201,7,205,5],[201,8,205,6],[202,6,207,4],[202,10,207,8,"state"],[202,15,207,13],[202,16,207,14,"finishReasons"],[202,29,207,27],[202,30,207,28,"length"],[202,36,207,34],[202,38,207,36],[203,8,208,6,"span"],[203,12,208,10],[203,13,208,11,"setAttributes"],[203,26,208,24],[203,27,208,25],[204,10,209,8],[204,11,209,9,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[204,31,209,49],[204,32,209,49,"GEN_AI_RESPONSE_FINISH_REASONS_ATTRIBUTE"],[204,72,209,49],[204,75,209,52,"JSON"],[204,79,209,56],[204,80,209,57,"stringify"],[204,89,209,66],[204,90,209,67,"state"],[204,95,209,72],[204,96,209,73,"finishReasons"],[204,109,209,86],[205,8,210,6],[205,9,210,7],[205,10,210,8],[206,6,211,4],[207,6,213,4],[207,10,213,8,"recordOutputs"],[207,23,213,21],[207,27,213,25,"state"],[207,32,213,30],[207,33,213,31,"responseTexts"],[207,46,213,44],[207,47,213,45,"length"],[207,53,213,51],[207,55,213,53],[208,8,214,6,"span"],[208,12,214,10],[208,13,214,11,"setAttributes"],[208,26,214,24],[208,27,214,25],[209,10,215,8],[209,11,215,9,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[209,31,215,39],[209,32,215,39,"GEN_AI_RESPONSE_TEXT_ATTRIBUTE"],[209,62,215,39],[209,65,215,42,"state"],[209,70,215,47],[209,71,215,48,"responseTexts"],[209,84,215,61],[209,85,215,62,"join"],[209,89,215,66],[209,90,215,67],[209,92,215,69],[210,8,216,6],[210,9,216,7],[210,10,216,8],[211,6,217,4],[213,6,219,4],[214,6,220,4],[214,12,220,10,"chatCompletionToolCallsArray"],[214,40,220,38],[214,43,220,41,"Object"],[214,49,220,47],[214,50,220,48,"values"],[214,56,220,54],[214,57,220,55,"state"],[214,62,220,60],[214,63,220,61,"chatCompletionToolCalls"],[214,86,220,84],[214,87,220,85],[215,6,221,4],[215,12,221,10,"allToolCalls"],[215,24,221,22],[215,27,221,25],[215,28,221,26],[215,31,221,29,"chatCompletionToolCallsArray"],[215,59,221,57],[215,61,221,59],[215,64,221,62,"state"],[215,69,221,67],[215,70,221,68,"responsesApiToolCalls"],[215,91,221,89],[215,92,221,90],[216,6,223,4],[216,10,223,8,"allToolCalls"],[216,22,223,20],[216,23,223,21,"length"],[216,29,223,27],[216,32,223,30],[216,33,223,31],[216,35,223,33],[217,8,224,6,"span"],[217,12,224,10],[217,13,224,11,"setAttributes"],[217,26,224,24],[217,27,224,25],[218,10,225,8],[218,11,225,9,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[218,31,225,45],[218,32,225,45,"GEN_AI_RESPONSE_TOOL_CALLS_ATTRIBUTE"],[218,68,225,45],[218,71,225,48,"JSON"],[218,75,225,52],[218,76,225,53,"stringify"],[218,85,225,62],[218,86,225,63,"allToolCalls"],[218,98,225,75],[219,8,226,6],[219,9,226,7],[219,10,226,8],[220,6,227,4],[221,6,229,4,"span"],[221,10,229,8],[221,11,229,9,"end"],[221,14,229,12],[221,15,229,13],[221,16,229,14],[222,4,230,2],[223,2,231,0],[224,0,231,1],[224,3]],"functionMap":{"names":["<global>","processChatCompletionToolCalls","processChatCompletionChunk","processResponsesApiEvent","instrumentStream"],"mappings":"AAA;ACmB;CDsB;AES;CF+B;AGU;CHmE;AIY;CJ4D"},"hasCjsExports":false},"type":"js/module"}]}