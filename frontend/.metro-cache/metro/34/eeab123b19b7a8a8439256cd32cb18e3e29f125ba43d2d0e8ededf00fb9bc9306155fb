{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":55,"index":55}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"./debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":56},"end":{"line":2,"column":47,"index":103}}],"key":"nOZ2HunKnzL39LFdYoJbtaXPZ5g=","exportNames":["*"],"imports":1}},{"name":"./types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":36,"index":140}}],"key":"yJvqu7zVoaSgx/LOxsKU/6eppkQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"clearCachedImplementation\", {\n    enumerable: true,\n    get: function () {\n      return clearCachedImplementation;\n    }\n  });\n  Object.defineProperty(exports, \"fetch\", {\n    enumerable: true,\n    get: function () {\n      return fetch;\n    }\n  });\n  Object.defineProperty(exports, \"getNativeImplementation\", {\n    enumerable: true,\n    get: function () {\n      return getNativeImplementation;\n    }\n  });\n  Object.defineProperty(exports, \"setTimeout\", {\n    enumerable: true,\n    get: function () {\n      return setTimeout;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  var _debugBuildJs = require(_dependencyMap[1], \"./debug-build.js\");\n  var _typesJs = require(_dependencyMap[2], \"./types.js\");\n  /**\n   * We generally want to use window.fetch / window.setTimeout.\n   * However, in some cases this may be wrapped (e.g. by Zone.js for Angular),\n   * so we try to get an unpatched version of this from a sandboxed iframe.\n   */\n\n  const cachedImplementations = {};\n\n  /**\n   * Get the native implementation of a browser function.\n   *\n   * This can be used to ensure we get an unwrapped version of a function, in cases where a wrapped function can lead to problems.\n   *\n   * The following methods can be retrieved:\n   * - `setTimeout`: This can be wrapped by e.g. Angular, causing change detection to be triggered.\n   * - `fetch`: This can be wrapped by e.g. ad-blockers, causing an infinite loop when a request is blocked.\n   */\n  function getNativeImplementation(name) {\n    const cached = cachedImplementations[name];\n    if (cached) {\n      return cached;\n    }\n    let impl = _typesJs.WINDOW[name];\n\n    // Fast path to avoid DOM I/O\n    if ((0, _sentryCore.isNativeFunction)(impl)) {\n      return cachedImplementations[name] = impl.bind(_typesJs.WINDOW);\n    }\n    const document = _typesJs.WINDOW.document;\n    // eslint-disable-next-line deprecation/deprecation\n    if (document && typeof document.createElement === 'function') {\n      try {\n        const sandbox = document.createElement('iframe');\n        sandbox.hidden = true;\n        document.head.appendChild(sandbox);\n        const contentWindow = sandbox.contentWindow;\n        if (contentWindow?.[name]) {\n          impl = contentWindow[name];\n        }\n        document.head.removeChild(sandbox);\n      } catch (e) {\n        // Could not create sandbox iframe, just use window.xxx\n        _debugBuildJs.DEBUG_BUILD && _sentryCore.debug.warn(`Could not create sandbox iframe for ${name} check, bailing to window.${name}: `, e);\n      }\n    }\n\n    // Sanity check: This _should_ not happen, but if it does, we just skip caching...\n    // This can happen e.g. in tests where fetch may not be available in the env, or similar.\n    if (!impl) {\n      return impl;\n    }\n    return cachedImplementations[name] = impl.bind(_typesJs.WINDOW);\n  }\n\n  /** Clear a cached implementation. */\n  function clearCachedImplementation(name) {\n    cachedImplementations[name] = undefined;\n  }\n\n  /**\n   * A special usecase for incorrectly wrapped Fetch APIs in conjunction with ad-blockers.\n   * Whenever someone wraps the Fetch API and returns the wrong promise chain,\n   * this chain becomes orphaned and there is no possible way to capture it's rejections\n   * other than allowing it bubble up to this very handler. eg.\n   *\n   * const f = window.fetch;\n   * window.fetch = function () {\n   *   const p = f.apply(this, arguments);\n   *\n   *   p.then(function() {\n   *     console.log('hi.');\n   *   });\n   *\n   *   return p;\n   * }\n   *\n   * `p.then(function () { ... })` is producing a completely separate promise chain,\n   * however, what's returned is `p` - the result of original `fetch` call.\n   *\n   * This mean, that whenever we use the Fetch API to send our own requests, _and_\n   * some ad-blocker blocks it, this orphaned chain will _always_ reject,\n   * effectively causing another event to be captured.\n   * This makes a whole process become an infinite loop, which we need to somehow\n   * deal with, and break it in one way or another.\n   *\n   * To deal with this issue, we are making sure that we _always_ use the real\n   * browser Fetch API, instead of relying on what `window.fetch` exposes.\n   * The only downside to this would be missing our own requests as breadcrumbs,\n   * but because we are already not doing this, it should be just fine.\n   *\n   * Possible failed fetch error messages per-browser:\n   *\n   * Chrome:  Failed to fetch\n   * Edge:    Failed to Fetch\n   * Firefox: NetworkError when attempting to fetch resource\n   * Safari:  resource blocked by content blocker\n   */\n  function fetch(...rest) {\n    return getNativeImplementation('fetch')(...rest);\n  }\n\n  /**\n   * Get an unwrapped `setTimeout` method.\n   * This ensures that even if e.g. Angular wraps `setTimeout`, we get the native implementation,\n   * avoiding triggering change detection.\n   */\n  function setTimeout(...rest) {\n    return getNativeImplementation('setTimeout')(...rest);\n  }\n});","lineCount":143,"map":[[7,2,120,0,"Object"],[7,8,120,0],[7,9,120,0,"defineProperty"],[7,23,120,0],[7,24,120,0,"exports"],[7,31,120,0],[8,4,120,0,"enumerable"],[8,14,120,0],[9,4,120,0,"get"],[9,7,120,0],[9,18,120,0,"get"],[9,19,120,0],[10,6,120,0],[10,13,120,9,"clearCachedImplementation"],[10,38,120,34],[11,4,120,34],[12,2,120,34],[13,2,120,0,"Object"],[13,8,120,0],[13,9,120,0,"defineProperty"],[13,23,120,0],[13,24,120,0,"exports"],[13,31,120,0],[14,4,120,0,"enumerable"],[14,14,120,0],[15,4,120,0,"get"],[15,7,120,0],[15,18,120,0,"get"],[15,19,120,0],[16,6,120,0],[16,13,120,36,"fetch"],[16,18,120,41],[17,4,120,41],[18,2,120,41],[19,2,120,0,"Object"],[19,8,120,0],[19,9,120,0,"defineProperty"],[19,23,120,0],[19,24,120,0,"exports"],[19,31,120,0],[20,4,120,0,"enumerable"],[20,14,120,0],[21,4,120,0,"get"],[21,7,120,0],[21,18,120,0,"get"],[21,19,120,0],[22,6,120,0],[22,13,120,43,"getNativeImplementation"],[22,36,120,66],[23,4,120,66],[24,2,120,66],[25,2,120,0,"Object"],[25,8,120,0],[25,9,120,0,"defineProperty"],[25,23,120,0],[25,24,120,0,"exports"],[25,31,120,0],[26,4,120,0,"enumerable"],[26,14,120,0],[27,4,120,0,"get"],[27,7,120,0],[27,18,120,0,"get"],[27,19,120,0],[28,6,120,0],[28,13,120,68,"setTimeout"],[28,23,120,78],[29,4,120,78],[30,2,120,78],[31,2,1,0],[31,6,1,0,"_sentryCore"],[31,17,1,0],[31,20,1,0,"require"],[31,27,1,0],[31,28,1,0,"_dependencyMap"],[31,42,1,0],[32,2,2,0],[32,6,2,0,"_debugBuildJs"],[32,19,2,0],[32,22,2,0,"require"],[32,29,2,0],[32,30,2,0,"_dependencyMap"],[32,44,2,0],[33,2,3,0],[33,6,3,0,"_typesJs"],[33,14,3,0],[33,17,3,0,"require"],[33,24,3,0],[33,25,3,0,"_dependencyMap"],[33,39,3,0],[34,2,5,0],[35,0,6,0],[36,0,7,0],[37,0,8,0],[38,0,9,0],[40,2,11,0],[40,8,11,6,"cachedImplementations"],[40,29,11,27],[40,32,11,30],[40,33,11,31],[40,34,11,32],[42,2,13,0],[43,0,14,0],[44,0,15,0],[45,0,16,0],[46,0,17,0],[47,0,18,0],[48,0,19,0],[49,0,20,0],[50,0,21,0],[51,2,22,0],[51,11,22,9,"getNativeImplementation"],[51,34,22,32,"getNativeImplementation"],[51,35,23,2,"name"],[51,39,23,6],[51,41,24,2],[52,4,25,2],[52,10,25,8,"cached"],[52,16,25,14],[52,19,25,17,"cachedImplementations"],[52,40,25,38],[52,41,25,39,"name"],[52,45,25,43],[52,46,25,44],[53,4,26,2],[53,8,26,6,"cached"],[53,14,26,12],[53,16,26,14],[54,6,27,4],[54,13,27,11,"cached"],[54,19,27,17],[55,4,28,2],[56,4,30,2],[56,8,30,6,"impl"],[56,12,30,10],[56,15,30,13,"WINDOW"],[56,23,30,19],[56,24,30,19,"WINDOW"],[56,30,30,19],[56,31,30,20,"name"],[56,35,30,24],[56,36,30,25],[58,4,32,2],[59,4,33,2],[59,8,33,6],[59,12,33,6,"isNativeFunction"],[59,23,33,22],[59,24,33,22,"isNativeFunction"],[59,40,33,22],[59,42,33,23,"impl"],[59,46,33,27],[59,47,33,28],[59,49,33,30],[60,6,34,4],[60,13,34,12,"cachedImplementations"],[60,34,34,33],[60,35,34,34,"name"],[60,39,34,38],[60,40,34,39],[60,43,34,42,"impl"],[60,47,34,46],[60,48,34,47,"bind"],[60,52,34,51],[60,53,34,52,"WINDOW"],[60,61,34,58],[60,62,34,58,"WINDOW"],[60,68,34,58],[60,69,34,59],[61,4,35,2],[62,4,37,2],[62,10,37,8,"document"],[62,18,37,16],[62,21,37,19,"WINDOW"],[62,29,37,25],[62,30,37,25,"WINDOW"],[62,36,37,25],[62,37,37,26,"document"],[62,45,37,34],[63,4,38,2],[64,4,39,2],[64,8,39,6,"document"],[64,16,39,14],[64,20,39,18],[64,27,39,25,"document"],[64,35,39,33],[64,36,39,34,"createElement"],[64,49,39,47],[64,54,39,52],[64,64,39,62],[64,66,39,64],[65,6,40,4],[65,10,40,8],[66,8,41,6],[66,14,41,12,"sandbox"],[66,21,41,19],[66,24,41,22,"document"],[66,32,41,30],[66,33,41,31,"createElement"],[66,46,41,44],[66,47,41,45],[66,55,41,53],[66,56,41,54],[67,8,42,6,"sandbox"],[67,15,42,13],[67,16,42,14,"hidden"],[67,22,42,20],[67,25,42,23],[67,29,42,27],[68,8,43,6,"document"],[68,16,43,14],[68,17,43,15,"head"],[68,21,43,19],[68,22,43,20,"appendChild"],[68,33,43,31],[68,34,43,32,"sandbox"],[68,41,43,39],[68,42,43,40],[69,8,44,6],[69,14,44,12,"contentWindow"],[69,27,44,25],[69,30,44,28,"sandbox"],[69,37,44,35],[69,38,44,36,"contentWindow"],[69,51,44,49],[70,8,45,6],[70,12,45,10,"contentWindow"],[70,25,45,23],[70,28,45,26,"name"],[70,32,45,30],[70,33,45,31],[70,35,45,33],[71,10,46,8,"impl"],[71,14,46,12],[71,17,46,15,"contentWindow"],[71,30,46,28],[71,31,46,29,"name"],[71,35,46,33],[71,36,46,34],[72,8,47,6],[73,8,48,6,"document"],[73,16,48,14],[73,17,48,15,"head"],[73,21,48,19],[73,22,48,20,"removeChild"],[73,33,48,31],[73,34,48,32,"sandbox"],[73,41,48,39],[73,42,48,40],[74,6,49,4],[74,7,49,5],[74,8,49,6],[74,15,49,13,"e"],[74,16,49,14],[74,18,49,16],[75,8,50,6],[76,8,51,6,"DEBUG_BUILD"],[76,21,51,17],[76,22,51,17,"DEBUG_BUILD"],[76,33,51,17],[76,37,51,21,"debug"],[76,48,51,26],[76,49,51,26,"debug"],[76,54,51,26],[76,55,51,27,"warn"],[76,59,51,31],[76,60,51,32],[76,99,51,71,"name"],[76,103,51,75],[76,132,51,104,"name"],[76,136,51,108],[76,140,51,112],[76,142,51,114,"e"],[76,143,51,115],[76,144,51,116],[77,6,52,4],[78,4,53,2],[80,4,55,2],[81,4,56,2],[82,4,57,2],[82,8,57,6],[82,9,57,7,"impl"],[82,13,57,11],[82,15,57,13],[83,6,58,4],[83,13,58,11,"impl"],[83,17,58,15],[84,4,59,2],[85,4,61,2],[85,11,61,10,"cachedImplementations"],[85,32,61,31],[85,33,61,32,"name"],[85,37,61,36],[85,38,61,37],[85,41,61,40,"impl"],[85,45,61,44],[85,46,61,45,"bind"],[85,50,61,49],[85,51,61,50,"WINDOW"],[85,59,61,56],[85,60,61,56,"WINDOW"],[85,66,61,56],[85,67,61,57],[86,2,62,0],[88,2,64,0],[89,2,65,0],[89,11,65,9,"clearCachedImplementation"],[89,36,65,34,"clearCachedImplementation"],[89,37,65,35,"name"],[89,41,65,39],[89,43,65,41],[90,4,66,2,"cachedImplementations"],[90,25,66,23],[90,26,66,24,"name"],[90,30,66,28],[90,31,66,29],[90,34,66,32,"undefined"],[90,43,66,41],[91,2,67,0],[93,2,69,0],[94,0,70,0],[95,0,71,0],[96,0,72,0],[97,0,73,0],[98,0,74,0],[99,0,75,0],[100,0,76,0],[101,0,77,0],[102,0,78,0],[103,0,79,0],[104,0,80,0],[105,0,81,0],[106,0,82,0],[107,0,83,0],[108,0,84,0],[109,0,85,0],[110,0,86,0],[111,0,87,0],[112,0,88,0],[113,0,89,0],[114,0,90,0],[115,0,91,0],[116,0,92,0],[117,0,93,0],[118,0,94,0],[119,0,95,0],[120,0,96,0],[121,0,97,0],[122,0,98,0],[123,0,99,0],[124,0,100,0],[125,0,101,0],[126,0,102,0],[127,0,103,0],[128,0,104,0],[129,0,105,0],[130,0,106,0],[131,2,107,0],[131,11,107,9,"fetch"],[131,16,107,14,"fetch"],[131,17,107,15],[131,20,107,18,"rest"],[131,24,107,22],[131,26,107,24],[132,4,108,2],[132,11,108,9,"getNativeImplementation"],[132,34,108,32],[132,35,108,33],[132,42,108,40],[132,43,108,41],[132,44,108,42],[132,47,108,45,"rest"],[132,51,108,49],[132,52,108,50],[133,2,109,0],[135,2,111,0],[136,0,112,0],[137,0,113,0],[138,0,114,0],[139,0,115,0],[140,2,116,0],[140,11,116,9,"setTimeout"],[140,21,116,19,"setTimeout"],[140,22,116,20],[140,25,116,23,"rest"],[140,29,116,27],[140,31,116,29],[141,4,117,2],[141,11,117,9,"getNativeImplementation"],[141,34,117,32],[141,35,117,33],[141,47,117,45],[141,48,117,46],[141,49,117,47],[141,52,117,50,"rest"],[141,56,117,54],[141,57,117,55],[142,2,118,0],[143,0,118,1],[143,3]],"functionMap":{"names":["<global>","getNativeImplementation","clearCachedImplementation","fetch","setTimeout"],"mappings":"AAA;ACqB;CDwC;AEG;CFE;AGwC;CHE;AIO;CJE"},"hasCjsExports":false},"type":"js/module"}]}