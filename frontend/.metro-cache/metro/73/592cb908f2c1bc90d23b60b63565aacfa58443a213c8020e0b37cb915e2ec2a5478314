{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":290,"index":290}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"],"imports":1}},{"name":"../debug-build.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":291},"end":{"line":2,"column":48,"index":339}}],"key":"rfhktnzi6PvZxT1xtyHWbBktN/w=","exportNames":["*"],"imports":1}},{"name":"./instrument.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":340},"end":{"line":3,"column":63,"index":403}}],"key":"/faGONMhKrqQj2KSLxxwco89Hvc=","exportNames":["*"],"imports":1}},{"name":"./utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":404},"end":{"line":4,"column":115,"index":519}}],"key":"NIaSEHO1E48gsZc7jH9Ex1xTHgE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"trackClsAsStandaloneSpan\", {\n    enumerable: true,\n    get: function () {\n      return trackClsAsStandaloneSpan;\n    }\n  });\n  var _sentryCore = require(_dependencyMap[0], \"@sentry/core\");\n  var _debugBuildJs = require(_dependencyMap[1], \"../debug-build.js\");\n  var _instrumentJs = require(_dependencyMap[2], \"./instrument.js\");\n  var _utilsJs = require(_dependencyMap[3], \"./utils.js\");\n  /**\n   * Starts tracking the Cumulative Layout Shift on the current page and collects the value once\n   *\n   * - the page visibility is hidden\n   * - a navigation span is started (to stop CLS measurement for SPA soft navigations)\n   *\n   * Once either of these events triggers, the CLS value is sent as a standalone span and we stop\n   * measuring CLS.\n   */\n  function trackClsAsStandaloneSpan(client) {\n    let standaloneCLsValue = 0;\n    let standaloneClsEntry;\n    if (!(0, _utilsJs.supportsWebVital)('layout-shift')) {\n      return;\n    }\n    const cleanupClsHandler = (0, _instrumentJs.addClsInstrumentationHandler)(({\n      metric\n    }) => {\n      const entry = metric.entries[metric.entries.length - 1];\n      if (!entry) {\n        return;\n      }\n      standaloneCLsValue = metric.value;\n      standaloneClsEntry = entry;\n    }, true);\n    (0, _utilsJs.listenForWebVitalReportEvents)(client, (reportEvent, pageloadSpanId) => {\n      sendStandaloneClsSpan(standaloneCLsValue, standaloneClsEntry, pageloadSpanId, reportEvent);\n      cleanupClsHandler();\n    });\n  }\n  function sendStandaloneClsSpan(clsValue, entry, pageloadSpanId, reportEvent) {\n    _debugBuildJs.DEBUG_BUILD && _sentryCore.debug.log(`Sending CLS span (${clsValue})`);\n    const startTime = (0, _utilsJs.msToSec)(((0, _sentryCore.browserPerformanceTimeOrigin)() || 0) + (entry?.startTime || 0));\n    const routeName = (0, _sentryCore.getCurrentScope)().getScopeData().transactionName;\n    const name = entry ? (0, _sentryCore.htmlTreeAsString)(entry.sources[0]?.node) : 'Layout shift';\n    const attributes = {\n      [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]: 'auto.http.browser.cls',\n      [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_OP]: 'ui.webvital.cls',\n      [_sentryCore.SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME]: entry?.duration || 0,\n      // attach the pageload span id to the CLS span so that we can link them in the UI\n      'sentry.pageload.span_id': pageloadSpanId,\n      // describes what triggered the web vital to be reported\n      'sentry.report_event': reportEvent\n    };\n\n    // Add CLS sources as span attributes to help with debugging layout shifts\n    // See: https://developer.mozilla.org/en-US/docs/Web/API/LayoutShift/sources\n    if (entry?.sources) {\n      entry.sources.forEach((source, index) => {\n        attributes[`cls.source.${index + 1}`] = (0, _sentryCore.htmlTreeAsString)(source.node);\n      });\n    }\n    const span = (0, _utilsJs.startStandaloneWebVitalSpan)({\n      name,\n      transaction: routeName,\n      attributes,\n      startTime\n    });\n    if (span) {\n      span.addEvent('cls', {\n        [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT]: '',\n        [_sentryCore.SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE]: clsValue\n      });\n\n      // LayoutShift performance entries always have a duration of 0, so we don't need to add `entry.duration` here\n      // see: https://developer.mozilla.org/en-US/docs/Web/API/PerformanceEntry/duration\n      span.end(startTime);\n    }\n  }\n});","lineCount":86,"map":[[7,2,88,0,"Object"],[7,8,88,0],[7,9,88,0,"defineProperty"],[7,23,88,0],[7,24,88,0,"exports"],[7,31,88,0],[8,4,88,0,"enumerable"],[8,14,88,0],[9,4,88,0,"get"],[9,7,88,0],[9,18,88,0,"get"],[9,19,88,0],[10,6,88,0],[10,13,88,9,"trackClsAsStandaloneSpan"],[10,37,88,33],[11,4,88,33],[12,2,88,33],[13,2,1,0],[13,6,1,0,"_sentryCore"],[13,17,1,0],[13,20,1,0,"require"],[13,27,1,0],[13,28,1,0,"_dependencyMap"],[13,42,1,0],[14,2,2,0],[14,6,2,0,"_debugBuildJs"],[14,19,2,0],[14,22,2,0,"require"],[14,29,2,0],[14,30,2,0,"_dependencyMap"],[14,44,2,0],[15,2,3,0],[15,6,3,0,"_instrumentJs"],[15,19,3,0],[15,22,3,0,"require"],[15,29,3,0],[15,30,3,0,"_dependencyMap"],[15,44,3,0],[16,2,4,0],[16,6,4,0,"_utilsJs"],[16,14,4,0],[16,17,4,0,"require"],[16,24,4,0],[16,25,4,0,"_dependencyMap"],[16,39,4,0],[17,2,6,0],[18,0,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,0,14,0],[26,2,15,0],[26,11,15,9,"trackClsAsStandaloneSpan"],[26,35,15,33,"trackClsAsStandaloneSpan"],[26,36,15,34,"client"],[26,42,15,40],[26,44,15,42],[27,4,16,2],[27,8,16,6,"standaloneCLsValue"],[27,26,16,24],[27,29,16,27],[27,30,16,28],[28,4,17,2],[28,8,17,6,"standaloneClsEntry"],[28,26,17,24],[29,4,19,2],[29,8,19,6],[29,9,19,7],[29,13,19,7,"supportsWebVital"],[29,21,19,23],[29,22,19,23,"supportsWebVital"],[29,38,19,23],[29,40,19,24],[29,54,19,38],[29,55,19,39],[29,57,19,41],[30,6,20,4],[31,4,21,2],[32,4,23,2],[32,10,23,8,"cleanupClsHandler"],[32,27,23,25],[32,30,23,28],[32,34,23,28,"addClsInstrumentationHandler"],[32,47,23,56],[32,48,23,56,"addClsInstrumentationHandler"],[32,76,23,56],[32,78,23,57],[32,79,23,58],[33,6,23,60,"metric"],[34,4,23,67],[34,5,23,68],[34,10,23,73],[35,6,24,4],[35,12,24,10,"entry"],[35,17,24,15],[35,20,24,18,"metric"],[35,26,24,24],[35,27,24,25,"entries"],[35,34,24,32],[35,35,24,33,"metric"],[35,41,24,39],[35,42,24,40,"entries"],[35,49,24,47],[35,50,24,48,"length"],[35,56,24,54],[35,59,24,57],[35,60,24,58],[35,61,24,59],[36,6,25,4],[36,10,25,8],[36,11,25,9,"entry"],[36,16,25,14],[36,18,25,16],[37,8,26,6],[38,6,27,4],[39,6,28,4,"standaloneCLsValue"],[39,24,28,22],[39,27,28,25,"metric"],[39,33,28,31],[39,34,28,32,"value"],[39,39,28,37],[40,6,29,4,"standaloneClsEntry"],[40,24,29,22],[40,27,29,25,"entry"],[40,32,29,30],[41,4,30,2],[41,5,30,3],[41,7,30,5],[41,11,30,9],[41,12,30,10],[42,4,32,2],[42,8,32,2,"listenForWebVitalReportEvents"],[42,16,32,31],[42,17,32,31,"listenForWebVitalReportEvents"],[42,46,32,31],[42,48,32,32,"client"],[42,54,32,38],[42,56,32,40],[42,57,32,41,"reportEvent"],[42,68,32,52],[42,70,32,54,"pageloadSpanId"],[42,84,32,68],[42,89,32,73],[43,6,33,4,"sendStandaloneClsSpan"],[43,27,33,25],[43,28,33,26,"standaloneCLsValue"],[43,46,33,44],[43,48,33,46,"standaloneClsEntry"],[43,66,33,64],[43,68,33,66,"pageloadSpanId"],[43,82,33,80],[43,84,33,82,"reportEvent"],[43,95,33,93],[43,96,33,94],[44,6,34,4,"cleanupClsHandler"],[44,23,34,21],[44,24,34,22],[44,25,34,23],[45,4,35,2],[45,5,35,3],[45,6,35,4],[46,2,36,0],[47,2,38,0],[47,11,38,9,"sendStandaloneClsSpan"],[47,32,38,30,"sendStandaloneClsSpan"],[47,33,39,2,"clsValue"],[47,41,39,10],[47,43,40,2,"entry"],[47,48,40,7],[47,50,41,2,"pageloadSpanId"],[47,64,41,16],[47,66,42,2,"reportEvent"],[47,77,42,13],[47,79,43,2],[48,4,44,2,"DEBUG_BUILD"],[48,17,44,13],[48,18,44,13,"DEBUG_BUILD"],[48,29,44,13],[48,33,44,17,"debug"],[48,44,44,22],[48,45,44,22,"debug"],[48,50,44,22],[48,51,44,23,"log"],[48,54,44,26],[48,55,44,27],[48,76,44,48,"clsValue"],[48,84,44,56],[48,87,44,59],[48,88,44,60],[49,4,46,2],[49,10,46,8,"startTime"],[49,19,46,17],[49,22,46,20],[49,26,46,20,"msToSec"],[49,34,46,27],[49,35,46,27,"msToSec"],[49,42,46,27],[49,44,46,28],[49,45,46,29],[49,49,46,29,"browserPerformanceTimeOrigin"],[49,60,46,57],[49,61,46,57,"browserPerformanceTimeOrigin"],[49,89,46,57],[49,91,46,58],[49,92,46,59],[49,96,46,63],[49,97,46,64],[49,102,46,69,"entry"],[49,107,46,74],[49,109,46,76,"startTime"],[49,118,46,85],[49,122,46,89],[49,123,46,90],[49,124,46,91],[49,125,46,92],[50,4,47,2],[50,10,47,8,"routeName"],[50,19,47,17],[50,22,47,20],[50,26,47,20,"getCurrentScope"],[50,37,47,35],[50,38,47,35,"getCurrentScope"],[50,53,47,35],[50,55,47,36],[50,56,47,37],[50,57,47,38,"getScopeData"],[50,69,47,50],[50,70,47,51],[50,71,47,52],[50,72,47,53,"transactionName"],[50,87,47,68],[51,4,49,2],[51,10,49,8,"name"],[51,14,49,12],[51,17,49,15,"entry"],[51,22,49,20],[51,25,49,23],[51,29,49,23,"htmlTreeAsString"],[51,40,49,39],[51,41,49,39,"htmlTreeAsString"],[51,57,49,39],[51,59,49,40,"entry"],[51,64,49,45],[51,65,49,46,"sources"],[51,72,49,53],[51,73,49,54],[51,74,49,55],[51,75,49,56],[51,77,49,58,"node"],[51,81,49,62],[51,82,49,63],[51,85,49,66],[51,99,49,80],[52,4,51,2],[52,10,51,8,"attributes"],[52,20,51,18],[52,23,51,21],[53,6,52,4],[53,7,52,5,"SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN"],[53,18,52,37],[53,19,52,37,"SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN"],[53,51,52,37],[53,54,52,40],[53,77,52,63],[54,6,53,4],[54,7,53,5,"SEMANTIC_ATTRIBUTE_SENTRY_OP"],[54,18,53,33],[54,19,53,33,"SEMANTIC_ATTRIBUTE_SENTRY_OP"],[54,47,53,33],[54,50,53,36],[54,67,53,53],[55,6,54,4],[55,7,54,5,"SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME"],[55,18,54,38],[55,19,54,38,"SEMANTIC_ATTRIBUTE_EXCLUSIVE_TIME"],[55,52,54,38],[55,55,54,41,"entry"],[55,60,54,46],[55,62,54,48,"duration"],[55,70,54,56],[55,74,54,60],[55,75,54,61],[56,6,55,4],[57,6,56,4],[57,31,56,29],[57,33,56,31,"pageloadSpanId"],[57,47,56,45],[58,6,57,4],[59,6,58,4],[59,27,58,25],[59,29,58,27,"reportEvent"],[60,4,59,2],[60,5,59,3],[62,4,61,2],[63,4,62,2],[64,4,63,2],[64,8,63,6,"entry"],[64,13,63,11],[64,15,63,13,"sources"],[64,22,63,20],[64,24,63,22],[65,6,64,4,"entry"],[65,11,64,9],[65,12,64,10,"sources"],[65,19,64,17],[65,20,64,18,"forEach"],[65,27,64,25],[65,28,64,26],[65,29,64,27,"source"],[65,35,64,33],[65,37,64,35,"index"],[65,42,64,40],[65,47,64,45],[66,8,65,6,"attributes"],[66,18,65,16],[66,19,65,17],[66,33,65,31,"index"],[66,38,65,36],[66,41,65,39],[66,42,65,40],[66,44,65,42],[66,45,65,43],[66,48,65,46],[66,52,65,46,"htmlTreeAsString"],[66,63,65,62],[66,64,65,62,"htmlTreeAsString"],[66,80,65,62],[66,82,65,63,"source"],[66,88,65,69],[66,89,65,70,"node"],[66,93,65,74],[66,94,65,75],[67,6,66,4],[67,7,66,5],[67,8,66,6],[68,4,67,2],[69,4,69,2],[69,10,69,8,"span"],[69,14,69,12],[69,17,69,15],[69,21,69,15,"startStandaloneWebVitalSpan"],[69,29,69,42],[69,30,69,42,"startStandaloneWebVitalSpan"],[69,57,69,42],[69,59,69,43],[70,6,70,4,"name"],[70,10,70,8],[71,6,71,4,"transaction"],[71,17,71,15],[71,19,71,17,"routeName"],[71,28,71,26],[72,6,72,4,"attributes"],[72,16,72,14],[73,6,73,4,"startTime"],[74,4,74,2],[74,5,74,3],[74,6,74,4],[75,4,76,2],[75,8,76,6,"span"],[75,12,76,10],[75,14,76,12],[76,6,77,4,"span"],[76,10,77,8],[76,11,77,9,"addEvent"],[76,19,77,17],[76,20,77,18],[76,25,77,23],[76,27,77,25],[77,8,78,6],[77,9,78,7,"SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT"],[77,20,78,49],[77,21,78,49,"SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_UNIT"],[77,63,78,49],[77,66,78,52],[77,68,78,54],[78,8,79,6],[78,9,79,7,"SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE"],[78,20,79,50],[78,21,79,50,"SEMANTIC_ATTRIBUTE_SENTRY_MEASUREMENT_VALUE"],[78,64,79,50],[78,67,79,53,"clsValue"],[79,6,80,4],[79,7,80,5],[79,8,80,6],[81,6,82,4],[82,6,83,4],[83,6,84,4,"span"],[83,10,84,8],[83,11,84,9,"end"],[83,14,84,12],[83,15,84,13,"startTime"],[83,24,84,22],[83,25,84,23],[84,4,85,2],[85,2,86,0],[86,0,86,1],[86,3]],"functionMap":{"names":["<global>","trackClsAsStandaloneSpan","addClsInstrumentationHandler$argument_0","listenForWebVitalReportEvents$argument_1","sendStandaloneClsSpan","entry.sources.forEach$argument_0"],"mappings":"AAA;ACc;yDCQ;GDO;wCEE;GFG;CDC;AIE;0BC0B;KDE;CJoB"},"hasCjsExports":false},"type":"js/module"}]}