{"dependencies":[{"name":"./attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":334,"index":334}}],"key":"UMlNobrmssIvLA9C9D03xjrDrQE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"filterMcpPiiFromSpanData\", {\n    enumerable: true,\n    get: function () {\n      return filterMcpPiiFromSpanData;\n    }\n  });\n  var _attributesJs = require(_dependencyMap[0], \"./attributes.js\");\n  /**\n   * PII attributes that should be removed when sendDefaultPii is false\n   * @internal\n   */\n  const PII_ATTRIBUTES = new Set([_attributesJs.CLIENT_ADDRESS_ATTRIBUTE, _attributesJs.CLIENT_PORT_ATTRIBUTE, _attributesJs.MCP_LOGGING_MESSAGE_ATTRIBUTE, _attributesJs.MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE, _attributesJs.MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE, _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE, _attributesJs.MCP_TOOL_RESULT_CONTENT_ATTRIBUTE]);\n\n  /**\n   * Checks if an attribute key should be considered PII.\n   *\n   * Returns true for:\n   * - Explicit PII attributes (client.address, client.port, mcp.logging.message, etc.)\n   * - All request arguments (mcp.request.argument.*)\n   * - Tool and prompt result content (mcp.tool.result.*, mcp.prompt.result.*) except metadata\n   *\n   * Preserves metadata attributes ending with _count, _error, or .is_error as they don't contain sensitive data.\n   *\n   * @param key - Attribute key to evaluate\n   * @returns true if the attribute should be filtered out (is PII), false if it should be preserved\n   * @internal\n   */\n  function isPiiAttribute(key) {\n    if (PII_ATTRIBUTES.has(key)) {\n      return true;\n    }\n    if (key.startsWith(`${_attributesJs.MCP_REQUEST_ARGUMENT}.`)) {\n      return true;\n    }\n    if (key.startsWith(`${_attributesJs.MCP_TOOL_RESULT_PREFIX}.`) || key.startsWith(`${_attributesJs.MCP_PROMPT_RESULT_PREFIX}.`)) {\n      if (!key.endsWith('_count') && !key.endsWith('_error') && !key.endsWith('.is_error')) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Removes PII attributes from span data when sendDefaultPii is false\n   * @param spanData - Raw span attributes\n   * @param sendDefaultPii - Whether to include PII data\n   * @returns Filtered span attributes\n   */\n  function filterMcpPiiFromSpanData(spanData, sendDefaultPii) {\n    if (sendDefaultPii) {\n      return spanData;\n    }\n    return Object.entries(spanData).reduce((acc, [key, value]) => {\n      if (!isPiiAttribute(key)) {\n        acc[key] = value;\n      }\n      return acc;\n    }, {});\n  }\n});","lineCount":66,"map":[[7,2,74,0,"Object"],[7,8,74,0],[7,9,74,0,"defineProperty"],[7,23,74,0],[7,24,74,0,"exports"],[7,31,74,0],[8,4,74,0,"enumerable"],[8,14,74,0],[9,4,74,0,"get"],[9,7,74,0],[9,18,74,0,"get"],[9,19,74,0],[10,6,74,0],[10,13,74,9,"filterMcpPiiFromSpanData"],[10,37,74,33],[11,4,74,33],[12,2,74,33],[13,2,1,0],[13,6,1,0,"_attributesJs"],[13,19,1,0],[13,22,1,0,"require"],[13,29,1,0],[13,30,1,0,"_dependencyMap"],[13,44,1,0],[14,2,3,0],[15,0,4,0],[16,0,5,0],[17,0,6,0],[18,2,7,0],[18,8,7,6,"PII_ATTRIBUTES"],[18,22,7,20],[18,25,7,23],[18,29,7,27,"Set"],[18,32,7,30],[18,33,7,31],[18,34,8,2,"CLIENT_ADDRESS_ATTRIBUTE"],[18,47,8,26],[18,48,8,26,"CLIENT_ADDRESS_ATTRIBUTE"],[18,72,8,26],[18,74,9,2,"CLIENT_PORT_ATTRIBUTE"],[18,87,9,23],[18,88,9,23,"CLIENT_PORT_ATTRIBUTE"],[18,109,9,23],[18,111,10,2,"MCP_LOGGING_MESSAGE_ATTRIBUTE"],[18,124,10,31],[18,125,10,31,"MCP_LOGGING_MESSAGE_ATTRIBUTE"],[18,154,10,31],[18,156,11,2,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[18,169,11,41],[18,170,11,41,"MCP_PROMPT_RESULT_DESCRIPTION_ATTRIBUTE"],[18,209,11,41],[18,211,12,2,"MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE"],[18,224,12,45],[18,225,12,45,"MCP_PROMPT_RESULT_MESSAGE_CONTENT_ATTRIBUTE"],[18,268,12,45],[18,270,13,2,"MCP_RESOURCE_URI_ATTRIBUTE"],[18,283,13,28],[18,284,13,28,"MCP_RESOURCE_URI_ATTRIBUTE"],[18,310,13,28],[18,312,14,2,"MCP_TOOL_RESULT_CONTENT_ATTRIBUTE"],[18,325,14,35],[18,326,14,35,"MCP_TOOL_RESULT_CONTENT_ATTRIBUTE"],[18,359,14,35],[18,360,15,1],[18,361,15,2],[20,2,17,0],[21,0,18,0],[22,0,19,0],[23,0,20,0],[24,0,21,0],[25,0,22,0],[26,0,23,0],[27,0,24,0],[28,0,25,0],[29,0,26,0],[30,0,27,0],[31,0,28,0],[32,0,29,0],[33,0,30,0],[34,2,31,0],[34,11,31,9,"isPiiAttribute"],[34,25,31,23,"isPiiAttribute"],[34,26,31,24,"key"],[34,29,31,27],[34,31,31,29],[35,4,32,2],[35,8,32,6,"PII_ATTRIBUTES"],[35,22,32,20],[35,23,32,21,"has"],[35,26,32,24],[35,27,32,25,"key"],[35,30,32,28],[35,31,32,29],[35,33,32,31],[36,6,33,4],[36,13,33,11],[36,17,33,15],[37,4,34,2],[38,4,36,2],[38,8,36,6,"key"],[38,11,36,9],[38,12,36,10,"startsWith"],[38,22,36,20],[38,23,36,21],[38,26,36,24,"MCP_REQUEST_ARGUMENT"],[38,39,36,44],[38,40,36,44,"MCP_REQUEST_ARGUMENT"],[38,60,36,44],[38,63,36,47],[38,64,36,48],[38,66,36,50],[39,6,37,4],[39,13,37,11],[39,17,37,15],[40,4,38,2],[41,4,40,2],[41,8,40,6,"key"],[41,11,40,9],[41,12,40,10,"startsWith"],[41,22,40,20],[41,23,40,21],[41,26,40,24,"MCP_TOOL_RESULT_PREFIX"],[41,39,40,46],[41,40,40,46,"MCP_TOOL_RESULT_PREFIX"],[41,62,40,46],[41,65,40,49],[41,66,40,50],[41,70,40,54,"key"],[41,73,40,57],[41,74,40,58,"startsWith"],[41,84,40,68],[41,85,40,69],[41,88,40,72,"MCP_PROMPT_RESULT_PREFIX"],[41,101,40,96],[41,102,40,96,"MCP_PROMPT_RESULT_PREFIX"],[41,126,40,96],[41,129,40,99],[41,130,40,100],[41,132,40,102],[42,6,41,4],[42,10,41,8],[42,11,41,9,"key"],[42,14,41,12],[42,15,41,13,"endsWith"],[42,23,41,21],[42,24,41,22],[42,32,41,30],[42,33,41,31],[42,37,41,35],[42,38,41,36,"key"],[42,41,41,39],[42,42,41,40,"endsWith"],[42,50,41,48],[42,51,41,49],[42,59,41,57],[42,60,41,58],[42,64,41,62],[42,65,41,63,"key"],[42,68,41,66],[42,69,41,67,"endsWith"],[42,77,41,75],[42,78,41,76],[42,89,41,87],[42,90,41,88],[42,92,41,90],[43,8,42,6],[43,15,42,13],[43,19,42,17],[44,6,43,4],[45,4,44,2],[46,4,46,2],[46,11,46,9],[46,16,46,14],[47,2,47,0],[49,2,49,0],[50,0,50,0],[51,0,51,0],[52,0,52,0],[53,0,53,0],[54,0,54,0],[55,2,55,0],[55,11,55,9,"filterMcpPiiFromSpanData"],[55,35,55,33,"filterMcpPiiFromSpanData"],[55,36,56,2,"spanData"],[55,44,56,10],[55,46,57,2,"sendDefaultPii"],[55,60,57,16],[55,62,58,2],[56,4,59,2],[56,8,59,6,"sendDefaultPii"],[56,22,59,20],[56,24,59,22],[57,6,60,4],[57,13,60,11,"spanData"],[57,21,60,19],[58,4,61,2],[59,4,63,2],[59,11,63,9,"Object"],[59,17,63,15],[59,18,63,16,"entries"],[59,25,63,23],[59,26,63,24,"spanData"],[59,34,63,32],[59,35,63,33],[59,36,63,34,"reduce"],[59,42,63,40],[59,43,64,4],[59,44,64,5,"acc"],[59,47,64,8],[59,49,64,10],[59,50,64,11,"key"],[59,53,64,14],[59,55,64,16,"value"],[59,60,64,21],[59,61,64,22],[59,66,64,27],[60,6,65,6],[60,10,65,10],[60,11,65,11,"isPiiAttribute"],[60,25,65,25],[60,26,65,26,"key"],[60,29,65,29],[60,30,65,30],[60,32,65,32],[61,8,66,8,"acc"],[61,11,66,11],[61,12,66,12,"key"],[61,15,66,15],[61,16,66,16],[61,19,66,19,"value"],[61,24,66,24],[62,6,67,6],[63,6,68,6],[63,13,68,13,"acc"],[63,16,68,16],[64,4,69,4],[64,5,69,5],[64,7,70,4],[64,8,70,5],[64,9,71,2],[64,10,71,3],[65,2,72,0],[66,0,72,1],[66,3]],"functionMap":{"names":["<global>","isPiiAttribute","filterMcpPiiFromSpanData","Object.entries.reduce$argument_0"],"mappings":"AAA;AC8B;CDgB;AEQ;ICS;KDK;CFG"},"hasCjsExports":false},"type":"js/module"}]}