{"dependencies":[{"name":"../../types.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":40,"index":40}}],"key":"W1BH0a3HSCo8tOLXH7X+m5FGigs=","exportNames":["*"],"imports":1}},{"name":"./lib/bindReporter.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":41},"end":{"line":2,"column":53,"index":94}}],"key":"yZXTUsWh1M46DyxIbZ88NUHRymg=","exportNames":["*"],"imports":1}},{"name":"./lib/getActivationStart.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":95},"end":{"line":3,"column":65,"index":160}}],"key":"GdWeY/Ul63HmG3e9yq4TWUwqk0M=","exportNames":["*"],"imports":1}},{"name":"./lib/getNavigationEntry.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":161},"end":{"line":4,"column":65,"index":226}}],"key":"tqQhkALFt/Nyl0IIvEJIjJVM1DQ=","exportNames":["*"],"imports":1}},{"name":"./lib/initMetric.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":227},"end":{"line":5,"column":49,"index":276}}],"key":"3h8m+kvAV2o3xN93IHHrmBqzs4s=","exportNames":["*"],"imports":1}},{"name":"./lib/whenActivated.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":277},"end":{"line":6,"column":55,"index":332}}],"key":"ZUHRzyG92JJbjB1/O2ptt6DviqY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"TTFBThresholds\", {\n    enumerable: true,\n    get: function () {\n      return TTFBThresholds;\n    }\n  });\n  Object.defineProperty(exports, \"onTTFB\", {\n    enumerable: true,\n    get: function () {\n      return onTTFB;\n    }\n  });\n  var _typesJs = require(_dependencyMap[0], \"../../types.js\");\n  var _libBindReporterJs = require(_dependencyMap[1], \"./lib/bindReporter.js\");\n  var _libGetActivationStartJs = require(_dependencyMap[2], \"./lib/getActivationStart.js\");\n  var _libGetNavigationEntryJs = require(_dependencyMap[3], \"./lib/getNavigationEntry.js\");\n  var _libInitMetricJs = require(_dependencyMap[4], \"./lib/initMetric.js\");\n  var _libWhenActivatedJs = require(_dependencyMap[5], \"./lib/whenActivated.js\");\n  /*\n   * Copyright 2020 Google LLC\n   *\n   * Licensed under the Apache License, Version 2.0 (the \"License\");\n   * you may not use this file except in compliance with the License.\n   * You may obtain a copy of the License at\n   *\n   *     https://www.apache.org/licenses/LICENSE-2.0\n   *\n   * Unless required by applicable law or agreed to in writing, software\n   * distributed under the License is distributed on an \"AS IS\" BASIS,\n   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   * See the License for the specific language governing permissions and\n   * limitations under the License.\n   */\n\n  /** Thresholds for TTFB. See https://web.dev/articles/ttfb#what_is_a_good_ttfb_score */\n  const TTFBThresholds = [800, 1800];\n\n  /**\n   * Runs in the next task after the page is done loading and/or prerendering.\n   * @param callback\n   */\n  const whenReady = callback => {\n    if (_typesJs.WINDOW.document?.prerendering) {\n      (0, _libWhenActivatedJs.whenActivated)(() => whenReady(callback));\n    } else if (_typesJs.WINDOW.document?.readyState !== 'complete') {\n      addEventListener('load', () => whenReady(callback), true);\n    } else {\n      // Queue a task so the callback runs after `loadEventEnd`.\n      setTimeout(callback);\n    }\n  };\n\n  /**\n   * Calculates the [TTFB](https://web.dev/articles/ttfb) value for the\n   * current page and calls the `callback` function once the page has loaded,\n   * along with the relevant `navigation` performance entry used to determine the\n   * value. The reported value is a `DOMHighResTimeStamp`.\n   *\n   * Note, this function waits until after the page is loaded to call `callback`\n   * in order to ensure all properties of the `navigation` entry are populated.\n   * This is useful if you want to report on other metrics exposed by the\n   * [Navigation Timing API](https://w3c.github.io/navigation-timing/). For\n   * example, the TTFB metric starts from the page's [time\n   * origin](https://www.w3.org/TR/hr-time-2/#sec-time-origin), which means it\n   * includes time spent on DNS lookup, connection negotiation, network latency,\n   * and server processing time.\n   */\n  const onTTFB = (onReport, opts = {}) => {\n    const metric = (0, _libInitMetricJs.initMetric)('TTFB');\n    const report = (0, _libBindReporterJs.bindReporter)(onReport, metric, TTFBThresholds, opts.reportAllChanges);\n    whenReady(() => {\n      const navigationEntry = (0, _libGetNavigationEntryJs.getNavigationEntry)();\n      if (navigationEntry) {\n        // The activationStart reference is used because TTFB should be\n        // relative to page activation rather than navigation start if the\n        // page was prerendered. But in cases where `activationStart` occurs\n        // after the first byte is received, this time should be clamped at 0.\n        metric.value = Math.max(navigationEntry.responseStart - (0, _libGetActivationStartJs.getActivationStart)(), 0);\n        metric.entries = [navigationEntry];\n        report(true);\n      }\n    });\n  };\n});","lineCount":90,"map":[[7,2,78,0,"Object"],[7,8,78,0],[7,9,78,0,"defineProperty"],[7,23,78,0],[7,24,78,0,"exports"],[7,31,78,0],[8,4,78,0,"enumerable"],[8,14,78,0],[9,4,78,0,"get"],[9,7,78,0],[9,18,78,0,"get"],[9,19,78,0],[10,6,78,0],[10,13,78,9,"TTFBThresholds"],[10,27,78,23],[11,4,78,23],[12,2,78,23],[13,2,78,0,"Object"],[13,8,78,0],[13,9,78,0,"defineProperty"],[13,23,78,0],[13,24,78,0,"exports"],[13,31,78,0],[14,4,78,0,"enumerable"],[14,14,78,0],[15,4,78,0,"get"],[15,7,78,0],[15,18,78,0,"get"],[15,19,78,0],[16,6,78,0],[16,13,78,25,"onTTFB"],[16,19,78,31],[17,4,78,31],[18,2,78,31],[19,2,1,0],[19,6,1,0,"_typesJs"],[19,14,1,0],[19,17,1,0,"require"],[19,24,1,0],[19,25,1,0,"_dependencyMap"],[19,39,1,0],[20,2,2,0],[20,6,2,0,"_libBindReporterJs"],[20,24,2,0],[20,27,2,0,"require"],[20,34,2,0],[20,35,2,0,"_dependencyMap"],[20,49,2,0],[21,2,3,0],[21,6,3,0,"_libGetActivationStartJs"],[21,30,3,0],[21,33,3,0,"require"],[21,40,3,0],[21,41,3,0,"_dependencyMap"],[21,55,3,0],[22,2,4,0],[22,6,4,0,"_libGetNavigationEntryJs"],[22,30,4,0],[22,33,4,0,"require"],[22,40,4,0],[22,41,4,0,"_dependencyMap"],[22,55,4,0],[23,2,5,0],[23,6,5,0,"_libInitMetricJs"],[23,22,5,0],[23,25,5,0,"require"],[23,32,5,0],[23,33,5,0,"_dependencyMap"],[23,47,5,0],[24,2,6,0],[24,6,6,0,"_libWhenActivatedJs"],[24,25,6,0],[24,28,6,0,"require"],[24,35,6,0],[24,36,6,0,"_dependencyMap"],[24,50,6,0],[25,2,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,0,14,0],[32,0,15,0],[33,0,16,0],[34,0,17,0],[35,0,18,0],[36,0,19,0],[37,0,20,0],[38,0,21,0],[39,0,22,0],[41,2,25,0],[42,2,26,0],[42,8,26,6,"TTFBThresholds"],[42,22,26,20],[42,25,26,23],[42,26,26,24],[42,29,26,27],[42,31,26,29],[42,35,26,33],[42,36,26,34],[44,2,28,0],[45,0,29,0],[46,0,30,0],[47,0,31,0],[48,2,32,0],[48,8,32,6,"whenReady"],[48,17,32,15],[48,20,32,19,"callback"],[48,28,32,27],[48,32,32,32],[49,4,33,2],[49,8,33,6,"WINDOW"],[49,16,33,12],[49,17,33,12,"WINDOW"],[49,23,33,12],[49,24,33,13,"document"],[49,32,33,21],[49,34,33,23,"prerendering"],[49,46,33,35],[49,48,33,37],[50,6,34,4],[50,10,34,4,"whenActivated"],[50,29,34,17],[50,30,34,17,"whenActivated"],[50,43,34,17],[50,45,34,18],[50,51,34,24,"whenReady"],[50,60,34,33],[50,61,34,34,"callback"],[50,69,34,42],[50,70,34,43],[50,71,34,44],[51,4,35,2],[51,5,35,3],[51,11,35,9],[51,15,35,13,"WINDOW"],[51,23,35,19],[51,24,35,19,"WINDOW"],[51,30,35,19],[51,31,35,20,"document"],[51,39,35,28],[51,41,35,30,"readyState"],[51,51,35,40],[51,56,35,45],[51,66,35,55],[51,68,35,57],[52,6,36,4,"addEventListener"],[52,22,36,20],[52,23,36,21],[52,29,36,27],[52,31,36,29],[52,37,36,35,"whenReady"],[52,46,36,44],[52,47,36,45,"callback"],[52,55,36,53],[52,56,36,54],[52,58,36,56],[52,62,36,60],[52,63,36,61],[53,4,37,2],[53,5,37,3],[53,11,37,9],[54,6,38,4],[55,6,39,4,"setTimeout"],[55,16,39,14],[55,17,39,15,"callback"],[55,25,39,23],[55,26,39,24],[56,4,40,2],[57,2,41,0],[57,3,41,1],[59,2,43,0],[60,0,44,0],[61,0,45,0],[62,0,46,0],[63,0,47,0],[64,0,48,0],[65,0,49,0],[66,0,50,0],[67,0,51,0],[68,0,52,0],[69,0,53,0],[70,0,54,0],[71,0,55,0],[72,0,56,0],[73,0,57,0],[74,2,58,0],[74,8,58,6,"onTTFB"],[74,14,58,12],[74,17,58,15,"onTTFB"],[74,18,58,16,"onReport"],[74,26,58,24],[74,28,58,26,"opts"],[74,32,58,30],[74,35,58,33],[74,36,58,34],[74,37,58,35],[74,42,58,40],[75,4,59,2],[75,10,59,8,"metric"],[75,16,59,14],[75,19,59,17],[75,23,59,17,"initMetric"],[75,39,59,27],[75,40,59,27,"initMetric"],[75,50,59,27],[75,52,59,28],[75,58,59,34],[75,59,59,35],[76,4,60,2],[76,10,60,8,"report"],[76,16,60,14],[76,19,60,17],[76,23,60,17,"bindReporter"],[76,41,60,29],[76,42,60,29,"bindReporter"],[76,54,60,29],[76,56,60,30,"onReport"],[76,64,60,38],[76,66,60,40,"metric"],[76,72,60,46],[76,74,60,48,"TTFBThresholds"],[76,88,60,62],[76,90,60,64,"opts"],[76,94,60,68],[76,95,60,69,"reportAllChanges"],[76,111,60,85],[76,112,60,86],[77,4,62,2,"whenReady"],[77,13,62,11],[77,14,62,12],[77,20,62,18],[78,6,63,4],[78,12,63,10,"navigationEntry"],[78,27,63,25],[78,30,63,28],[78,34,63,28,"getNavigationEntry"],[78,58,63,46],[78,59,63,46,"getNavigationEntry"],[78,77,63,46],[78,79,63,47],[78,80,63,48],[79,6,65,4],[79,10,65,8,"navigationEntry"],[79,25,65,23],[79,27,65,25],[80,8,66,6],[81,8,67,6],[82,8,68,6],[83,8,69,6],[84,8,70,6,"metric"],[84,14,70,12],[84,15,70,13,"value"],[84,20,70,18],[84,23,70,21,"Math"],[84,27,70,25],[84,28,70,26,"max"],[84,31,70,29],[84,32,70,30,"navigationEntry"],[84,47,70,45],[84,48,70,46,"responseStart"],[84,61,70,59],[84,64,70,62],[84,68,70,62,"getActivationStart"],[84,92,70,80],[84,93,70,80,"getActivationStart"],[84,111,70,80],[84,113,70,81],[84,114,70,82],[84,116,70,84],[84,117,70,85],[84,118,70,86],[85,8,72,6,"metric"],[85,14,72,12],[85,15,72,13,"entries"],[85,22,72,20],[85,25,72,23],[85,26,72,24,"navigationEntry"],[85,41,72,39],[85,42,72,40],[86,8,73,6,"report"],[86,14,73,12],[86,15,73,13],[86,19,73,17],[86,20,73,18],[87,6,74,4],[88,4,75,2],[88,5,75,3],[88,6,75,4],[89,2,76,0],[89,3,76,1],[90,0,76,2],[90,3]],"functionMap":{"names":["<global>","whenReady","whenActivated$argument_0","addEventListener$argument_1","onTTFB","whenReady$argument_0"],"mappings":"AAA;kBC+B;kBCE,yBD;6BEE,yBF;CDK;eIiB;YCI;GDa;CJC"},"hasCjsExports":false},"type":"js/module"}]}