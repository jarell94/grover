{"dependencies":[{"name":"./attributes.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":135,"index":135}}],"key":"UMlNobrmssIvLA9C9D03xjrDrQE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"extractTargetInfo\", {\n    enumerable: true,\n    get: function () {\n      return extractTargetInfo;\n    }\n  });\n  Object.defineProperty(exports, \"getRequestArguments\", {\n    enumerable: true,\n    get: function () {\n      return getRequestArguments;\n    }\n  });\n  var _attributesJs = require(_dependencyMap[0], \"./attributes.js\");\n  /**\n   * Method configuration and request processing for MCP server instrumentation\n   */\n\n  /**\n   * Configuration for MCP methods to extract targets and arguments\n   * @internal Maps method names to their extraction configuration\n   */\n  const METHOD_CONFIGS = {\n    'tools/call': {\n      targetField: 'name',\n      targetAttribute: _attributesJs.MCP_TOOL_NAME_ATTRIBUTE,\n      captureArguments: true,\n      argumentsField: 'arguments'\n    },\n    'resources/read': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE,\n      captureUri: true\n    },\n    'resources/subscribe': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE\n    },\n    'resources/unsubscribe': {\n      targetField: 'uri',\n      targetAttribute: _attributesJs.MCP_RESOURCE_URI_ATTRIBUTE\n    },\n    'prompts/get': {\n      targetField: 'name',\n      targetAttribute: _attributesJs.MCP_PROMPT_NAME_ATTRIBUTE,\n      captureName: true,\n      captureArguments: true,\n      argumentsField: 'arguments'\n    }\n  };\n\n  /**\n   * Extracts target info from method and params based on method type\n   * @param method - MCP method name\n   * @param params - Method parameters\n   * @returns Target name and attributes for span instrumentation\n   */\n  function extractTargetInfo(method, params) {\n    const config = METHOD_CONFIGS[method];\n    if (!config) {\n      return {\n        attributes: {}\n      };\n    }\n    const target = config.targetField && typeof params?.[config.targetField] === 'string' ? params[config.targetField] : undefined;\n    return {\n      target,\n      attributes: target && config.targetAttribute ? {\n        [config.targetAttribute]: target\n      } : {}\n    };\n  }\n\n  /**\n   * Extracts request arguments based on method type\n   * @param method - MCP method name\n   * @param params - Method parameters\n   * @returns Arguments as span attributes with mcp.request.argument prefix\n   */\n  function getRequestArguments(method, params) {\n    const args = {};\n    const config = METHOD_CONFIGS[method];\n    if (!config) {\n      return args;\n    }\n    if (config.captureArguments && config.argumentsField && params?.[config.argumentsField]) {\n      const argumentsObj = params[config.argumentsField];\n      if (typeof argumentsObj === 'object' && argumentsObj !== null) {\n        for (const [key, value] of Object.entries(argumentsObj)) {\n          args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.${key.toLowerCase()}`] = JSON.stringify(value);\n        }\n      }\n    }\n    if (config.captureUri && params?.uri) {\n      args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.uri`] = JSON.stringify(params.uri);\n    }\n    if (config.captureName && params?.name) {\n      args[`${_attributesJs.MCP_REQUEST_ARGUMENT}.name`] = JSON.stringify(params.name);\n    }\n    return args;\n  }\n});","lineCount":107,"map":[[7,2,103,0,"Object"],[7,8,103,0],[7,9,103,0,"defineProperty"],[7,23,103,0],[7,24,103,0,"exports"],[7,31,103,0],[8,4,103,0,"enumerable"],[8,14,103,0],[9,4,103,0,"get"],[9,7,103,0],[9,18,103,0,"get"],[9,19,103,0],[10,6,103,0],[10,13,103,9,"extractTargetInfo"],[10,30,103,26],[11,4,103,26],[12,2,103,26],[13,2,103,0,"Object"],[13,8,103,0],[13,9,103,0,"defineProperty"],[13,23,103,0],[13,24,103,0,"exports"],[13,31,103,0],[14,4,103,0,"enumerable"],[14,14,103,0],[15,4,103,0,"get"],[15,7,103,0],[15,18,103,0,"get"],[15,19,103,0],[16,6,103,0],[16,13,103,28,"getRequestArguments"],[16,32,103,47],[17,4,103,47],[18,2,103,47],[19,2,1,0],[19,6,1,0,"_attributesJs"],[19,19,1,0],[19,22,1,0,"require"],[19,29,1,0],[19,30,1,0,"_dependencyMap"],[19,44,1,0],[20,2,3,0],[21,0,4,0],[22,0,5,0],[24,2,8,0],[25,0,9,0],[26,0,10,0],[27,0,11,0],[28,2,12,0],[28,8,12,6,"METHOD_CONFIGS"],[28,22,12,20],[28,25,12,23],[29,4,13,2],[29,16,13,14],[29,18,13,16],[30,6,14,4,"targetField"],[30,17,14,15],[30,19,14,17],[30,25,14,23],[31,6,15,4,"targetAttribute"],[31,21,15,19],[31,23,15,21,"MCP_TOOL_NAME_ATTRIBUTE"],[31,36,15,44],[31,37,15,44,"MCP_TOOL_NAME_ATTRIBUTE"],[31,60,15,44],[32,6,16,4,"captureArguments"],[32,22,16,20],[32,24,16,22],[32,28,16,26],[33,6,17,4,"argumentsField"],[33,20,17,18],[33,22,17,20],[34,4,18,2],[34,5,18,3],[35,4,19,2],[35,20,19,18],[35,22,19,20],[36,6,20,4,"targetField"],[36,17,20,15],[36,19,20,17],[36,24,20,22],[37,6,21,4,"targetAttribute"],[37,21,21,19],[37,23,21,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[37,36,21,47],[37,37,21,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[37,63,21,47],[38,6,22,4,"captureUri"],[38,16,22,14],[38,18,22,16],[39,4,23,2],[39,5,23,3],[40,4,24,2],[40,25,24,23],[40,27,24,25],[41,6,25,4,"targetField"],[41,17,25,15],[41,19,25,17],[41,24,25,22],[42,6,26,4,"targetAttribute"],[42,21,26,19],[42,23,26,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[42,36,26,47],[42,37,26,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[43,4,27,2],[43,5,27,3],[44,4,28,2],[44,27,28,25],[44,29,28,27],[45,6,29,4,"targetField"],[45,17,29,15],[45,19,29,17],[45,24,29,22],[46,6,30,4,"targetAttribute"],[46,21,30,19],[46,23,30,21,"MCP_RESOURCE_URI_ATTRIBUTE"],[46,36,30,47],[46,37,30,47,"MCP_RESOURCE_URI_ATTRIBUTE"],[47,4,31,2],[47,5,31,3],[48,4,32,2],[48,17,32,15],[48,19,32,17],[49,6,33,4,"targetField"],[49,17,33,15],[49,19,33,17],[49,25,33,23],[50,6,34,4,"targetAttribute"],[50,21,34,19],[50,23,34,21,"MCP_PROMPT_NAME_ATTRIBUTE"],[50,36,34,46],[50,37,34,46,"MCP_PROMPT_NAME_ATTRIBUTE"],[50,62,34,46],[51,6,35,4,"captureName"],[51,17,35,15],[51,19,35,17],[51,23,35,21],[52,6,36,4,"captureArguments"],[52,22,36,20],[52,24,36,22],[52,28,36,26],[53,6,37,4,"argumentsField"],[53,20,37,18],[53,22,37,20],[54,4,38,2],[55,2,39,0],[55,3,39,1],[57,2,41,0],[58,0,42,0],[59,0,43,0],[60,0,44,0],[61,0,45,0],[62,0,46,0],[63,2,47,0],[63,11,47,9,"extractTargetInfo"],[63,28,47,26,"extractTargetInfo"],[63,29,48,2,"method"],[63,35,48,8],[63,37,49,2,"params"],[63,43,49,8],[63,45,52,1],[64,4,53,2],[64,10,53,8,"config"],[64,16,53,14],[64,19,53,17,"METHOD_CONFIGS"],[64,33,53,31],[64,34,53,32,"method"],[64,40,53,38],[64,41,53,40],[65,4,54,2],[65,8,54,6],[65,9,54,7,"config"],[65,15,54,13],[65,17,54,15],[66,6,55,4],[66,13,55,11],[67,8,55,13,"attributes"],[67,18,55,23],[67,20,55,25],[67,21,55,26],[68,6,55,28],[68,7,55,29],[69,4,56,2],[70,4,58,2],[70,10,58,8,"target"],[70,16,58,14],[70,19,59,4,"config"],[70,25,59,10],[70,26,59,11,"targetField"],[70,37,59,22],[70,41,59,26],[70,48,59,33,"params"],[70,54,59,39],[70,57,59,42,"config"],[70,63,59,48],[70,64,59,49,"targetField"],[70,75,59,60],[70,76,59,61],[70,81,59,66],[70,89,59,74],[70,92,60,9,"params"],[70,98,60,15],[70,99,60,16,"config"],[70,105,60,22],[70,106,60,23,"targetField"],[70,117,60,34],[70,118,60,35],[70,121,61,8,"undefined"],[70,130,61,17],[71,4,63,2],[71,11,63,9],[72,6,64,4,"target"],[72,12,64,10],[73,6,65,4,"attributes"],[73,16,65,14],[73,18,65,16,"target"],[73,24,65,22],[73,28,65,26,"config"],[73,34,65,32],[73,35,65,33,"targetAttribute"],[73,50,65,48],[73,53,65,51],[74,8,65,53],[74,9,65,54,"config"],[74,15,65,60],[74,16,65,61,"targetAttribute"],[74,31,65,76],[74,34,65,79,"target"],[75,6,65,86],[75,7,65,87],[75,10,65,90],[75,11,65,91],[76,4,66,2],[76,5,66,3],[77,2,67,0],[79,2,69,0],[80,0,70,0],[81,0,71,0],[82,0,72,0],[83,0,73,0],[84,0,74,0],[85,2,75,0],[85,11,75,9,"getRequestArguments"],[85,30,75,28,"getRequestArguments"],[85,31,75,29,"method"],[85,37,75,35],[85,39,75,37,"params"],[85,45,75,43],[85,47,75,45],[86,4,76,2],[86,10,76,8,"args"],[86,14,76,12],[86,17,76,15],[86,18,76,16],[86,19,76,17],[87,4,77,2],[87,10,77,8,"config"],[87,16,77,14],[87,19,77,17,"METHOD_CONFIGS"],[87,33,77,31],[87,34,77,32,"method"],[87,40,77,38],[87,41,77,40],[88,4,79,2],[88,8,79,6],[88,9,79,7,"config"],[88,15,79,13],[88,17,79,15],[89,6,80,4],[89,13,80,11,"args"],[89,17,80,15],[90,4,81,2],[91,4,83,2],[91,8,83,6,"config"],[91,14,83,12],[91,15,83,13,"captureArguments"],[91,31,83,29],[91,35,83,33,"config"],[91,41,83,39],[91,42,83,40,"argumentsField"],[91,56,83,54],[91,60,83,58,"params"],[91,66,83,64],[91,69,83,67,"config"],[91,75,83,73],[91,76,83,74,"argumentsField"],[91,90,83,88],[91,91,83,89],[91,93,83,91],[92,6,84,4],[92,12,84,10,"argumentsObj"],[92,24,84,22],[92,27,84,25,"params"],[92,33,84,31],[92,34,84,32,"config"],[92,40,84,38],[92,41,84,39,"argumentsField"],[92,55,84,53],[92,56,84,54],[93,6,85,4],[93,10,85,8],[93,17,85,15,"argumentsObj"],[93,29,85,27],[93,34,85,32],[93,42,85,40],[93,46,85,44,"argumentsObj"],[93,58,85,56],[93,63,85,61],[93,67,85,65],[93,69,85,67],[94,8,86,6],[94,13,86,11],[94,19,86,17],[94,20,86,18,"key"],[94,23,86,21],[94,25,86,23,"value"],[94,30,86,28],[94,31,86,29],[94,35,86,33,"Object"],[94,41,86,39],[94,42,86,40,"entries"],[94,49,86,47],[94,50,86,48,"argumentsObj"],[94,62,86,61],[94,63,86,62],[94,65,86,64],[95,10,87,8,"args"],[95,14,87,12],[95,15,87,13],[95,18,87,16,"MCP_REQUEST_ARGUMENT"],[95,31,87,36],[95,32,87,36,"MCP_REQUEST_ARGUMENT"],[95,52,87,36],[95,56,87,40,"key"],[95,59,87,43],[95,60,87,44,"toLowerCase"],[95,71,87,55],[95,72,87,56],[95,73,87,57],[95,75,87,59],[95,76,87,60],[95,79,87,63,"JSON"],[95,83,87,67],[95,84,87,68,"stringify"],[95,93,87,77],[95,94,87,78,"value"],[95,99,87,83],[95,100,87,84],[96,8,88,6],[97,6,89,4],[98,4,90,2],[99,4,92,2],[99,8,92,6,"config"],[99,14,92,12],[99,15,92,13,"captureUri"],[99,25,92,23],[99,29,92,27,"params"],[99,35,92,33],[99,37,92,35,"uri"],[99,40,92,38],[99,42,92,40],[100,6,93,4,"args"],[100,10,93,8],[100,11,93,9],[100,14,93,12,"MCP_REQUEST_ARGUMENT"],[100,27,93,32],[100,28,93,32,"MCP_REQUEST_ARGUMENT"],[100,48,93,32],[100,54,93,38],[100,55,93,39],[100,58,93,42,"JSON"],[100,62,93,46],[100,63,93,47,"stringify"],[100,72,93,56],[100,73,93,57,"params"],[100,79,93,63],[100,80,93,64,"uri"],[100,83,93,67],[100,84,93,68],[101,4,94,2],[102,4,96,2],[102,8,96,6,"config"],[102,14,96,12],[102,15,96,13,"captureName"],[102,26,96,24],[102,30,96,28,"params"],[102,36,96,34],[102,38,96,36,"name"],[102,42,96,40],[102,44,96,42],[103,6,97,4,"args"],[103,10,97,8],[103,11,97,9],[103,14,97,12,"MCP_REQUEST_ARGUMENT"],[103,27,97,32],[103,28,97,32,"MCP_REQUEST_ARGUMENT"],[103,48,97,32],[103,55,97,39],[103,56,97,40],[103,59,97,43,"JSON"],[103,63,97,47],[103,64,97,48,"stringify"],[103,73,97,57],[103,74,97,58,"params"],[103,80,97,64],[103,81,97,65,"name"],[103,85,97,69],[103,86,97,70],[104,4,98,2],[105,4,100,2],[105,11,100,9,"args"],[105,15,100,13],[106,2,101,0],[107,0,101,1],[107,3]],"functionMap":{"names":["<global>","extractTargetInfo","getRequestArguments"],"mappings":"AAA;AC8C;CDoB;AEQ;CF0B"},"hasCjsExports":false},"type":"js/module"}]}