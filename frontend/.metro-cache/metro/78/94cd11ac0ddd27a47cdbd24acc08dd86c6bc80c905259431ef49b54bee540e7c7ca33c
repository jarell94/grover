{"dependencies":[{"name":"./utils/worldwide.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":50,"index":50}}],"key":"tPhT6cWF22FdNY7qYgYOs/LcVkQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"addMetadataToStackFrames\", {\n    enumerable: true,\n    get: function () {\n      return addMetadataToStackFrames;\n    }\n  });\n  Object.defineProperty(exports, \"getMetadataForUrl\", {\n    enumerable: true,\n    get: function () {\n      return getMetadataForUrl;\n    }\n  });\n  Object.defineProperty(exports, \"stripMetadataFromStackFrames\", {\n    enumerable: true,\n    get: function () {\n      return stripMetadataFromStackFrames;\n    }\n  });\n  var _utilsWorldwideJs = require(_dependencyMap[0], \"./utils/worldwide.js\");\n  /** Keys are source filename/url, values are metadata objects. */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  const filenameMetadataMap = new Map();\n  /** Set of stack strings that have already been parsed. */\n  const parsedStacks = new Set();\n  function ensureMetadataStacksAreParsed(parser) {\n    if (!_utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata) {\n      return;\n    }\n    for (const stack of Object.keys(_utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata)) {\n      const metadata = _utilsWorldwideJs.GLOBAL_OBJ._sentryModuleMetadata[stack];\n      if (parsedStacks.has(stack)) {\n        continue;\n      }\n\n      // Ensure this stack doesn't get parsed again\n      parsedStacks.add(stack);\n      const frames = parser(stack);\n\n      // Go through the frames starting from the top of the stack and find the first one with a filename\n      for (const frame of frames.reverse()) {\n        if (frame.filename) {\n          // Save the metadata for this filename\n          filenameMetadataMap.set(frame.filename, metadata);\n          break;\n        }\n      }\n    }\n  }\n\n  /**\n   * Retrieve metadata for a specific JavaScript file URL.\n   *\n   * Metadata is injected by the Sentry bundler plugins using the `_experiments.moduleMetadata` config option.\n   */\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  function getMetadataForUrl(parser, filename) {\n    ensureMetadataStacksAreParsed(parser);\n    return filenameMetadataMap.get(filename);\n  }\n\n  /**\n   * Adds metadata to stack frames.\n   *\n   * Metadata is injected by the Sentry bundler plugins using the `_experiments.moduleMetadata` config option.\n   */\n  function addMetadataToStackFrames(parser, event) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      event.exception.values.forEach(exception => {\n        if (!exception.stacktrace) {\n          return;\n        }\n        for (const frame of exception.stacktrace.frames || []) {\n          if (!frame.filename || frame.module_metadata) {\n            continue;\n          }\n          const metadata = getMetadataForUrl(parser, frame.filename);\n          if (metadata) {\n            frame.module_metadata = metadata;\n          }\n        }\n      });\n    } catch {\n      // To save bundle size we're just try catching here instead of checking for the existence of all the different objects.\n    }\n  }\n\n  /**\n   * Strips metadata from stack frames.\n   */\n  function stripMetadataFromStackFrames(event) {\n    try {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      event.exception.values.forEach(exception => {\n        if (!exception.stacktrace) {\n          return;\n        }\n        for (const frame of exception.stacktrace.frames || []) {\n          delete frame.module_metadata;\n        }\n      });\n    } catch {\n      // To save bundle size we're just try catching here instead of checking for the existence of all the different objects.\n    }\n  }\n});","lineCount":112,"map":[[7,2,98,0,"Object"],[7,8,98,0],[7,9,98,0,"defineProperty"],[7,23,98,0],[7,24,98,0,"exports"],[7,31,98,0],[8,4,98,0,"enumerable"],[8,14,98,0],[9,4,98,0,"get"],[9,7,98,0],[9,18,98,0,"get"],[9,19,98,0],[10,6,98,0],[10,13,98,9,"addMetadataToStackFrames"],[10,37,98,33],[11,4,98,33],[12,2,98,33],[13,2,98,0,"Object"],[13,8,98,0],[13,9,98,0,"defineProperty"],[13,23,98,0],[13,24,98,0,"exports"],[13,31,98,0],[14,4,98,0,"enumerable"],[14,14,98,0],[15,4,98,0,"get"],[15,7,98,0],[15,18,98,0,"get"],[15,19,98,0],[16,6,98,0],[16,13,98,35,"getMetadataForUrl"],[16,30,98,52],[17,4,98,52],[18,2,98,52],[19,2,98,0,"Object"],[19,8,98,0],[19,9,98,0,"defineProperty"],[19,23,98,0],[19,24,98,0,"exports"],[19,31,98,0],[20,4,98,0,"enumerable"],[20,14,98,0],[21,4,98,0,"get"],[21,7,98,0],[21,18,98,0,"get"],[21,19,98,0],[22,6,98,0],[22,13,98,54,"stripMetadataFromStackFrames"],[22,41,98,82],[23,4,98,82],[24,2,98,82],[25,2,1,0],[25,6,1,0,"_utilsWorldwideJs"],[25,23,1,0],[25,26,1,0,"require"],[25,33,1,0],[25,34,1,0,"_dependencyMap"],[25,48,1,0],[26,2,3,0],[27,2,4,0],[28,2,5,0],[28,8,5,6,"filenameMetadataMap"],[28,27,5,25],[28,30,5,28],[28,34,5,32,"Map"],[28,37,5,35],[28,38,5,36],[28,39,5,37],[29,2,6,0],[30,2,7,0],[30,8,7,6,"parsedStacks"],[30,20,7,18],[30,23,7,21],[30,27,7,25,"Set"],[30,30,7,28],[30,31,7,29],[30,32,7,30],[31,2,9,0],[31,11,9,9,"ensureMetadataStacksAreParsed"],[31,40,9,38,"ensureMetadataStacksAreParsed"],[31,41,9,39,"parser"],[31,47,9,45],[31,49,9,47],[32,4,10,2],[32,8,10,6],[32,9,10,7,"GLOBAL_OBJ"],[32,26,10,17],[32,27,10,17,"GLOBAL_OBJ"],[32,37,10,17],[32,38,10,18,"_sentryModuleMetadata"],[32,59,10,39],[32,61,10,41],[33,6,11,4],[34,4,12,2],[35,4,14,2],[35,9,14,7],[35,15,14,13,"stack"],[35,20,14,18],[35,24,14,22,"Object"],[35,30,14,28],[35,31,14,29,"keys"],[35,35,14,33],[35,36,14,34,"GLOBAL_OBJ"],[35,53,14,44],[35,54,14,44,"GLOBAL_OBJ"],[35,64,14,44],[35,65,14,45,"_sentryModuleMetadata"],[35,86,14,66],[35,87,14,67],[35,89,14,69],[36,6,15,4],[36,12,15,10,"metadata"],[36,20,15,18],[36,23,15,21,"GLOBAL_OBJ"],[36,40,15,31],[36,41,15,31,"GLOBAL_OBJ"],[36,51,15,31],[36,52,15,32,"_sentryModuleMetadata"],[36,73,15,53],[36,74,15,54,"stack"],[36,79,15,59],[36,80,15,60],[37,6,17,4],[37,10,17,8,"parsedStacks"],[37,22,17,20],[37,23,17,21,"has"],[37,26,17,24],[37,27,17,25,"stack"],[37,32,17,30],[37,33,17,31],[37,35,17,33],[38,8,18,6],[39,6,19,4],[41,6,21,4],[42,6,22,4,"parsedStacks"],[42,18,22,16],[42,19,22,17,"add"],[42,22,22,20],[42,23,22,21,"stack"],[42,28,22,26],[42,29,22,27],[43,6,24,4],[43,12,24,10,"frames"],[43,18,24,16],[43,21,24,19,"parser"],[43,27,24,25],[43,28,24,26,"stack"],[43,33,24,31],[43,34,24,32],[45,6,26,4],[46,6,27,4],[46,11,27,9],[46,17,27,15,"frame"],[46,22,27,20],[46,26,27,24,"frames"],[46,32,27,30],[46,33,27,31,"reverse"],[46,40,27,38],[46,41,27,39],[46,42,27,40],[46,44,27,42],[47,8,28,6],[47,12,28,10,"frame"],[47,17,28,15],[47,18,28,16,"filename"],[47,26,28,24],[47,28,28,26],[48,10,29,8],[49,10,30,8,"filenameMetadataMap"],[49,29,30,27],[49,30,30,28,"set"],[49,33,30,31],[49,34,30,32,"frame"],[49,39,30,37],[49,40,30,38,"filename"],[49,48,30,46],[49,50,30,48,"metadata"],[49,58,30,56],[49,59,30,57],[50,10,31,8],[51,8,32,6],[52,6,33,4],[53,4,34,2],[54,2,35,0],[56,2,37,0],[57,0,38,0],[58,0,39,0],[59,0,40,0],[60,0,41,0],[61,2,42,0],[62,2,43,0],[62,11,43,9,"getMetadataForUrl"],[62,28,43,26,"getMetadataForUrl"],[62,29,43,27,"parser"],[62,35,43,33],[62,37,43,35,"filename"],[62,45,43,43],[62,47,43,45],[63,4,44,2,"ensureMetadataStacksAreParsed"],[63,33,44,31],[63,34,44,32,"parser"],[63,40,44,38],[63,41,44,39],[64,4,45,2],[64,11,45,9,"filenameMetadataMap"],[64,30,45,28],[64,31,45,29,"get"],[64,34,45,32],[64,35,45,33,"filename"],[64,43,45,41],[64,44,45,42],[65,2,46,0],[67,2,48,0],[68,0,49,0],[69,0,50,0],[70,0,51,0],[71,0,52,0],[72,2,53,0],[72,11,53,9,"addMetadataToStackFrames"],[72,35,53,33,"addMetadataToStackFrames"],[72,36,53,34,"parser"],[72,42,53,40],[72,44,53,42,"event"],[72,49,53,47],[72,51,53,49],[73,4,54,2],[73,8,54,6],[74,6,55,4],[75,6,56,4,"event"],[75,11,56,9],[75,12,56,10,"exception"],[75,21,56,19],[75,22,56,20,"values"],[75,28,56,26],[75,29,56,27,"forEach"],[75,36,56,34],[75,37,56,35,"exception"],[75,46,56,44],[75,50,56,48],[76,8,57,6],[76,12,57,10],[76,13,57,11,"exception"],[76,22,57,20],[76,23,57,21,"stacktrace"],[76,33,57,31],[76,35,57,33],[77,10,58,8],[78,8,59,6],[79,8,61,6],[79,13,61,11],[79,19,61,17,"frame"],[79,24,61,22],[79,28,61,26,"exception"],[79,37,61,35],[79,38,61,36,"stacktrace"],[79,48,61,46],[79,49,61,47,"frames"],[79,55,61,53],[79,59,61,57],[79,61,61,59],[79,63,61,61],[80,10,62,8],[80,14,62,12],[80,15,62,13,"frame"],[80,20,62,18],[80,21,62,19,"filename"],[80,29,62,27],[80,33,62,31,"frame"],[80,38,62,36],[80,39,62,37,"module_metadata"],[80,54,62,52],[80,56,62,54],[81,12,63,10],[82,10,64,8],[83,10,66,8],[83,16,66,14,"metadata"],[83,24,66,22],[83,27,66,25,"getMetadataForUrl"],[83,44,66,42],[83,45,66,43,"parser"],[83,51,66,49],[83,53,66,51,"frame"],[83,58,66,56],[83,59,66,57,"filename"],[83,67,66,65],[83,68,66,66],[84,10,68,8],[84,14,68,12,"metadata"],[84,22,68,20],[84,24,68,22],[85,12,69,10,"frame"],[85,17,69,15],[85,18,69,16,"module_metadata"],[85,33,69,31],[85,36,69,34,"metadata"],[85,44,69,42],[86,10,70,8],[87,8,71,6],[88,6,72,4],[88,7,72,5],[88,8,72,6],[89,4,73,2],[89,5,73,3],[89,6,73,4],[89,12,73,10],[90,6,74,4],[91,4,74,4],[92,2,76,0],[94,2,78,0],[95,0,79,0],[96,0,80,0],[97,2,81,0],[97,11,81,9,"stripMetadataFromStackFrames"],[97,39,81,37,"stripMetadataFromStackFrames"],[97,40,81,38,"event"],[97,45,81,43],[97,47,81,45],[98,4,82,2],[98,8,82,6],[99,6,83,4],[100,6,84,4,"event"],[100,11,84,9],[100,12,84,10,"exception"],[100,21,84,19],[100,22,84,20,"values"],[100,28,84,26],[100,29,84,27,"forEach"],[100,36,84,34],[100,37,84,35,"exception"],[100,46,84,44],[100,50,84,48],[101,8,85,6],[101,12,85,10],[101,13,85,11,"exception"],[101,22,85,20],[101,23,85,21,"stacktrace"],[101,33,85,31],[101,35,85,33],[102,10,86,8],[103,8,87,6],[104,8,89,6],[104,13,89,11],[104,19,89,17,"frame"],[104,24,89,22],[104,28,89,26,"exception"],[104,37,89,35],[104,38,89,36,"stacktrace"],[104,48,89,46],[104,49,89,47,"frames"],[104,55,89,53],[104,59,89,57],[104,61,89,59],[104,63,89,61],[105,10,90,8],[105,17,90,15,"frame"],[105,22,90,20],[105,23,90,21,"module_metadata"],[105,38,90,36],[106,8,91,6],[107,6,92,4],[107,7,92,5],[107,8,92,6],[108,4,93,2],[108,5,93,3],[108,6,93,4],[108,12,93,10],[109,6,94,4],[110,4,94,4],[111,2,96,0],[112,0,96,1],[112,3]],"functionMap":{"names":["<global>","ensureMetadataStacksAreParsed","getMetadataForUrl","addMetadataToStackFrames","event.exception.values.forEach$argument_0","stripMetadataFromStackFrames"],"mappings":"AAA;ACQ;CD0B;AEQ;CFG;AGO;mCCG;KDgB;CHI;AKK;mCDG;KCQ;CLI"},"hasCjsExports":false},"type":"js/module"}]}