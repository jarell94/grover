// This file will be fixed with corrections
// Keeping existing code but fixing critical bugs identified